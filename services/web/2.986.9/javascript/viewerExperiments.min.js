define.experiment.component("wysiwyg.viewer.components.AdminLoginButton.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.AudioPlayer.AddMediaGalleryBI",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"AUDIO_REPLACE_AUDIO",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"audio",i18nPrefix:"music",selectionType:"single",mediaType:"music",callback:"_mediaGalleryCallback"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"audio",i18nPrefix:"music",selectionType:"single",mediaType:"music",callback:"_mediaGalleryCallback"},commandParameterDataRef:"SELF"},mobile:{allInputsHidden:!0}}}),c.methods({_mediaGalleryCallback:d.after(function(){this._logChangeMediaSuccess()}),_logChangeMediaSuccess:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:this.className})}})}),define.experiment.component("wysiwyg.viewer.components.AudioPlayer.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"AUDIO_REPLACE_AUDIO",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"audio",i18nPrefix:"music",selectionType:"single",mediaType:"music",callback:"_mediaGalleryCallback"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"audio",i18nPrefix:"music",selectionType:"single",mediaType:"music",callback:"_mediaGalleryCallback"},commandParameterDataRef:"SELF"},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.BgImageStrip.EditableImageInput",function(a){a.methods({_setBgImage:function(){var a=this._skinParts.bg.style;this._isFakeOrEmptyUri()?(a.backgroundImage="",this._data.set("uri","none"),this._updateMobileInputs(!0)):(this._updateMobileInputs(!1),a.backgroundImage="url("+this._baseUrl+this._data.get("uri")+")")},_updateMobileInputs:function(a){this.EDITOR_META_DATA&&(this.EDITOR_META_DATA.mobile.allInputsHidden=a)},_isFakeOrEmptyUri:function(){var a=this._data.get("uri");return!a||"none"===a},_mediaGalleryCallback:function(a){this.getDataItem().setFields({uri:a.fileName,originalImageDataRef:null})}})}),define.experiment.component("wysiwyg.viewer.components.BgImageStrip.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"BG_STRIP_CHANGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"backgrounds",publicMediaFile:"backgrounds",i18nPrefix:"background",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"backgrounds",publicMediaFile:"backgrounds",i18nPrefix:"background",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"},commandParameterDataRef:"SELF"},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.ClipArt.AddMediaGalleryBI",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CLIP_ART_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},mobile:{previewImageDataRefField:"*",allInputsHidden:!0}}}),c.methods({_mediaGalleryCallback:d.after(function(){this._logChangeMediaSuccess()}),_logChangeMediaSuccess:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:this.className})}})}),define.experiment.component("wysiwyg.viewer.components.ClipArt.ConsistentAspectRatio",function(a,b){var c=a;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CLIP_ART_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},mobile:{previewImageDataRefField:"*",allInputsHidden:!1}}})}),define.experiment.component("wysiwyg.viewer.components.ClipArt.EditableImageInput",function(a){a.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CLIP_ART_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},{label:"IMAGEINPUTNEW_CLIPART_EFFECTS",command:"WEditorCommands.OpenAviaryDialog",commandParameter:{commandSource:"FPP",dialogLabel:"IMAGEINPUTNEW_CLIPART_EFFECTS"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},mobile:{previewImageDataRefField:"*",allInputsHidden:!0}}}),a.methods({_mediaGalleryCallback:function(a){this.getDataItem().setFields({height:a.height,width:a.width,uri:a.fileName,originalImageDataRef:null}),this._logChangeMediaSuccess()}})}),define.experiment.component("wysiwyg.viewer.components.ClipArt.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CLIP_ART_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"clipart",publicMediaFile:"clipart",i18nPrefix:"clipart",selectionType:"single",mediaType:"picture",callback:"_mediaGalleryCallback",startingTab:"free"}},mobile:{previewImageDataRefField:"*",allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.ClipArt.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.component("wysiwyg.viewer.components.ContactForm.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.documentmedia.DocumentMedia.AddMediaGalleryBI",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CHOOSE_DOCUMENT",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"documents",publicMediaFile:"file_icons",i18nPrefix:"document",selectionType:"single",mediaType:"document",callback:"documentGalleryCallback"}},{label:"LINK_TO_ICON",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"file_icons",i18nPrefix:"single_icon",selectionType:"single",mediaType:"picture",callback:"mediaGalleryCallback",startingTab:"free"}}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"documents",publicMediaFile:"file_icons",i18nPrefix:"document",selectionType:"single",mediaType:"document",callback:"documentGalleryCallback"}}}}),c.methods({documentGalleryCallback:d.after(function(){this._logChangeMediaSuccess()}),_logChangeMediaSuccess:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:this.className})}})}),define.experiment.component("wysiwyg.viewer.components.documentmedia.DocumentMedia.EditorMetaDataRelocation",function(a,b){var c=a;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"CHOOSE_DOCUMENT",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"documents",publicMediaFile:"file_icons",i18nPrefix:"document",selectionType:"single",mediaType:"document",callback:"documentGalleryCallback"}},{label:"LINK_TO_ICON",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"file_icons",i18nPrefix:"single_icon",selectionType:"single",mediaType:"picture",callback:"mediaGalleryCallback",startingTab:"free"}}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"documents",publicMediaFile:"file_icons",i18nPrefix:"document",selectionType:"single",mediaType:"document",callback:"documentGalleryCallback"}}}}),c.methods({initialize:function(a,b,c){this.parent(a,b,c)}})}),define.experiment.component("wysiwyg.viewer.components.menus.DropDownMenu.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"FPP_RENAME_PAGES_LABEL",command:"WEditorCommands.PageSettings",commandParameter:{BIsrc:"DropDownMenuFPP",parentPanel:"pagesPanel"}},{label:"FPP_NAVIGATE_LABEL",command:"WEditorCommands.Pages"}],dblClick:{command:"WEditorCommands.Pages"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.EbayItemsBySeller.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.FacebookShare.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.FiveGridLine.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.FlashComponent.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"GENERAL_CHANGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"flash",i18nPrefix:"flash",selectionType:"single",mediaType:"swf",callback:"_mediaGalleryCallback"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"flash",i18nPrefix:"flash",selectionType:"single",mediaType:"swf",callback:"_mediaGalleryCallback"}}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.FlickrBadgeWidget.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.FooterContainer.LandingPageSupport",function(a){a.methods({toggleLandingPageMode:function(a){a?(this._serializedHeight=this.getHeight(),this.setHeight(this.MINIMUM_HEIGHT_DEFAULT)):(this.setHeight(this._serializedHeight),delete this._serializedHeight)},_getSerializedHeight:function(){return"number"==typeof this._serializedHeight?this._serializedHeight:this.getHeight()}})}),define.experiment.component("wysiwyg.viewer.components.HeaderContainer.LandingPageSupport",function(a){a.methods({toggleLandingPageMode:function(a,b){if(a){this._serializedY=this.getY();var c=this.getHeight();b?b.to(this.$view,1,{top:-c,ease:"strong_easeIn",onComplete:this.$view.setStyle.bind(this.$view,"top",-c)}):this.$view.setStyle("top",-c)}else b.to(this.$view,1,{top:this._serializedY,ease:"strong_easeIn",onComplete:this.setY.bind(this,this._serializedY)}),delete this._serializedY},_getSerializedY:function(){return"number"==typeof this._serializedY?this._serializedY:this.getY()}})}),define.experiment.component("wysiwyg.viewer.components.HorizontalMenu.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"FPP_NAVIGATE_LABEL",command:"WEditorCommands.Pages"}],dblClick:{command:"WEditorCommands.Pages"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.HtmlComponent.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.LinkBar.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"SOCIAL_BAR_MNG_ICONS",command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"social_icons",source:"fpp",startingTab:"free"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"social_icons",source:"dblclick",startingTab:"free"},commandParameterDataRef:"SELF"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.LoginButton.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.MatrixGallery.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"GALLERY_ORGANIZE_PHOTOS",command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"MatrixGallery",publicMediaFile:"photos",selectionType:"multiple",mediaType:"picture",i18nPrefix:"multiple_images",source:"fpp"},commandParameterDataRef:"SELF"},{label:"CHANGE_GALLERY_TYPE",command:"WEditorCommands.OpenChangeGalleryDialog",commandParameter:{}}],dblClick:{command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"MatrixGallery",publicMediaFile:"photos",selectionType:"multiple",mediaType:"picture",i18nPrefix:"multiple_images",source:"dblclick"},commandParameterDataRef:"SELF"},mobile:{previewImageDataRefField:"*"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.MatrixGallery.MatrixGalleryResizeIssue",function(a){a.methods({_onResize:function(){this.parent(),this._skinParts&&(this._calculateItemSize({x:this.getWidth(),y:this.getHeight()}),this._setCorrectedComponentSize(),this._updateContainerSize(),this._positionAllItems(),this._setupAllItems())},_calculateItemSize:function(a){if(this._skinParts&&this._data.get("items").length>0){a=a||this._view.getSize(),(0===a.x||0===a.y)&&(a.x=this.getWidth(),a.y=this.getHeight());var b=a.x-this._widthDiff,c=a.y-this._heightDiff;this._itemWidth=Math.max(Math.floor((b-(this._numCols-1)*this._gap)/this._numCols),0),this._itemHeight=Math.max(Math.floor((c-(this._numRows-1)*this._gap)/this._numRows),0)}}})}),define.experiment.component("wysiwyg.viewer.components.MatrixGallery.OrganizeImages",function(a,b){a.statics({EDITOR_META_DATA:b.merge({dblClick:{command:"WEditorCommands.OpenOrganizeImagesDialog"}})}),a.methods({initialize:b.before(function(){this.EDITOR_META_DATA.custom[0].command="WEditorCommands.OpenOrganizeImagesDialog"})})}),define.experiment.component("wysiwyg.viewer.components.MatrixGallery.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.component("wysiwyg.viewer.components.MediaZoom.MediaZoomDispose",function(a,b){var c=a;c.methods({_closeZoom:function(){this.collapse(),this.injects().Viewer.exitFullScreenMode(),this.setDataItem(null),this.resetIterator(),this._emptyContainer(this._skinParts.virtualContainer),this._emptyContainer(this._skinParts.itemsContainer),this._skinParts.dialogBox.setStyles({width:"100px"}),this._opened=!1,this.unlock(),this._lastCurrentItem=null},_transitionToCurrentDisplayer:function(a){if(!this._inTransition){this._inTransition=!0,a.setStyle("opacity","0.0");var b=this._skinParts.itemsContainer,c=this,d=function(){c._emptyContainer(b);var d=a.getStyles("width","height"),f=c._getTopGap(d.height.replace("px",""));b.adopt(a),c._emptyContainer(c._skinParts.virtualContainer);var g=new Fx.Morph(c._skinParts.dialogBox,{duration:c.transitionTime,link:"chain"});g.addEvent("complete",function(){var b=new Fx.Tween(a,{duration:c.transitionTime,link:"chain"});b.addEvent("complete",function(){c.unlock(),c._inTransition=!1,b.removeEvent("complete",arguments.callee)}),b.start("opacity","1.0"),g.removeEvent("complete",arguments.callee)}),g.start({width:d.width,"min-height":d.height,"margin-top":f+"px"}),e&&e.removeEvent("complete",arguments.callee)};if(b.hasChildNodes()){var e=new Fx.Tween(b.firstChild,{duration:c.transitionTime,link:"chain",property:"opacity"});e.addEvent("complete",d),e.start("0.0")}else d()}},_changeImageNoTransition:function(a){var b=this._skinParts.itemsContainer,c=this;this._emptyContainer(b);var d=a.getStyles("width","height"),e=c._getTopGap(d.height.replace("px",""));b.adopt(a),this._emptyContainer(c._skinParts.virtualContainer),c._skinParts.dialogBox.setStyles({width:d.width,"min-height":d.height,"margin-top":e+"px"}),c.unlock()},_emptyContainer:function(a){for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];c.getLogic?c.getLogic().dispose():c.destroy()}a.empty()}})}),define.experiment.component("wysiwyg.viewer.components.MobileMediaZoom.ExitMobileMode",function(a,b){var c=a;c.methods({fixZoom:function(){var a=1,b=W.Config.env.$viewingDevice.toUpperCase()===Constants.ViewerTypesParams.TYPES.DESKTOP,c=this._isMobilePreviewMode||this.getState("viewerType").toUpperCase()===Constants.ViewerTypesParams.TYPES.MOBILE;if(c&&!b)return a;(!this._initZoom||this._initZoom<0||this._initZoom>5)&&this._setInitZoom();var d=this._initZoom/this._mobileConfig.getZoom();this._skinParts.xButton.style.zoom=d,this._skinParts.buttonPrev.style.zoom=d,this._skinParts.buttonNext.style.zoom=d}})}),define.experiment.component("wysiwyg.viewer.components.MobileMediaZoomDisplayer.ExitMobileMode",function(a,b){var c=a;c.methods({_setZoomModeFontSize:function(){this._mobileConfig._deviceInitZoom=this._initZoom=this._mobileConfig.getMobileScreenWidth()/document.body.offsetWidth;var a,b=this._isMobilePreviewMode?1:this._initZoom/this._mobileConfig.getZoom();switch(this.getState("displayDevice")){case"desktop":a=this._mobileConfig.isMobile()&&window.publicModel.adaptiveMobileOn?this.FONT_MULTIPLIER.MOBILE_SITE:this.FONT_MULTIPLIER.DESKTOP_SITE;break;case"tablet":a=this.FONT_MULTIPLIER.TABLET_SITE;break;case"mobile":a=this.FONT_MULTIPLIER.MOBILE_SITE;break;default:a=this.FONT_MULTIPLIER.DESKTOP_SITE}var c=a*b;this._mobileConfig.isPortrait()&&(c*=this._fontSizeCorrectionWhenOpenZoomInPortrait),this._view.setStyle("font-size",c+"px")}})}),define.experiment.component("wysiwyg.viewer.components.PageGroup.BackgroundPerPage",function(a,b){var c=a;c.methods({_initTransitionDurationMap:function(){this._transitionDurationMap=_.invert(Constants.TransitionTypes)},_getPageTransitionDuration:function(a){var b=0,c=this._transitionDurationMap[a],d=Constants.TransitionDefaults[c];return d&&(b=d.durationInSec||0),b}})}),define.experiment.component("wysiwyg.viewer.components.PageGroup.LandingPageSupport",function(a,b){var c=a;c.methods({_executeTransitionIfPossible:b.before(function(a){if(this._currentPage){var b=a.$logic.isLanding();this._isCurrentPageLandingPage!==b&&W.Commands.executeCommand("Viewer.ToggleLandingPageMode",{toLanding:b})}}),_setCurrentPage:b.after(function(){this._isCurrentPageLandingPage=this._currentPage.$logic.isLanding()}),isCurrentPageLandingPage:function(){if("undefined"==typeof this._isCurrentPageLandingPage){var a=this.resources.W.Viewer,b=a.getCompLogicById(a.getCurrentPageId());this._isCurrentPageLandingPage=b&&b.isLanding()}return this._isCurrentPageLandingPage}})}),define.experiment.component("wysiwyg.viewer.components.PagesContainer.BackgroundPerPageFPP",function(a){var b=a;b.fields({EDITOR_META_DATA:{general:{settings:!0,design:!0,animation:!1,background:!0},mobile:{allInputsHidden:!0}}})}),define.experiment.component("wysiwyg.viewer.components.PagesContainer.LandingPageSupport",function(a){a.methods({toggleLandingPageMode:function(a,b){a?(this._serializedY=this.getY(),b?b.to(this.$view,1,{top:0,ease:"strong_easeIn",onComplete:this.setY.bind(this,0)}):this.setY(0)):b.to(this.$view,1,{top:this._serializedY,ease:"strong_easeIn",onComplete:function(){this.setY(this._serializedY),delete this._serializedY,W.Layout.enforceAnchors([this],!0),W.Layout.recalculateSiteHeight()}.bind(this)})},_getSerializedY:function(){return"number"==typeof this._serializedY?this._serializedY:this.getY()},isHorizontallyMovable:function(){return!W.Viewer.isCurrentPageLandingPage()&&this.parent()},isVerticallyMovable:function(){return!W.Viewer.isCurrentPageLandingPage()&&this.parent()}})}),define.experiment.component("wysiwyg.viewer.components.PayPalButton.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.PinterestFollow.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.ScreenWidthArea.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.ScreenWidthContainer.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.ScreenWidthContainer.LesserWidthIssue",function(a){a.methods({_stretchBackgroundAndCenterContent:function(){var a=this._view,b=$(document).getSize(),c=a.getSize(),d=this.resources.W.Viewer.getDocWidth(),e=this._isMobileView?0:-Math.round((b.x-d)/2),f=this._isMobileView?d:Math.max(d,b.x);e>0&&(e=0),this._skinParts.screenWidthBackground.setStyles({position:"absolute",width:f+"px",height:c.y+"px",left:e})}})}),define.experiment.component("wysiwyg.viewer.components.SiteButton.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],mobile:{isTextScalable:!0,previewTextDataField:"label"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.SiteButton.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.component("wysiwyg.viewer.components.SiteSegmentContainer.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0,animation:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.SlideShowGallery.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"GALLERY_ORGANIZE_PHOTOS",command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"SlideShowGallery",publicMediaFile:"photos",i18nPrefix:"multiple_images",mediaType:"picture",selectionType:"multiple",source:"fpp"},commandParameterDataRef:"SELF"},{label:"CHANGE_GALLERY_TYPE",command:"WEditorCommands.OpenChangeGalleryDialog",commandParameter:{}}],dblClick:{command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"SlideShowGallery",publicMediaFile:"photos",i18nPrefix:"multiple_images",mediaType:"picture",selectionType:"multiple",source:"dblclick"},commandParameterDataRef:"SELF"},mobile:{previewImageDataRefField:"*"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.SlideShowGallery.OrganizeImages",function(a,b){a.statics({EDITOR_META_DATA:b.merge({dblClick:{command:"WEditorCommands.OpenOrganizeImagesDialog"}})}),a.methods({initialize:b.before(function(){this.EDITOR_META_DATA.custom[0].command="WEditorCommands.OpenOrganizeImagesDialog"})})}),define.experiment.component("wysiwyg.viewer.components.SliderGallery.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"GALLERY_ORGANIZE_PHOTOS",command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"SliderGallery",publicMediaFile:"photos",i18nPrefix:"multiple_images",mediaType:"picture",selectionType:"multiple",source:"fpp"},commandParameterDataRef:"SELF"},{label:"CHANGE_GALLERY_TYPE",command:"WEditorCommands.OpenChangeGalleryDialog",commandParameter:{}}],dblClick:{command:"WEditorCommands.OpenListEditDialog",commandParameter:{galleryConfigID:"SliderGallery",publicMediaFile:"photos",i18nPrefix:"multiple_images",mediaType:"picture",selectionType:"multiple",source:"dblclick"},commandParameterDataRef:"SELF"},mobile:{previewImageDataRefField:"*"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.SliderGallery.OrganizeImages",function(a,b){a.statics({EDITOR_META_DATA:b.merge({dblClick:{command:"WEditorCommands.OpenOrganizeImagesDialog"}})}),a.methods({initialize:b.before(function(){this.EDITOR_META_DATA.custom[0].command="WEditorCommands.OpenOrganizeImagesDialog"})})}),define.experiment.component("wysiwyg.viewer.components.SoundCloudWidget.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.TwitterFeed.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"FPP_DESIGN_LABEL",command:"WEditorCommands.AdvancedDesign"}]}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.VKShareButton.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.VerticalLine.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},mobile:{allInputsHidden:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.Video.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.Video.VideoNBC",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.methods({initialize:function(a,b,c){c=c||{},this.parent(a,b,c),this._iframe=null,this.on("resizeEnd",this,this._onResizeEnd),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditorModeChanged)},_onRender:function(a){var b=a.data.invalidations;this._renderIframe(),this.setMinW(this._getWMinSize()),this.setMinH(this._getHMinSize()),b.isInvalidated([this.INVALIDATIONS.FIRST_RENDER])&&this._view.on(Constants.DisplayEvents.COLLAPSED,this,this._stopVideo)},isRenderNeeded:function(a){var b=[this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.FIRST_RENDER,this.INVALIDATIONS.SIZE];return a.isInvalidated(b)},_onResize:function(){},setHeight:function(a,b,c){this.parent(a,b,c)},setWidth:function(a,b,c){this.parent(a,b,c)},_onEditorModeChanged:function(a,b){if(!this.resources.W.Config.env.$isPublicViewerFrame){"CURRENT_PAGE"===a&&(this._stopVideo(),this._renderIframe());var c="PREVIEW";(b===c||a===c)&&this._renderIframe()}}})}),define.experiment.component("wysiwyg.viewer.components.WFacebookComment.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WFacebookLike.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WGooglePlusOne.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.AddMediaGalleryBI",function(a,b){var c=a;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},mobile:{previewImageDataRefField:"*"}}}),c.methods({_reportLogEvent:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:this.className})}})}),define.experiment.newComponent("wysiwyg.viewer.components.WPhoto.AppsWPhotoNBC",function(a,b){var c=a;b=b,c.inherits("wysiwyg.viewer.components.WPhotoBase"),c.utilize(["core.components.image.ImageSettings","core.components.image.ImageDimensionsNew","wysiwyg.common.utils.LinkRenderer"]),c.resources(["W.Viewer"]),c.skinParts(b.inherit()),c.dataTypes(b.inherit()),c.propertiesSchemaType(b.inherit()),c.methods({initialize:function(a,b,c){this.parent(a,b,c),this._linkRenderer=new this.imports.LinkRenderer
},_renderLink:function(){if(this.PREVENT_LINK_RENDER)return this._linkRenderer.removeRenderedLinkFrom(this._skinParts.link,this),void 0;var a=this.getDataItem(),b=a._data.link;if(!b)return this._linkRenderer.removeRenderedLinkFrom(this._skinParts.link,this),void 0;var c=this.resources.W.Data.getDataByQuery(b);c&&this._linkRenderer.renderLink(this._skinParts.link,c,this)},_onClick:function(a){a.rightClick===!1&&"zoomMode"===this.getComponentProperty("onClickBehavior")&&this.resources.W.Commands.executeCommand("WViewerCommands.OpenZoom",{item:this._data,getDisplayerDivFunction:this.resources.W.Viewer.getDefaultGetZoomDisplayerFunction("Image")},this)}})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.EditableImageInput",function(a){a.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"IMAGEINPUTNEW_IMAGE_EFFECTS",command:"WEditorCommands.OpenAviaryDialog",commandParameter:{commandSource:"FPP"}},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},mobile:{previewImageDataRefField:"*"}}}),a.methods({_mediaGalleryCallback:function(a){this.getDataItem().setFields({height:a.height,width:a.width,uri:a.fileName,originalImageDataRef:null}),this._reportLogEvent()}})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"FPP",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"dblClick",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},mobile:{previewImageDataRefField:"*"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WPhoto.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.newComponent("wysiwyg.viewer.components.WPhotoBase.AppsWPhotoNBC",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.binds(["_mediaGalleryCallback","_onClick"]),b.utilize(["core.components.image.ImageSettings","core.components.image.ImageDimensionsNew"]),b.skinParts({link:{type:"htmlElement"},img:{type:"core.components.image.ImageNew",dataRefField:"*",hookMethod:"_setImageArgs"}}),b.dataTypes(["Image"]),b.states({touch:["noTouch","hasTouch"]}),b.propertiesSchemaType("WPhotoProperties"),b.resources(["W.Utils","W.Config","W.Data","W.Commands"]),b.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED,Constants.DisplayEvents.DISPLAY_CHANGED,Constants.DisplayEvents.SKIN_CHANGE],EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"FPP",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"dblClick",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},mobile:{previewImageDataRefField:"*"}}}),b.statics({MIN_IMAGE_HEIGHT:1,MIN_IMAGE_WIDTH:1,_autoSizeStates:{none:1,autoSizeNoLayoutUpdate:2,autoSizeUpdateLayout:3}}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._SettingsClass=this.imports.ImageSettings,this._imageSettings=new this.imports.ImageSettings,this._imageDimensions=new this.imports.ImageDimensionsNew,c&&c.props&&this.setComponentProperties(c.props),this._contentPadding={x:0,y:0},this._rotatable=!0},isRenderNeeded:function(a){return a.isInvalidated([this.INVALIDATIONS.PART_SIZE])||this.parent(a)},_onRender:function(a){var b,c=a.data.invalidations,d=this.getComponentProperties(),e=d.get("onClickBehavior")||"",f="zoomAndPanMode"===e||this._showZoom,g=this._skinParts.img,h=Modernizr.touch?"hasTouch":"noTouch";this.PREVENT_LINK_RENDER="wysiwyg.viewer.components.WPhoto"===this.className?!0:!1;var i=!1;c.isInvalidated([this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.PART_SIZE])&&(this._updateFramePadding(),i=this._updateImageSize(this.getWidth(),this.getHeight())),c.isInvalidated([this.INVALIDATIONS.DATA_CHANGE,this.INVALIDATIONS.SKIN_CHANGE])&&(g.setZoom(f),f?g.fireEvent("resize",g.isOriginalImageSmallerThanWrapper()):g.fireEvent("resize",!1)),i=i||c.isInvalidated([this.INVALIDATIONS.DATA_CHANGE]),i&&this._updateImageSettings(),c.isInvalidated([this.INVALIDATIONS.DATA_CHANGE])&&(this._setTitle(),this._checkResizeInFitMode(),this._skinParts.img._view.style.cursor="",b=c._invalidations.dataChange[0],b&&"link"===b.field&&b.value.link&&this.getComponentProperties().set("onClickBehavior","goToLink"),this._clickEventSelector(),this._renderLink()),this.setState(h,"touch")},_clickEventSelector:function(){var a=this.getComponentProperty("onClickBehavior");switch(this._skinParts.view.removeEvent("click",this._onClick),a){case"zoomMode":this._zoomModeSelected();break;case"goToLink":this.PREVENT_LINK_RENDER=!1;break;case"disabled":this._doNothigModeSelected()}},_doNothigModeSelected:function(){this.PREVENT_LINK_RENDER=!0,this._skinParts.img._view.style.cursor="default"},_zoomModeSelected:function(){this.PREVENT_LINK_RENDER=!0,this._skinParts.view.addEvent("click",this._onClick),this._skinParts.img._view.style.cursor="pointer"},_onClick:function(){},_renderLink:function(){},_setImageArgs:function(a){return a.argObject={requestExactSize:!this.resources.W.Config.env.$isEditorViewerFrame},a},_preventRenderOnDataChange:function(a,b){return b&&"displayMode"!==b&&"href"!==b?!0:!1},setWidth:function(a,b){this.parent(a),this._updateImageSize(a,null),b||(this._changeCropModeInFit(!0),this._skinParts.img.setSettings(this._imageSettings),this._checkResizeInFitMode())},setHeight:function(a,b){this.parent(a),this._updateImageSize(null,a),b||(this._changeCropModeInFit(!1),this._skinParts.img.setSettings(this._imageSettings),this._checkResizeInFitMode())},_changeCropModeInFit:function(a){this.isDisplayed()&&"fitWidth"===this._getDisplayMode()&&(a?this._imageSettings.setCropMode(this._imageSettings.CropModes.FIT_WIDTH):this._imageSettings.setCropMode(this._imageSettings.CropModes.FIT_HEIGHT))},_updateImageSize:function(a,b){this._framePadding||this._updateFramePadding();var c=!1,d=this._imageSettings.getSize(),e=a-this._framePadding.x,f=b-this._framePadding.y;return null===a||isNaN(a)||d&&d.x===e||(this._imageSettings.setWidth(e),c=!0),null===b||isNaN(b)||!d&&d.y===f||(this._imageSettings.setHeight(f),c=!0),c},_checkResizeInFitMode:function(){var a=this._framePadding;if(this._skinParts.img.getSize())if(this._imageSettings.getCropMode()===this._imageSettings.CropModes.FIT_WIDTH){var b=this._skinParts.img.getSize().y;this.setHeight(b+a.y,!0)}else if(this._imageSettings.getCropMode()===this._imageSettings.CropModes.FIT_HEIGHT){var c=this._skinParts.img.getSize().x;this.setWidth(c+a.x,!0)}},_updateImageSettings:function(){var a=this._getImageCropMode();this._imageSettings.setCropMode(a),this._skinParts.img.setSettings&&this._skinParts.img.setSettings(this._imageSettings)},_updateFramePadding:function(){var a=this.getSkin(),b={left:a.getParamValue("contentPaddingLeft"),right:a.getParamValue("contentPaddingRight"),top:a.getParamValue("contentPaddingTop"),bottom:a.getParamValue("contentPaddingBottom")},c={left:parseInt(b.left?b.left._amount:0,10),right:parseInt(b.right?b.right._amount:0,10),top:parseInt(b.top?b.top._amount:0,10),bottom:parseInt(b.bottom?b.bottom._amount:0,10)};this._framePadding={x:c.left+c.right,y:c.top+c.bottom}},_getImageCropMode:function(){var a=this.getComponentProperty("displayMode");return"fitWidthStrict"===a&&(a=this._imageSettings.CropModes.FIT_WIDTH),"fitHeightStrict"===a&&(a=this._imageSettings.CropModes.FIT_HEIGHT),a},getMinPhysicalHeight:function(){return this._getContentPaddingSize().y},_renderImage:function(){if(this._layoutInitialized&&this._sizeDefined){var a=this._skinParts.img;if(a&&a.getOriginalClassName){var b=this._getImageSettings();a.setSettings(b),b.getCropMode()===b.CropModes.FIT_WIDTH?this.setHeight(a.getSize().y+this._getContentPaddingSize().y,!1,!1,!0):b.getCropMode()===b.CropModes.FIT_HEIGHT&&this.setWidth(a.getSize().x+this._getContentPaddingSize().x,!1,!1,!0),this._fireAutoSize()}}},_fireAutoSize:function(){this._autoSizeState!==this._autoSizeStates.none&&(this.fireEvent("autoSized",{ignoreLayout:this._autoSizeState===this._autoSizeStates.autoSizeNoLayoutUpdate}),this.injects().Layout&&this.injects().Layout.notifyPositionChanged(this,"updateSize"),this._autoSizeState=this._autoSizeStates.none)},_styleChanged:function(){var a=this._getContentPaddingSize(!0);this.setMinH(a.y+this.MIN_IMAGE_HEIGHT),this.setMinW(a.x+this.MIN_IMAGE_WIDTH);var b=this._getPhotoInnerSize();this._getImageSettings().setSize(b.x,b.y)},_getContentPaddingSize:function(a){if(!this._contentPadding||a){this._contentPadding={};var b=this.getSkin();this._contentPadding.x=parseInt(b.getParamValue("contentPaddingLeft"),10)+parseInt(b.getParamValue("contentPaddingRight"),10),this._contentPadding.y=parseInt(b.getParamValue("contentPaddingTop"),10)+parseInt(b.getParamValue("contentPaddingBottom"),10),this._contentPadding.x=isNaN(this._contentPadding.x)?0:this._contentPadding.x,this._contentPadding.y=isNaN(this._contentPadding.y)?0:this._contentPadding.y,this.getSizeLimits().minH=this._contentPadding.y,this.getSizeLimits().minW=this._contentPadding.x}return this._contentPadding},_getImageSettings:function(){if(!this._imageSettings){var a=this._getPhotoInnerSize(),b=this._translateDisplayModeToImageCropMode(this._getDisplayMode());this._imageSettings=new this.imports.ImageSettings(b,a.x,a.y)}return this._imageSettings},_getPhotoInnerSize:function(){var a=this._getContentPaddingSize(),b=this.getWidth()-a.x,c=this.getHeight()-a.y;return{x:b,y:c}},_setTitle:function(){var a=this._data.get("title");this._skinParts.view.set("title",a)},_getDisplayMode:function(){return this.getComponentProperty("displayMode")},_getImageDisplayMode:function(){return this._getImageSettings()&&this._getImageSettings().getCropMode()},_translateDisplayModeToImageCropMode:function(a){var b=a;return"fitWidthStrict"===a&&(b=this._SettingsClass.CropModes.FIT_WIDTH),"fitHeightStrict"===a&&(b=this._SettingsClass.CropModes.FIT_HEIGHT),b},allowHeightLock:function(){return!this._isFitMode()},_isFitMode:function(){var a=["fitWidth","fitWidthStrict","fitHeightStrict"];return a.indexOf(this._getDisplayMode())>=0},_mediaGalleryCallback:function(a){this.getDataItem().setFields({title:a.title,description:a.description||"",height:a.height,width:a.width,uri:a.fileName}),this._reportLogEvent()},_reportLogEvent:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:"Wphoto"})}})}),define.experiment.component("wysiwyg.viewer.components.WPhotoBase.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"FPP",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{openCommand:"dblClick",galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},mobile:{previewImageDataRefField:"*"}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WPhotoOBC.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.component("wysiwyg.viewer.components.WPhotoOBC",function(a){var b=a;b.inherits("mobile.core.components.base.BaseComponent"),b.binds(["_mediaGalleryCallback"]),b.utilize(["core.components.image.ImageSettings","core.components.image.ImageDimensionsNew","wysiwyg.common.utils.LinkRenderer"]),b.resources(["W.Config","W.Data"]),b.skinParts({link:{type:"htmlElement"},img:{type:"core.components.image.ImageNew",dataRefField:"*",hookMethod:"_setImageArgs"}}),b.dataTypes(["Image"]),b.propertiesSchemaType("WPhotoProperties"),b.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED,Constants.DisplayEvents.DISPLAY_CHANGED,Constants.DisplayEvents.SKIN_CHANGE],EDITOR_META_DATA:{general:{settings:!0,design:!0},custom:[{label:"PHOTO_REPLACE_IMAGE",command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}},{label:"PHOTO_EDIT_IMAGE",command:"WEditorCommands.OpenAviaryDialog"},{label:"LINK_LINK_TO",command:"WEditorCommands.OpenLinkDialogCommand",commandParameter:{position:"center"},commandParameterDataRef:"SELF"}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{galleryConfigID:"photos",publicMediaFile:"photos",selectionType:"single",i18nPrefix:"single_image",mediaType:"picture",callback:"_mediaGalleryCallback"}}}}),b.statics({MIN_IMAGE_HEIGHT:1,MIN_IMAGE_WIDTH:1,_autoSizeStates:{none:1,autoSizeNoLayoutUpdate:2,autoSizeUpdateLayout:3}}),b.methods({initialize:function(a,b,c){this._imageDimensions=new this.imports.ImageDimensionsNew,this._SettingsClass=this.imports.ImageSettings,this.parent(a,b,c),c&&c.props&&this.setComponentProperties(c.props),this._contentPadding={x:0,y:0},this._autoSizeState=this._autoSizeStates.none,this._initialDataChange=!0,this._linkRenderer=new this.imports.LinkRenderer},_setImageArgs:function(a){return a.argObject={requestExactSize:!this.injects().Config.env.$isEditorViewerFrame},a},_onAllSkinPartsReady:function(a){this.parent(a),this._data&&this._setTitle()},_preventRenderOnDataChange:function(a,b){return b&&"displayMode"!=b&&"href"!=b?!0:!1},_onDataChange:function(a,b,c){if(this._skinParts&&"title"==b&&this._setTitle(),"displayMode"==b){var d=this._translateDisplayModeToImageCropMode(c.displayMode);this._getImageSettings().setCropMode(d)}this._initialDataChange||!this._isFitMode()||"displayMode"!=b&&b||(this._autoSizeState=this._autoSizeStates.autoSizeUpdateLayout),this._initialDataChange=!1,this.parent(a,b,c)},setWidth:function(a,b,c,d){if(a&&!isNaN(a)&&(d||"fitHeightStrict"!=this._getDisplayMode())&&(this._getImageSettings().setContainerWidth(a-this._getContentPaddingSize().x),this.parent(a,b,c),!d)){var e=this._getImageDisplayMode();e==this._SettingsClass.CropModes.FIT_HEIGHT&&this._isDisplayed&&this._getImageSettings().setCropMode(this._SettingsClass.CropModes.FIT_WIDTH),(e===this._SettingsClass.CropModes.FIT_WIDTH||e===this._SettingsClass.CropModes.FIT_HEIGHT)&&(this._autoSizeState=this._autoSizeStates.autoSizeNoLayoutUpdate),this._renderImage()}},setHeight:function(a,b,c,d){if(a&&!isNaN(a)&&(d||"fitWidthStrict"!=this._getDisplayMode())&&(this.parent(a,b,c),this._getImageSettings().setContainerHeight(a-this._getContentPaddingSize().y),!d)){var e=this._getImageDisplayMode();e==this._SettingsClass.CropModes.FIT_WIDTH&&this._isDisplayed&&this._getImageSettings().setCropMode(this._SettingsClass.CropModes.FIT_HEIGHT),(e===this._SettingsClass.CropModes.FIT_WIDTH||e===this._SettingsClass.CropModes.FIT_HEIGHT)&&(this._autoSizeState=this._autoSizeStates.autoSizeNoLayoutUpdate),this._renderImage()}},getMinPhysicalHeight:function(){return this._getContentPaddingSize().y},render:function(){this._styleChanged(),this._renderImage(),this.parent(),this._renderLink()},_renderLink:function(){if(this.PREVENT_LINK_RENDER)return this._linkRenderer.removeRenderedLinkFrom(this._skinParts.link,this),void 0;var a=this.getDataItem(),b=a._data.link;if(!b)return this._linkRenderer.removeRenderedLinkFrom(this._skinParts.link,this),void 0;var c=this.resources.W.Data.getDataByQuery(b);c&&this._linkRenderer.renderLink(this._skinParts.link,c,this)},_renderImage:function(){if(this._layoutInitialized){var a=this._skinParts.img;if(a&&a.getOriginalClassName){var b=this._getImageSettings();a.setSettings(b),b.getCropMode()==b.CropModes.FIT_WIDTH?this.setHeight(a.getSize().y+this._getContentPaddingSize().y,!1,!1,!0):b.getCropMode()==b.CropModes.FIT_HEIGHT&&this.setWidth(a.getSize().x+this._getContentPaddingSize().x,!1,!1,!0),this._fireAutoSize()}}},_fireAutoSize:function(){this._autoSizeState!=this._autoSizeStates.none&&(this.fireEvent("autoSized",{ignoreLayout:this._autoSizeState==this._autoSizeStates.autoSizeNoLayoutUpdate}),this.resources.W.Config.env.$isEditorFrame||this.injects().Layout.notifyPositionChanged(this,"updateSize"),this._autoSizeState=this._autoSizeStates.none)},_styleChanged:function(){var a=this._getContentPaddingSize(!0);this.setMinH(a.y+this.MIN_IMAGE_HEIGHT),this.setMinW(a.x+this.MIN_IMAGE_WIDTH);var b=this._getPhotoInnerSize();this._getImageSettings().setSize(b.x,b.y)},_getContentPaddingSize:function(a){if(!this._contentPadding||a){this._contentPadding={};var b=this.getSkin();this._contentPadding.x=parseInt(b.getParamValue("contentPaddingLeft"),10)+parseInt(b.getParamValue("contentPaddingRight"),10),this._contentPadding.y=parseInt(b.getParamValue("contentPaddingTop"),10)+parseInt(b.getParamValue("contentPaddingBottom"),10),this._contentPadding.x=isNaN(this._contentPadding.x)?0:this._contentPadding.x,this._contentPadding.y=isNaN(this._contentPadding.y)?0:this._contentPadding.y,this.getSizeLimits().minH=this._contentPadding.y,this.getSizeLimits().minW=this._contentPadding.x}return this._contentPadding},_getImageSettings:function(){if(!this._imageSettings){var a=this._getPhotoInnerSize(),b=this._translateDisplayModeToImageCropMode(this._getDisplayMode());this._imageSettings=new this.imports.ImageSettings(b,a.x,a.y)}return this._imageSettings},_getPhotoInnerSize:function(){var a=this._getContentPaddingSize(),b=this.getWidth()-a.x,c=this.getHeight()-a.y;return{x:b,y:c}},_setTitle:function(){var a=this._data.get("title");this._skinParts.view.set("title",a)},_getDisplayMode:function(){return this.getComponentProperty("displayMode")},_getImageDisplayMode:function(){return this._getImageSettings()&&this._getImageSettings().getCropMode()},_translateDisplayModeToImageCropMode:function(a){var b=a;return"fitWidthStrict"==a&&(b=this._SettingsClass.CropModes.FIT_WIDTH),"fitHeightStrict"==a&&(b=this._SettingsClass.CropModes.FIT_HEIGHT),b},allowHeightLock:function(){return!this._isFitMode()},_isFitMode:function(){var a=["fitWidth","fitWidthStrict","fitHeightStrict"];return a.indexOf(this._getDisplayMode())>=0},_mediaGalleryCallback:function(a){this.getDataItem().setFields({title:a.title,description:a.description||"",height:a.height,width:a.width,uri:a.fileName})}})}),define.experiment.component("wysiwyg.viewer.components.WRichText.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"EDIT_RICH_TEXT",command:"EditorUI.StartEditRichText"}],mobile:{isTextScalable:!0,previewTextDataField:"text",disablePropertySplit:!0}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WRichText.TextBIEvents",function(a,b){var c=a;c.fields({_renderTriggers:[Constants.DisplayEvents.ADDED_TO_DOM,Constants.DisplayEvents.DISPLAYED],EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"EDIT_RICH_TEXT",command:"EditorUI.StartEditRichText",commandParameter:{source:"fpp"}}],mobile:{isTextScalable:!0,previewTextDataField:"text",disablePropertySplit:!0}}})}),define.experiment.component("wysiwyg.viewer.components.WSiteStructure.BackgroundPerPage",function(a,b){var c=a,d=b;c.utilize(["core.utils.css.Background"]),c.binds(d.customizeField(function(a){for(var b=["_invalidateBg","_validateBg"],c=a,d=0;d<b.length;d++){var e=c.indexOf(b[d]);c=c.slice(0,e).append(c.slice(e+1,c.length))}return c})),c.methods({_onAllSkinPartsReady:function(){var a=this.resources.W.Viewer.getDocWidth();this.setWidth(a),this._initBackgroundNode()},_initBackgroundNode:function(){this._bgNodes=$("bgNodes"),this._bgNodes||this._createBgNodesHook(),this._isIE8()?this._renderBgForIE8():this._bgNode||this._createBackground()},_renderBgForIE8:function(){this._bgNodes.setStyle("position","absolute"),this._bgNodes.setStyle("width","100%");var a="siteBg";this._structureState===Constants.ViewerTypesParams.TYPES.MOBILE&&(a="mobileBg"),this.resources.W.Theme._data?this._updateBgFromTheme(a):this.resources.W.Theme.addEvent("dataReady",function(){this._updateBgFromTheme(a)}.bind(this))},_updateBgFromTheme:function(a){var b=this.resources.W.Theme.getProperty(a),c=new this.imports.Background(b,this.resources.W.Theme);this._bgNodes.setStyle("background-color",c.getColor(!1)),this._bgNodes.setStyle("background-image",c.getUrl()),this._bgNodes.setStyle("background-attachment",c.getAttachment());var d=c.getRepeatX(),e=c.getRepeatY(),f="no-repeat";"repeat"===d&&"repeat"===e?f="repeat":"no-repeat"===d&&"repeat"===e?f="repeat-y":"repeat"===d&&"no-repeat"===e&&(f="repeat-x"),this._bgNodes.setStyle("background-repeat",f),this._bgNodes.setStyle("background-size",c.getWidth(!1)),this._bgNodes.setStyle("background-position",c.getPosition(!1))},_createBgNodesHook:function(){this._bgNodes=new Element("div",{id:"bgNodes",style:"position:relative; margin: 0 auto;"}),document.body.insertBefore(this._bgNodes,document.body.firstChild)},_createBackground:function(){this._structureState===Constants.ViewerTypesParams.TYPES.MOBILE?this._createMobileBackgroundNode():this._createDesktopBackgroundNode()},_createDesktopBackgroundNode:function(){var a={id:"desktopBgNode",comp:"wysiwyg.viewer.components.background.DesktopBackground",skin:"wysiwyg.viewer.skins.background.BackgroundSkin"};this._bgNode=this._createBgNode(a)},_createMobileBackgroundNode:function(){var a={id:"mobileBgNode",comp:"wysiwyg.viewer.components.background.MobileBackground",skin:"wysiwyg.viewer.skins.background.BackgroundSkin"};this._bgNode=this._createBgNode(a)},_createBgNode:function(a){var b=this._getBgNodeByCompId(a.id);if(!b){b=new Element("div",a);var c=this.resources.W.Config.mobileConfig.isMobile()?this.resources.W.Viewer.getDocWidth()+"px":"100%";b.setStyles({position:"relative",width:c,margin:"0 auto"}),b.wixify(),this._bgNodes.appendChild(b)}return b},_getBgNodeByCompId:function(a){return this._bgNodes.querySelector("#"+a)},_onThemePropertyChange:function(){this._isIE8()||this._bgNode.$logic._handleViewerStateChanged()},setHeight:function(a){if(this._siteHeight!==a){this._siteHeight=a,this.parent(a),this.resources.W.Viewer.siteHeightChanged(!0);var b=a+this._addAdditionalHeightToBGToCoverSiteStructure();this._isIE8()?this._bgNodes.setStyle("height",b):this._bgNode.$logic.updateRenderedBGWithHeight(b,this._getBottomPadding(this.resources.W.Config.env.$editorMode))}},_addAdditionalHeightToBGToCoverSiteStructure:function(){var a=0;return a=this._structureState===Constants.ViewerTypesParams.TYPES.DESKTOP?100:this._getBottomPadding(this.resources.W.Config.env.$editorMode)},_isIE8:function(){return!window.addEventListener},_updateBgProperty:d.remove(),_createDesktopBgNode:d.remove(),_createMobileBgNode:d.remove(),_isBgStyleChanged:d.remove(),_validateBg:d.remove(),_invalidateBg:d.remove(),collapse:d.remove(),uncollapse:d.remove(),_addBgEvents:function(){}})}),define.experiment.component("wysiwyg.viewer.components.WSiteStructure.LesserWidthIssue",function(a){a.methods({_createDesktopBackgroundNode:function(){var a={id:"desktopBgNode",comp:"wysiwyg.viewer.components.background.DesktopBackground",skin:"wysiwyg.viewer.skins.background.BackgroundSkin","min-width":this.resources.W.Viewer.getDocWidth()+"px"};this._bgNode=this._createBgNode(a)}})}),define.experiment.component("wysiwyg.viewer.components.WTwitterFollow.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WTwitterTweet.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.WixAds.BackgroundPerPage",function(a){var b=a;b.methods({_fixMobileBGPosition:function(){var a;a=document.getElementById("mobile_bgNode"),a&&a.setStyle("top",this._shouldDisplay()?"30px":"0px")}})}),define.experiment.newComponent("wysiwyg.viewer.components.background.AbstractBackground.BackgroundPerPage",function(a){var b=a;b.inherits("core.components.base.BaseComp"),b.skinParts({bgViewPort:{type:"htmlElement"},primary:{type:"htmlElement"},secondary:{type:"htmlElement"}}),b.resources(["W.Config","W.Theme","W.Viewer","W.Commands","W.Data","W.Utils"]),b.binds(["_handleViewerStateChanged","_handleResize","_renderBackground","_onPageChange","_onPageChangeEnded","_onTransitionComplete","_runTransition","_initBgParts"]),b.utilize(["core.managers.components.ComponentBuilder","core.utils.css.Background","core.utils.BackgroundHelper","wysiwyg.viewer.utils.TransitionUtils"]),b.statics({DEFAULT_TRANSITION_DIRECTION:0,VERTICAL_TRANSITION_DIRECTION:1}),b.states({visibility:["VISIBLE","INVISIBLE"]}),b.methods({initialize:function(a,b,c){this.parent(a,b,c),this._areBgPartsInitialized=!1,this._isBgAttachmentFixed=!1,this._bgStyles={},this._lastBgStyles={},this._showingBgPart=null,this._hiddenBgPart=null,this._pageToChangeTo=null,this._siteHeight=0,this._additionalSiteHeight=0,this._isPageChanging=!1,this._isDomDisplayReady=!1,this._transitionUtils=new this.imports.TransitionUtils,this._transitionNameToKey=_.invert(Constants.TransitionTypes),this._backgroundHelper=new this.imports.BackgroundHelper,this._registerBGListeners()},_registerBGListeners:function(){var a=this._isInEditorFrame();a||(this.resources.W.Viewer.addEvent("pageTransitionStarted",this._onPageChange),this.resources.W.Viewer.addEvent("pageTransitionEnded",this._onPageChangeEnded),this.resources.W.Viewer.addEvent("SiteReady",this._initBgParts)),this.resources.W.Commands.registerCommandAndListener("WPreviewCommands.WEditModeChanged",this,this._handlePreviewModeChangeToEditor),this.resources.W.Theme.addEvent("propertyChange",this._renderBackground),this.resources.W.Commands.registerCommandAndListener("WPreviewCommands.ViewerStateChanged",this,this._handleViewerStateChanged),this.resources.W.Commands.registerCommandAndListener("WPreviewCommands.CustomBackgroundChanged",this,this._renderBackground),this._bindWindowEvents()},_bindWindowEvents:function(){var a;a=this.resources.W.Config.env.isEditorInPreviewMode()||this.resources.W.Config.env.isPublicViewer()||this.resources.W.Config.env.$isEditorViewerFrame?window:W.Preview.getPreviewSite(),a.addEvent("resize",this._handleResize),this._siteWindow=a},_handlePreviewModeChangeToEditor:function(){this._handleResize()},_handleResize:function(){var a={};this._updateBgDefinitionPosition(a),this._updateSiteBgSize(a),this._setBGPositionAndDimension(a)},updateRenderedBGWithHeight:function(a,b){this._siteHeight=a,this._additionalSiteHeight=b,this._isPageChanging||this._fitBackgroundHeightToSite()},isRenderNeeded:function(a){var b=[this.INVALIDATIONS.SKIN_CHANGE,this.INVALIDATIONS.DATA_CHANGE];return a.isInvalidated(b)},_onPageChange:function(a){this._pageToChangeTo!==a&&(this._isPageChanging=!0,this._fitBackgroundHeightToSite(),this._renderPageBackground(a))},_renderPageBackground:function(a){var b=null===this._pageToChangeTo;this._pageToChangeTo=a,b||this._isBackgroundInvisible()?(this._renderBackground(),this._handleTabletBackgroundPos(),this._notifyBGComponentReady()):(this._renderSecondaryBg(this._pageToChangeTo),this._runTransition())},_isBackgroundInvisible:function(){return"INVISIBLE"===this.getState("visibility")},_onPageChangeEnded:function(a){this._pageToChangeTo===a&&(this._isPageChanging=!1,this._fitBackgroundHeightToSite())},_fitBackgroundHeightToSite:function(){if(this._areBgPartsInitialized){var a=this._calculateHeight();this._bgViewPort.setStyle("height",a),this._showingBgPart.setStyle("height",a),this._hiddenBgPart.setStyle("height",a)}},_renderBackground:function(){var a=this.resources.W.Viewer.getCurrentPageId();this._onRenderBg(a,this._showingBgPart),this._ensureVisibilityStyles(),this._resetShowingBgPartPosition(),this.resources.W.Utils.forceBrowserRepaint(this.$view,0,["chrome"])},_arePageBGsDifferent:function(){var a=this._getNodeBgStyle(this._showingBgPart),b=this._getNodeBgStyle(this._hiddenBgPart);return!_.isEqual(a,b)},_onTransitionComplete:function(){var a=this._showingBgPart;this._showingBgPart=this._hiddenBgPart,this._hiddenBgPart=a,this._ensureVisibilityStyles(),this._resetShowingBgPartPosition(),this._afterTransition()},_ensureVisibilityStyles:function(){this._hiddenBgPart.setStyle("visibility","hidden"),this._hiddenBgPart.setStyle("display","none"),this._hiddenBgPart.setStyle("opacity",0),this._showingBgPart.setStyle("visibility","visible"),this._showingBgPart.setStyle("display","block"),this._showingBgPart.setStyle("opacity",1)},_resetBgPartsStyles:function(a){a&&a.name===Constants.TransitionTypes.CROSS_FADE||a.name===Constants.TransitionTypes.SHRINK_FADE||a.name===Constants.TransitionTypes.OUT_IN?this._hiddenBgPart.setStyle("opacity",0):this._hiddenBgPart.setStyle("opacity",1),this._hiddenBgPart.setStyle("visibility","visible"),this._hiddenBgPart.setStyle("display","block"),this._hiddenBgPart.setStyle("left",0),this._showingBgPart.setStyle("visibility","visible"),this._showingBgPart.setStyle("display","block"),this._showingBgPart.setStyle("opacity",1),this._bgViewPort.setStyle("top",0)},_renderSecondaryBg:function(a){this._onRenderBg(a,this._hiddenBgPart)},_initBgParts:function(){this._bgViewPort=this._skinParts.bgViewPort,this._showingBgPart=this._skinParts.primary,this._hiddenBgPart=this._skinParts.secondary;
var a=this._calculateWidth(),b=this._calculateHeight();this._bgViewPort.setStyle("width",a),this._bgViewPort.setStyle("height",b),this._hiddenBgPart.setStyle("left",a),this.resources.W.Viewer.removeEvent("SiteReady",this._initBgParts),this._renderBackground(),this._handleResize(),this._areBgPartsInitialized=!0},_isBgStyleChanged:function(a){this._getNodeBgStyle(a),this._getLastNodeBgStyle(a);return!0},_onRender:function(){if(this._showingBgPart){var a=this.resources.W.Viewer.getCurrentPageId();this._onRenderBg(a,this._showingBgPart)}},isDomDisplayReadyOnReady:function(){return this._isDomDisplayReady},_notifyBGComponentReady:function(){this._isDomDisplayReady=!0,this.$view.fireEvent(Constants.ComponentEvents.DOM_DISPLAY_READY)},_updateSiteBgSize:function(a){a.height=this._calculateHeight(),a.width=this._calculateWidth()},_onRenderBg:function(a,b){if(b&&a){var c=this._getPageCustomBGDataItem(a);if(this._isPageBackgroundCustom(c)){var d=c.ref;if(d){var e=this.resources.W.Data.getDataByQuery(d),f=e.getData();this._renderCustomPageBG(f,b)}else this._renderCrossSiteBG(b)}else this._renderCrossSiteBG(b)}},_isPageBackgroundCustom:function(a){return a&&a.custom},_isCustomBGForced:function(){return!0},_getPageDataItem:function(a){var b=this.resources.W.Data,c=b.normalizeQueryID(a);return b.getDataByQuery(c)},_renderCustomPageBG:function(a,b){var c=this._backgroundHelper.createBgCssValueFromDataItem(a),d=new this.imports.Background(c,this.resources.W.Theme);this._updatePositionAndStyles(b,d)},_renderCrossSiteBG:function(a){var b=this.resources.W.Theme.getProperty(this._getBgDeviceType());this._updatePositionAndStyles(a,b)},_updatePositionAndStyles:function(a,b){this._updateBgStyleFromBgDefinition(a,b),this._updateBgDefinitionPosition(this._getNodeBgStyle(a)),this._applyBackgroundStyles(a)},_applyBackgroundStyles:function(a){var b=this._getNodeBgStyle(a);this._setLastBgStyle(a,Object.clone(b)),this._setBGPositionAndDimension(b),delete b.left,a.setStyles(b)},_getNodeBgStyle:function(a){return this._getNodeBgFromStyles(a,this._bgStyles)},_getLastNodeBgStyle:function(a){return this._getNodeBgFromStyles(a,this._lastBgStyles)},_getNodeBgFromStyles:function(a,b){var c=null;if(a&&b){var d=a.getAttribute("skinPart");c=b[d],c||(c={},b[d]=c)}return c},_setLastBgStyle:function(a,b){if(a&&b){var c=a.getAttribute("skinPart");this._lastBgStyles[c]=b}},_setBGPositionAndDimension:function(a){for(var b=[this._showingBgPart,this._hiddenBgPart,this._bgViewPort],c=0;c<b.length;c++){var d=b[c];d&&(d.setStyle("height",a.height),d.setStyle("width",a.width))}this._hiddenBgPart&&this._hiddenBgPart.setStyle("left",a.width),this._bgViewPort&&this._bgViewPort.setStyle("left",a.left),this._bgViewPort&&this._bgViewPort.setStyle("top",a.top)},_updateBgStyleFromBgDefinition:function(a,b){if(b){this._updateBgAttachmentProperty(b);var c=this._getNodeBgStyle(a);c["background-attachment"]=this._resolveBgAttachment(b),c["background-image"]=b.getUrl(),c["background-size"]=b.getCssSizeValue(),c["background-position"]=b.getPositionX()+" "+b.getPositionY(),c["background-position-x"]=b.getPositionX(),c["background-position-y"]=b.getPositionY(),c["background-repeat"]=b.getRepeatX()+" "+b.getRepeatY(),c["background-color"]=this._resolveBackgroundThemeColor(b),this._updateSiteBgSize(this._getNodeBgStyle(this._showingBgPart)),this._updateSiteBgSize(this._getNodeBgStyle(this._hiddenBgPart))}},_resolveBgAttachment:function(a){var b="";return b=this._isMobile()?"scroll":this._isTablet()?"":a.getAttachment()},_isTablet:function(){return this.resources.W.Config.mobileConfig.isTablet()},_resolveBackgroundThemeColor:function(a){var b;return a.getColorReference()?(b=this.resources.W.Theme.getProperty(a.getColorReference()),b=b.getHex()):b=a.getColor(),b},_updateBgAttachmentProperty:function(a){var b=this._isBackgroundFixed(a);this._isBgAttachmentFixed!==b&&(this._isBgAttachmentFixed=b)},_getPageCustomBGDataItem:function(a){var b=null;if(a){var c=this._getPageDataItem(a),d=c.get("pageBackgrounds");b=this._getCustomBackground(d)}return b},_isInEditorFrame:function(){return this.resources.W.Config.env.$isEditorFrame},_isMobileView:function(){return this.resources.W.Config.env.isViewingSecondaryDevice()},_isDesktopView:function(){return this.resources.W.Config.env.isViewingDesktopDevice()},_isBackgroundFixed:function(a){return!this._isMobile()&&a&&"scroll"!==a.getAttachment()},_resetShowingBgPartPosition:function(){this._showingBgPart.setStyle("top","0"),this._showingBgPart.setStyle("left","0")},_afterTransition:function(){this._handleTabletBackgroundPos()},_handleTabletBackgroundPos:function(){this._isBgAttachmentFixed&&!this._isMobile()?this._bgViewPort.setStyle("position","fixed"):this._bgViewPort.setStyle("position","absolute")},_isMobile:function(){},_beforeTransition:function(){},_runTransition:function(){},_handleViewerStateChanged:function(){},_updateBgDefinitionPosition:function(){},_calculateWidth:function(){},_calculateHeight:function(){},_getCustomBackground:function(){}})}),define.experiment.newComponent("wysiwyg.viewer.components.background.DesktopBackground.BackgroundPerPage",function(a){var b=a;b.inherits("wysiwyg.viewer.components.background.AbstractBackground"),b.statics({CUSTOM_PAGE_BG_PROPERTY:"desktopBg"}),b.dataTypes(["BackgroundImage"]),b.methods({_calculateWidth:function(){return document.getScrollWidth()+"px"},_calculateHeight:function(){var a=0;return a=this._isBgAttachmentFixed?document.getSize().y+this._additionalSiteHeight:Math.max(document.getSize().y,this._siteHeight),a+"px"},_runTransition:function(){if(this._arePageBGsDifferent()){this._beforeTransition();var a=this._getPageTransition();this._resetBgPartsStyles(a),a.anim?this._runAnimation(a):(console.error("Page transition '%s' not found.",a.name),this._onTransitionComplete())}},_beforeTransition:function(){var a="background-attachment",b=this._additionalSiteHeight+document.getSize().y;"fixed"===this._showingBgPart.getStyle(a)&&(this._showingBgPart.setStyle("height",b),this._showingBgPart.setStyle(a,"")),"fixed"===this._hiddenBgPart.getStyle(a)&&(this._hiddenBgPart.setStyle("height",b),this._hiddenBgPart.setStyle(a,"")),this._bgViewPort.setStyle("position","fixed")},_afterTransition:function(){this.parent(),this._restoreBackgroundAttachmentValue(this._showingBgPart),this._restoreBackgroundAttachmentValue(this._hiddenBgPart)},_restoreBackgroundAttachmentValue:function(a){var b=this._getNodeBgStyle(a)["background-attachment"];a.setStyle("background-attachment",b)},_getPageTransition:function(){var a=this.resources.W.Viewer.getPageGroup().getComponentProperty("transition");return{name:a,anim:this._transitionUtils.getTransition(a)}},_runAnimation:function(a){var b=a.name,c=a.anim,d=this._getAnimationDuration(b),e=this._getAnimationDirection(b);c(this._showingBgPart,this._hiddenBgPart,e,d,this._onTransitionComplete)},_getAnimationDuration:function(a){var b=this._transitionNameToKey[a];return b?Constants.TransitionDefaults[b].durationInSec:Constants.TransitionDefaults.NONE.durationInSec},_getAnimationDirection:function(a){return Constants.TransitionTypes.SWIPE_VERTICAL_FULLSCREEN!==a?this.DEFAULT_TRANSITION_DIRECTION:this.VERTICAL_TRANSITION_DIRECTION},_getBgDeviceType:function(){return"siteBg"},_updateBgDefinitionPosition:function(a){a&&(a.left=0,a.top=0)},_handleViewerStateChanged:function(a){a&&"DESKTOP"===a.viewerMode||!a&&this._isDesktopView()?(this.setState("VISIBLE","visibility"),this._renderBackground(),this._handleResize()):this.setState("INVISIBLE","visibility")},_getCustomBackground:function(a){return a?a.desktop:null},_updateBgAttachmentProperty:function(a){var b=this._isBackgroundFixed(a);this._isBgAttachmentFixed!==b&&(this._isBgAttachmentFixed=b,this._isBgAttachmentFixed&&this._bgViewPort.setStyle("top","0"))},_isMobile:function(){return!1}})}),define.experiment.newComponent("wysiwyg.viewer.components.background.MobileBackground.BackgroundPerPage",function(a){var b=a;b.inherits("wysiwyg.viewer.components.background.AbstractBackground"),b.statics({CUSTOM_PAGE_BG_PROPERTY:"mobileBg",MOBILE_TOP_MARGIN_IN_EDITOR:0,MOBILE_BOTTOM_DECORATION_IN_EDITOR_HEIGHT:65}),b.dataTypes(["BackgroundImage"]),b.methods({_getDeviceWidth:function(){return this.resources.W.Viewer.getDocWidth()},_calculateWidth:function(){return this._getDeviceWidth()+"px"},_calculateHeight:function(){var a=parseInt(this._siteHeight);return isNaN(a)&&(a=0),a=this._isInEditorViewerFrame()?Math.max(this._getDeviceHeight()-this.MOBILE_BOTTOM_DECORATION_IN_EDITOR_HEIGHT,a):Math.max(this._getDeviceHeight(),a),a+"px"},_getDeviceHeight:function(){return document.getSize().y},_isInEditorViewerFrame:function(){return this.resources.W.Config.env.$isEditorViewerFrame},_isMobile:function(){return!0},_getBgDeviceType:function(){return"mobileBg"},_runTransition:function(){this._arePageBGsDifferent()&&this._onTransitionComplete()},_updateBgDefinitionPosition:function(a){if(a)if(a.top=this.resources.W.Config.env.$isEditorViewerFrame&&!this.resources.W.Config.env.isEditorInPreviewMode()?this.MOBILE_TOP_MARGIN_IN_EDITOR+"px":(this._isBgAttachmentFixed?$(document.body).scrollTop:0)+"px",this._isOnPublicMobileDevice())a.left="0px";else{var b=$(document.body).getSize().x,c=this._getDeviceWidth();a.left=.5*(b-c)+"px"}},_isOnPublicMobileDevice:function(){return this.resources.W.Config.env.isPublicViewer()&&!this.resources.W.Config.forceMobileOptimizedViewOn()},_handleViewerStateChanged:function(a){a&&"DESKTOP"!==a.viewerMode||!a&&this._isMobileView()?(this.setState("VISIBLE","visibility"),this._renderBackground(),this.updateRenderedBGWithHeight(this._calculateHeight()),this._handleResize()):this.setState("INVISIBLE","visibility")},_handlePreviewModeChangeToEditor:function(a){if(this._handleResize(),"PREVIEW"===a)this._handleViewerStateChanged(),this._resetShowingBgPartPosition(),this._bgViewPort.setStyle("top","0");else{var b={};this._updateBgDefinitionPosition(b),this._bgViewPort.setStyle("left",b.left),this._bgViewPort.setStyle("top",b.top)}},_getCustomBackground:function(a){return a?a.mobile.isPreset?a.desktop:a.mobile:null}})}),define.experiment.component("wysiwyg.viewer.components.inputs.ComboBoxInput.AppBuilderTagsEditor",function(a,b){a.binds(b.merge(["_onFocus"])),a.methods({_onAllSkinPartsReady:b.after(function(){this._skinParts.collection.addEvent(Constants.CoreEvents.FOCUS,this._onFocus)}),_onFocus:function(){this.fireEvent("focus")}})}),define.experiment.component("wysiwyg.viewer.components.mobile.TinyMenu.CustomSiteMenu",function(a,b){var c=a,d=b;c.methods({initialize:d.after(function(){this._NO_LINK_PROPAGATION=!0,this._linkRenderer=this.resources.W.Viewer.getLinkRenderer()}),render:function(){var a=this._data.getItems(!0);this._asyncGetChildren(a,function(a){var b=this._skinParts.menuContainer;if(this._clearOldContent(b),_.isEmpty(a))return this._mainMenu=void 0,!1;this._mainMenu=this._initMenu(a,b);var c=this.resources.W.Viewer.getCurrentPageId();this._setCurrentPage(this._mainMenu,c)}.bind(this)),this.parent()},_addItems:function(a,b){var c,d;a.forEach(function(a){var e;a.isVisibleMobile()&&(e=this._buildItem(a),a.hasVisibleItemsMobile()&&(c=this._buildToggleButton(),d=this._buildMenu(a.getItems()),this._addElement(e,c),this._addElement(e,d)),this._addElement(b,e))}.bind(this))},_buildItem:function(a){var b=new Element("li");a.hasItems()&&b.setAttribute("class","hasChildren");var c=this._buildLink(a);return b=this._addElement(b,c)},_buildLink:function(a){var b=new Element("a"),c=a.getLinkedDataItem();return b.innerHTML=a.getLabel(),b.addEvent("click",this._closeMainMenu.bind(this)),c&&this._linkRenderer.renderLink(b,c,this),b},_asyncGetSinglePage:function(a,b){return a.isVisibleMobile()?(b(a),void 0):(b(null),void 0)},_getItemData:function(a){var b={};return b.link=a.get("link"),b.name=a.get("label"),b.children=[],b}})}),define.experiment.component("wysiwyg.viewer.components.svgshape.SvgShape.AddMediaGalleryBI",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"SVGSHAPE_SELECT_SKIN",command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"FPP",publicMediaFile:"shapes",i18nPrefix:"shape",selectionType:"single",callback:"_mediaGalleryCallback",hasPrivateMedia:!1}}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{commandSource:"dblClick",publicMediaFile:"shapes",i18nPrefix:"shape",selectionType:"single",callback:"_mediaGalleryCallback",hasPrivateMedia:!1}}}}),c.methods({_mediaGalleryCallback:d.after(function(){this._logChangeMediaSuccess()}),_logChangeMediaSuccess:function(){LOG.reportEvent(wixEvents.CHANGE_IMAGE_CLICK_SUCCESS,{c1:this.className})}})}),define.experiment.component("wysiwyg.viewer.components.svgshape.SvgShape.EditorMetaDataRelocation",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:{general:{settings:!0,design:!1},custom:[{label:"SVGSHAPE_SELECT_SKIN",command:"WEditorCommands.OpenMediaFrame",commandParameter:{publicMediaFile:"shapes",i18nPrefix:"shape",selectionType:"single",callback:"_mediaGalleryCallback",hasPrivateMedia:!1}}],dblClick:{command:"WEditorCommands.OpenMediaFrame",commandParameter:{publicMediaFile:"shapes",i18nPrefix:"shape",selectionType:"single",callback:"_mediaGalleryCallback",hasPrivateMedia:!1}}}}),c.fields({EDITOR_META_DATA:d.remove()})}),define.experiment.component("wysiwyg.viewer.components.svgshape.SvgShape.ProportionalScaling",function(a,b){var c=a,d=b;c.statics({EDITOR_META_DATA:d.merge({general:{proportionalResize:!0}})})}),define.experiment.Class("wysiwyg.viewer.managers.ActionsManager.AnimationPageTransitions",function(a,b){var c=a,d=b;c.resources(d.merge(["ActionsEnabledMap"])),c.utilize(d.merge(["wysiwyg.viewer.managers.actions.PageTransitionAction","wysiwyg.common.behaviors.Transitions"])),c.methods({initialize:function(){this._actionsEnabledMap=this.resources.ActionsEnabledMap,this._anyActionEnabledInMap=_.any(this._actionsEnabledMap,Boolean),this._animations=new this.imports.Animations,this._transitions=new this.imports.Transitions(this._animations),this._createActionsInstances(),this._setActionsListeners()},registerComponent:function(a,b,c){var d,e=b.getComponentId();if(c=c||{},"string"==typeof c)try{c=JSON.parse(c)}catch(f){return LOG.reportError(wixErrors.ANIMATIONS_REGISTER_CORRUPTED_DATA,"ActionsManager","registerComponent",{dsc:e}),void 0}for(d in this._actions)this._actions[d].removeComponentBehaviors(e);for(d in c)this._actions[d]&&this.isActionEnabledForSession(d)&&this._addBehaviorsByAction(a,e,c,d)},_createActionsInstances:function(){this._actions[Constants.Actions.PAGE_IN]=new this.imports.PageInAction(this._animations),this._actions[Constants.Actions.SCREEN_IN]=new this.imports.ScreenInAction(this._animations),this._actions[Constants.Actions.PAGE_TRANSITION]=new this.imports.PageTransitionAction(this._transitions)},_setActionsListeners:function(){_.forEach(this._actions,function(a,b){this.isActionEnabledForSession(b)?(a.setActionListeners(),a.setActiveState(!0)):a.setInactiveActionListeners()},this)},isActionEnabledForSession:function(a){return this._actionsEnabledMap[a]},isAnyActionsEnabledForSession:function(){return this._anyActionEnabledInMap}})}),define.experiment.Class("wysiwyg.viewer.managers.LayoutManager.BoxSlideShow",function(a,b){var c=a;c.fields({LOCK_THRESHOLD:70,DEFAULT_MARGIN:10,SUGGEST_ANCHOR_MARGIN:20,FLAG_DIRTY_TOP:1,FLAG_DIRTY_BOTTOM:2,STOP_LAYOUT_ACTION:!1}),c.methods({_getAnchoredH:function(a){var b=a.fromComp.getBoundingHeight(),c=a.fromComp.getBoundingY()+b;return a.locked?c+=a.distance:!this.resources.W.Viewer.isPageComponent(a.toComp.getOriginalClassName())&&this.resources.W.Viewer.canHaveFatherHeight(a.toComp)&&(c+=this.DEFAULT_MARGIN),a.type==a.ANCHOR_BOTTOM_BOTTOM?c-=a.toComp.getBoundingY():a.type==a.ANCHOR_BOTTOM_PARENT&&a.toComp.getInlineContentContainer&&this._isInlineContentNonZeroSize(a.toComp)&&(c+=this._getContainerMarginHeight(a.toComp)),c},_setAnchorableDistance:function(a,b){if("wysiwyg.common.components.boxslideshow.viewer.BoxSlideShow"===a.toComp.$className&&"wysiwyg.common.components.boxslideshowslide.viewer.BoxSlideShowSlide"===a.fromComp.$className||"wysiwyg.common.components.boxslideshowslide.viewer.BoxSlideShowSlide"===a.toComp.$className&&"wysiwyg.common.components.boxslideshowslide.viewer.BoxSlideShowSlide"===a.fromComp.$className)return a.distance=0,void 0;var c=a.fromComp,d=a.toComp;void 0!==c.isAnchorable().from.distance?b=c.isAnchorable().from.distance:void 0!==d.isAnchorable().to.distance&&(b=d.isAnchorable().to.distance),a.distance=b},updateChildAnchors:function(a){if(a&&a.getChildComponents){var b=a.getChildComponents();if(!this._validateNodesRendered(b))return;b.length>0?this._updateAnchors(b[0].getLogic(),[],!0):this._clearReverseAnchorsByScope(a.getReverseAnchors(),!0),this.checkAndUpdateChildOfChildIfNeeded(a)}},checkAndUpdateChildOfChildIfNeeded:function(a){if(a.waitTillMeasureToPreformLayoutChanges()&&a&&a.getChildComponents){var b=a.getChildComponents();b.map(function(a){this.updateChildAnchors(a.$logic)}.bind(this))}},updateLayoutAction:function(a){this.STOP_LAYOUT_ACTION=a},_updateLayout:function(){if(!this.STOP_LAYOUT_ACTION){this._nextRenderId=null;var a=this._getLayoutRootComp();this._measureInvalidatedComps(a),this._enforceAnchorsRecurse(a),this.fireEvent("UpdateLayoutDone")}}})}),define.experiment.Class("wysiwyg.viewer.managers.LayoutManager.FixBottomTopAnchor",function(a,b){var c=a;c.methods({_getMaxAnchoredY:function(a,b){var c=this._getAnchoredY,d=b;return a.getReverseAnchors().forEach(function(a){if(a.type==a.ANCHOR_BOTTOM_TOP||a.type==a.ANCHOR_TOP_TOP){a.type!=a.ANCHOR_BOTTOM_TOP||a.locked||(d=Math.max(a.originalValue,d));var b=c(a);d=Math.max(b,d)}}),d}})}),define.experiment.Class("wysiwyg.viewer.managers.LayoutManager.LandingPageSupport",function(a){a.methods({_measureInvalidatedComps:function(a){if(a.getIsDisplayed()&&(!a.NEW_BASE_COMP&&a.isMeasureNeeded()&&a.measure(),a.getChildComponents)){var b;b=a.getCurrentChildren?a.getCurrentChildren():a.getChildComponents();for(var c=0;c<b.length;c++)b[c].$logic&&b[c].$alive&&this._measureInvalidatedComps(b[c].$logic)}},_getLayoutRootComp:function(){return W.Viewer.isCurrentPageLandingPage()?W.Viewer.getPagesContainer().$logic:W.Viewer.getSiteNode().$logic},recalculateSiteHeight:function(){var a=W.Viewer.getSiteNode().$logic,b=a.getHeight(),c=this.getComponentMinResizeHeight(a);b!==c&&a.setHeight(c)},_enforceAnchorsRecurse:function(a){var b;if(a.getChildComponents){b=a.getCurrentChildren?a.getCurrentChildren():a.getChildComponents();for(var c=[],d=!1,e=0;e<b.length;e++)b[e].$logic&&b[e].$alive&&(d=this._enforceAnchorsRecurse(b[e].$logic),(d||b[e].$logic.wasHeightChanged())&&(b[e].$logic.validateHeight(),c.push(b[e].$logic)));return 0==c.length?!1:this.enforceAnchors(c,!1,void 0,void 0,!0)}}})}),define.experiment.Class("wysiwyg.viewer.managers.LayoutManager.NBC_FixMeasureBug",function(a,b){var c=a;c.methods({_isInlineContentNonZeroSize:function(a){return a.NEW_BASE_COMP?a.getInlineContentContainer().$measure.height>0:a.getInlineContentContainer().getSize().y>0},_getContainerMarginHeight:function(a){var b=a.NEW_BASE_COMP?a.getInlineContentContainer().$measure.height:a.getInlineContentContainer().getSize().y;return a.getPhysicalHeight()-b},_createToParentAnchor:function(a,b){var c=a.getBoundingY(),d=a.getBoundingHeight(),e=b.NEW_BASE_COMP?b.getInlineContentContainer().$measure.height:b.getInlineContentContainer().getSize().y,f=new this._AnchorClass;return f.type=f.ANCHOR_BOTTOM_PARENT,f.fromComp=a,f.toComp=b,this._setAnchorableDistance(f,e-c-d),this._setAnchorableIsLocked(f),f.topToTop=c,f.originalValue=e,f}})}),define.experiment.Class("wysiwyg.viewer.managers.PageManager.EditorLoadPerPage",function(a,b){var c=a;c.methods({_getFirstPageId:function(){var a=this._dataResolver.getMainPageId(),b=W.Viewer.getCurrentPageId(),c=this._getPageIdFromHash(),d=[];return d=W.Config.env.isPublicViewer()?[c,a]:W.Config.env.isViewingDesktopDevice()?[a]:[b,a],this._getPageIdToLoad(d)},_getPageIdToLoad:function(a){var b=this._dataResolver.getPagesIds(),c=_.find(a,function(a){return!!a&&_.contains(b,a)});return c||_.first(b)},_getPageIdFromHash:function(){var a=this.resources.W.Utils.hash.getHashParts();return"zoom"===a.id?a.extData.match("([^/]+)/([^/]+)")[1]:a.id},getLoadedPageIds:function(){return _.keys(this._loadedPages)}})}),define.experiment.Class("wysiwyg.viewer.managers.PageManager.LandingPageSupport",function(a,b){var c=a;c.resources(b.merge(["W.Commands"])),c.binds(b.merge(["_hideSiteNode"])),c.methods({_createMasterPage:function(){var a=new this.imports.MasterPageHandler(this._dataResolver,this._viewerName);this._propagateEvents(a);var b=a.loadMasterSignatureHtml();return b.then(this._hideSiteNode),this._masterPageHandler=a,b},_hideSiteNode:function(a){a.rootCompNode.setStyle("opacity",0)}})}),define.experiment.Class("wysiwyg.viewer.managers.SiteMembersManager.SiteMemberAdditionalTranslations",function(a,b){a.resources(["W.Viewer","W.Utils","W.Config","W.MessagesController","W.Resources","W.Experiments"]),a.methods({initialize:b.after(function(){this._loadTranslations()}),_loadTranslations:function(){W.Resources.loadLanguageBundle("SITE_MEMBER_MANAGER",function(){})},_logoutSiteMember:function(){if(this._apiReady){var a=this.resources.W.Resources.get("SITE_MEMBER_MANAGER","SITEMEMBERMANGAGER_LOGOUT_MESSAGES_TITLE",this.LOGOUT_MESSAGES.TITLE),b=this.resources.W.Resources.get("SITE_MEMBER_MANAGER","SITEMEMBERMANGAGER_LOGOUT_MESSAGES_IN_PROGRESS",this.LOGOUT_MESSAGES.IN_PROGRESS);this.resources.W.MessagesController.showTryAgainMessage(a,b,this.MAX_NUMBER_OF_RETRIES*this.DELAY_OF_RETRY_IN_MS,this.logout.bind(this)),delete this._token,this._logoutUser()}},_informSiteOwnerToLogout:function(){var a=this.resources.W.Resources.get("SITE_MEMBER_MANAGER","SITEMEMBERMANGAGER_OWNER_LOGOUT_ACTION_TITLE",this.OWNER_LOGOUT_ACTION.TITLE),b=this.resources.W.Resources.get("SITE_MEMBER_MANAGER","SITEMEMBERMANGAGER_OWNER_LOGOUT_ACTION_MESSAGE",this.OWNER_LOGOUT_ACTION.MESSAGE);W.MessagesController.showMessage(a,b,function(){})}})}),define.experiment.newClass("wysiwyg.viewer.managers.SocialActivityDataManager.SocialActivity.New",function(a){a.inherits("core.managers.data.DataManager"),a.fields({}),a.statics({_defaultPresets:{id01:{type:"SocialActivitySettings",activeNetworks:["fb","tw"],iconSize:35,showCondition:1,theme:"light"},id02:{type:"SocialActivitySettings",activeNetworks:["fb","tw","pi"],iconSize:25,showCondition:1,theme:"default"},id03:{type:"SocialActivitySettings",activeNetworks:["fb","tw","pi"],iconSize:25,showCondition:1,theme:"default"},id04:{type:"SocialActivitySettings",activeNetworks:["fb","tw","pi"],iconSize:25,showCondition:1,theme:"default"}}}),a.resources(["SN.FacebookSocialNetwork","SN.TwitterSocialNetwork","SN.PinterestSocialNetwork"]),a.methods({initialize:function(){this.parent()},getDefaultPreset:function(){return Object.values(this.getPresets())[0]},getPresets:function(){return this.isDataAvailable("#id01")||this._createPreset(),this.getDataByQueryList(Object.keys(this._defaultPresets).map(function(a){return"#"+a}))},_createPreset:function(){_.each(this._defaultPresets,function(a,b){this.addDataItem(b,a)},this)},isPreset:function(a){return a&&this._defaultPresets[a.get("id")]?!0:!1},getSocialNetwork:function(a){var b={fb:this.resources.SN.FacebookSocialNetwork,tw:this.resources.SN.TwitterSocialNetwork,pi:this.resources.SN.PinterestSocialNetwork};return b[a]||b}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.BoxSlideShow",function(a,b){var c=a;c.methods({canHaveFatherHeight:function(a){return a._childCanHaveFatherSize===!0}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.CustomSiteMenu",function(a,b){var c=a,d=b;c.utilize(d.merge(["wysiwyg.common.utils.LinkRenderer"])),c.methods({getLinkRenderer:function(){return this._linkRenderer||(this._linkRenderer=new this.imports.LinkRenderer(this,this.resources.W.Data)),this._linkRenderer},getMainMenu:function(a){return this.resources.W.Data.getDataByQuery(a?"#CUSTOM_MAIN_MENU":"#MAIN_MENU")}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.EditorLoadPerPage",function(a,b){a.utilize(b.merge(["wysiwyg.viewer.managers.viewer.SiteDataHandler"])),a.fields({_siteDataHandlerPromise:null}),a.methods({_initMembers:b.before(function(){this._siteDataHandlerPromise=Q.defer()}),_setPageOnSiteLoad:b.before(function(){if(this.resources.W.Config.env.$isEditorViewerFrame){var a=this.getSiteView("DESKTOP").getPageManager(),b=new this.imports.SiteDataHandler(a,this._dataResolver);this._siteDataHandlerPromise.resolve(b)}}),getSiteDataHandlerPromise:function(){if(!this.resources.W.Config.env.$isEditorViewerFrame)throw"SiteData should be used only in the Editor";return this._siteDataHandlerPromise.promise},_registerPageConfiguration:function(){this._pageConfigurationRepository.registerPageType("Page",function(a){return a.tpaApplicationId?"TpaPage":a.type}),this._pageConfigurationRepository.registerConfig("Page",{})}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.ExitMobileMode",function(a,b){var c=a;c.methods({initiateSite:function(a){var b=this,c=function(c){var d=b._isDesktopModeImposed(),e=!d&&c&&(W.Config.isMobileOptimizedViewOn()||W.Config.forceMobileOptimizedViewOn()),f=e?Constants.ViewerTypesParams.TYPES.MOBILE:Constants.ViewerTypesParams.TYPES.DESKTOP;b._firstActiveViewerLoad(f),(W.Config.mobileConfig.isMobile()||a===Constants.ViewerTypesParams.TYPES.DESKTOP)&&b._mobileHandler.setMobileSite(f),b._activeViewer_.initiateSite(),d&&(MobileUtils.setViewportContent(""),MobileUtils.fixViewportScale(),b._removePreloader())};a!==Constants.ViewerTypesParams.TYPES.DESKTOP&&W.Config.env.$isPublicViewerFrame&&(W.Config.mobileConfig.isMobile()||W.Config.forceMobileOptimizedViewOn())?this._dataResolver.isStructureExists(Constants.ViewerTypesParams.TYPES.MOBILE).then(c):c(!1)},_isDesktopModeImposed:function(){if(this._desktopSiteImposing)return!0;var a=W.CookiesManager.getCookie("desktopSiteImposing");return a?(this._desktopSiteImposing=!0,W.CookiesManager.removeCookie("desktopSiteImposing"),!0):!1},_removePreloader:function(){var a=document.getElementById("viewer_preloader");a&&document.body.removeChild(a);var b=document.getElementById(Constants.ViewerTypesParams.DOM_ID_STATIC_PREFIX+"viewer_preloader");b&&document.body.removeChild(b)}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.LandingPageSupport",function(a,b){a.traits(b.merge(["core.events.EventDispatcher"])),a.utilize(b.merge(["wysiwyg.viewer.utils.TransitionUtils"])),a.methods({initialize:b.after(function(){this.resources.W.Commands.registerCommandAndListener("Viewer.ToggleLandingPageMode",this,this._onToggleLandingPageMode),this._transitionUtils=new this.imports.TransitionUtils,this._Tween=this.resources.W.Utils.Tween}),_onToggleLandingPageMode:function(a){var b=a.toLanding;this._toggleMasterPageComponentsVisibility(b);var c=[this.getPagesContainer().$logic,this.getHeaderContainer().$logic,this.getFooterContainer().$logic];a.isFirstLoad?_.invoke(c,"toggleLandingPageMode",b):_.invoke(c,"toggleLandingPageMode",b,this._Tween)},_toggleMasterPageComponentsVisibility:function(a){var b=this._getTopLevelMasterPageComponents();_.forEach(b,function(b){a?b.collapse():b.uncollapse()})},_getTopLevelMasterPageComponents:function(){return _.filter(this.getSiteNode().getChildren(),function(a){return"PAGES_CONTAINER"!==a.$logic.getComponentId()})},isCurrentPageLandingPage:function(){var a=this.getPageGroup();return a&&a.isCurrentPageLandingPage()},_initSiteView:b.after(function(){this.once("SiteReady",this,this._setSiteToVisible)}),_setSiteToVisible:function(){this.isCurrentPageLandingPage()&&this.resources.W.Commands.executeCommand("Viewer.ToggleLandingPageMode",{toLanding:!0,isFirstLoad:!0}),this.getSiteNode().setOpacity(1)}})}),define.experiment.Class("wysiwyg.viewer.managers.WViewManager.RichTextMigrationStudio",function(a,b){var c=a,d=b;c.utilize(d.merge(["wysiwyg.common.utils.TextMigrationHandler"])),c.methods({_wasMasterMigrated:!1,migrateAllRenderedTextComps:function(){this._textMigrationHandler=this._textMigrationHandler||new this.imports.TextMigrationHandler;var a=[];if(this._wasMasterMigrated){var b=this.getCurrentPageNode(),c=b&&b.$logic;c&&(a=c.getPageComponents())}else{var d=this.getSiteNode();a=d.getElements("[comp]").map(function(a){return a.$logic}),this._wasMasterMigrated=!0}return this._migrateTextComponents(a)},_migrateTextComponents:function(a){var b=a.filter(function(a){return"wysiwyg.viewer.components.WRichText"===a.getOriginalClassName()&&"StyledText"!==a.getDataItem().getType()});return this._textMigrationHandler=this._textMigrationHandler||new this.imports.TextMigrationHandler,b.forEach(function(a){var b=this._textMigrationHandler.migrateComponent(a);a.getDataItem().set("text",b)},this),b.length}})}),resource.getResourceValue("W.Experiments",function(a){a.isExperimentOpen("AnimationPageTransitions")&&resource.getResources(["W.Config","W.Utils"],function(a){var b=a.W.Config,c=a.W.Utils,d="undefined"==typeof window.addEventListener,e=b.mobileConfig.isMobileOrTablet(),f=c.getQueryParam("disableActions");f=f?f.split(","):[];var g={};g[Constants.Actions.PAGE_IN]=!_.contains(f,Constants.Actions.PAGE_IN)&&!d&&!e,g[Constants.Actions.SCREEN_IN]=!_.contains(f,Constants.Actions.SCREEN_IN)&&!d&&!e,g[Constants.Actions.PAGE_TRANSITION]=!_.contains(f,Constants.Actions.PAGE_TRANSITION)&&!d,define.resource("ActionsEnabledMap",g)})}),define.experiment.Class("wysiwyg.viewer.managers.actions.PageInAction.AnimationPageTransitions",function(a,b){var c=a,d=b;c.methods({initialize:d.remove(),setActionListeners:function(){this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageChangeRequested",this,this._onPageChange),this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageTransitionComplete",this,this._onPageTransitionComplete),this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageTransitionStart",this,this._onPageTransitionStart),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.ViewerStateChanged",this,this._onViewerStateChanged),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditModeChanged)},executeAction:function(a){if(this._getCurrentPageId()===a.pageId&&this._animations.isReady()&&"PREVIEW"===this.resources.W.Config.env.$editorMode){a.isPageTransitionEnd||this._resetPageTargetsToPlay();var b=this.getCurrentPageTargetsIds();this._populateSiteTargetsPlayData(b),this._populatePageTargetsToPlay(b,a),this._startAnimationEvents()}},_onPageTransitionComplete:function(a){a=a||{},a.isPageTransitionEnd=!0,this.executeAction(a)},_onPageTransitionStart:function(a){a=a||{},a.isPageTransitionEnd=!1,this.executeAction(a)}})}),define.experiment.newClass("wysiwyg.viewer.managers.actions.PageTransitionAction.AnimationPageTransitions",function(a){var b=a;b.inherits("wysiwyg.viewer.managers.actions.base.BaseAction"),b.resources(["W.Viewer","W.Commands","W.Config","W.Utils"]),b.binds([]),b.methods({initialize:function(a){this.parent(),this.resources.W.Commands.registerCommand("WViewerCommands.PageTransitionStart",!0),this.resources.W.Commands.registerCommand("WViewerCommands.PageTransitionComplete",!0),this.resources.W.Commands.registerCommand("WViewerCommands.PageTransitionCompleteOffset",!0),this._transitions=a,this._transitionsDefinitions=this._transitions.getAllTransitionDefinitions()},setActionListeners:function(){this.resources.W.Commands.registerCommandListenerByName("W.ViewerCommands.PageHandlerAttachPage",this,this._hidePage),this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.NextPageReady",this,this._onNextPageReady),this.resources.W.Commands.registerCommandListenerByName("TweenEngine.AnimationInterrupted",this,this._onAnimationComplete),this.resources.W.Commands.registerCommandListenerByName("TweenEngine.AnimationComplete",this,this._onAnimationComplete),this.resources.W.Commands.registerCommandListenerByName("TweenEngine.AnimationStart",this,this._onAnimationStart)
},setInactiveActionListeners:function(){this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.NextPageReady",this,this._executeInactiveActionCommands)},executeAction:function(a){var b,c=this.resources.W.Viewer.getPageGroup().getComponentProperty("transition"),d=this.resources.W.Viewer.getCompByID(a.fromPageId),e=this.resources.W.Viewer.getCompByID(a.pageId),f=!1;if(this._showPage({pageNode:e}),this._currentPageCommandParams={fromPageId:a.fromPageId,pageId:a.pageId},!a.fromPageId||"none"===c)return this._executeInactiveActionCommands(a),void 0;b=this._getTransitionByLegacyName(c);try{this._currentTimeline=b.init(e,d,{reverse:f}),this._currentTimeline.call(this._onAnimationCompleteOffset,null,this,b.options.completeCommandOffset)}catch(g){throw this._executeInactiveActionCommands(a),g}},_getTransitionByLegacyName:function(a){var b=_.find(this._transitionsDefinitions,function(b){return _.contains(b.legacyTypes,a)});return b},_onAnimationStart:function(a){this._currentTimeline&&this._currentTimeline===a.timeline&&this.resources.W.Commands.executeCommand("WViewerCommands.PageTransitionStart",this._currentPageCommandParams,"PageTransitionAction")},_onAnimationCompleteOffset:function(){this.resources.W.Commands.executeCommand("WViewerCommands.PageTransitionCompleteOffset",this._currentPageCommandParams,"PageTransitionAction")},_onAnimationComplete:function(a){this._currentTimeline&&this._currentTimeline===a.timeline&&(this.resources.W.Commands.executeCommand("WViewerCommands.PageTransitionComplete",this._currentPageCommandParams,"PageTransitionAction"),window.scrollTo(0,0))},_executeInactiveActionCommands:function(a){var b=this.resources.W.Viewer.getCompByID(a.pageId);this.resources.W.Commands.executeCommand("WViewerCommands.PageTransitionStart",{fromPageId:a.fromPageId,pageId:a.pageId},"PageTransitionAction"),_.defer(function(a){this._showPage({pageNode:b}),this.resources.W.Commands.executeCommand("WViewerCommands.PageTransitionComplete",a,"PageTransitionAction"),window.scrollTo(0,0)}.bind(this),{fromPageId:a.fromPageId,pageId:a.pageId})},_onNextPageReady:function(a){this.executeAction(a)},_hidePage:function(a){var b=a.pageNode;b&&b.addClass("hidePageForTransition")},_showPage:function(a){var b=a.pageNode;b&&b.removeClass("hidePageForTransition")}})}),define.experiment.Class("wysiwyg.viewer.managers.actions.ScreenInAction.AnimationNewBehaviors",function(a,b){var c=a;c.fields({_pageSequences:[],_masterPageSequences:[]}),c.methods({_animateTargets:function(){var a,b,c,d,e,f,g,h,i,j=[],k=[];if(this._isTargetsToAnimate())for(var l=this._pageTargetsToPlay.length;l--;)if(d=this._pageTargetsToPlay[l],c=this._isTargetInViewport(d),c&&!this._isTweening(d)){for(e=this.getBehaviorsByTargetId(d),f=0;f<e.length;f++)g=e[f],this._animations.getAnimationDefinition(g.name)&&(b=g.params?_.cloneDeep(g.params):{},a=this._getDomElementByTargetId(d),"master"===this.getPageIdByTargetId(d)?k.push(this._animations.applyTween(g.name,a,g.duration,g.delay,b)):j.push(this._animations.applyTween(g.name,a,g.duration,g.delay,b)));k.length&&(i=this._animations.sequence(k,{autoClear:!0,paused:!0}),this._masterPageSequences.push(i)),j.length&&(h=this._animations.sequence(j,{autoClear:!0,paused:!0}),this._pageSequences.push(h)),this._siteTargetsPlayData[d].isPlayed=!0,this._pageTargetsToPlay.splice(l,1),i&&i.play(),h&&h.play()}},_clearAnimations:function(a){"master"===a?(this._animations.clear(this._masterPageSequences),this._masterPageSequences=[]):(this._animations.clear(this._pageSequences),this._pageSequences=[])}})}),define.experiment.Class("wysiwyg.viewer.managers.actions.ScreenInAction.AnimationPageTransitions",function(a,b){var c=a,d=b;c.methods({initialize:d.remove(),setActionListeners:function(){this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageChangeRequested",this,this._onPageChange),this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageTransitionCompleteOffset",this,this._onPageTransitionComplete),this.resources.W.Commands.registerCommandListenerByName("WViewerCommands.PageTransitionStart",this,this._onPageTransitionStart),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.FeedbackQuickTourEnded",this,this._onFeedbackQuickTourEnded),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.ViewerStateChanged",this,this._onViewerStateChanged),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditModeChanged)},executeAction:function(a){if(a.pageId&&this._getCurrentPageId()===a.pageId&&this._animations.isReady()&&"PREVIEW"===this.resources.W.Config.env.$editorMode){a.isPageTransitionEnd||this._resetPageTargetsToPlay();var b=this.getCurrentPageTargetsIds();this._populateSiteTargetsPlayData(b),this._populatePageTargetsToPlay(b,a),this._startAnimationEvents()}},_onPageTransitionComplete:function(a){a=a||{},a.isPageTransitionEnd=!0,this.executeAction(a)},_onPageTransitionStart:function(a){a=a||{},a.isPageTransitionEnd=!1,this.executeAction(a)}})}),define.experiment.Class("wysiwyg.viewer.managers.actions.base.BaseAction.AnimationPageTransitions",function(a,b){var c=a;c.methods({initialize:function(a,b){this._animations=a,this._behaviors={},this._viewingDevice=null,this._isPublic=this.resources.W.Config.env.$isPublicViewerFrame,this._isActive=!1,this._syncWithViewingDeviceChanges(b)},isActive:function(){return this._isActive},setActiveState:function(a){this._isActive=!!a},_syncWithViewingDeviceChanges:function(a){this._setViewingDeviceForBehaviors({viewerMode:a||this.resources.W.Config.env.$viewingDevice}),this.resources.W.Commands.registerCommandAndListener("WEditorCommands.SetViewerMode",this,this._setViewingDeviceForBehaviors),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.ViewerStateChanged",this,this._setViewingDeviceForBehaviors)},setActionListeners:function(){},setInactiveActionListeners:function(){},executeAction:function(){}})}),define.experiment.Class("wysiwyg.viewer.managers.pages.MasterPageHandler.BackgroundPerPage",function(a,b){var c=a,d=b;c.methods({_attachPage:function(a){var b=this._getSiteStructureReferenceNode(),c=b.parentElement||document.body,d=a.rootCompNode||a;return this._insertAfter(d,c,b),this.resources.W.Config.isLoadedFromStatic()&&this._attachPageFarAwayIfNeeded(d),a},_insertAfter:function(a,b,c){b.insertBefore(a,c.nextSibling)},_getSiteStructureReferenceNode:function(){var a=$("bgNodes");if(!a){a=new Element("div",{id:"bgNodes",style:"position:relative; margin: 0 auto;"});var b=this._getSiteNode();b.insertBefore(a,b.firstChild)}return a},_getSiteParentNode:d.remove()})}),define.experiment.Class("wysiwyg.viewer.managers.pages.PageHandler.AnimationPageTransitions",function(a,b){"use strict";var c=a,d=b;c.resources(d.merge(["W.Commands"])),c.methods({_collapsePage:function(a){this.resources.W.Commands.executeCommand("W.ViewerCommands.PageHandlerAttachPage",this,{pageNode:a}),this._waitingForRender||a.collapse()}})}),define.experiment.Class("wysiwyg.viewer.managers.pages.data.LocalDataResolver.EditorLoadPerPage",function(a,b){var c=a;c.methods({_getSerializedStructureForSingleView_:function(a){var b=this._getHomePageStructureForSingleView(a),c=this._getMasterStructureForSingleView(a);return this._buildStructureObject(c,b)},_buildStructureObject:function(a,b){var c=b&&a&&!_.isEmpty(a.children),d=null;return c&&(d={pages:b,masterPage:a}),d},_getHomePageStructureForSingleView:function(a){var b={},c=!1,d=this.getMainPageId(),e=this._pagesData[d]&&this._pagesData[d].structure||null;return e&&e[this.getPageComponentsPropertyName(a)]?(c=!0,b[d]=this._getPageStructureForSingleView(e,a,this.getPageComponentsPropertyName.bind(this))):b[d]=null,c?b:null},getSerializedStructureFromServer:function(a){var b=this._getPagesStructuresForSingleView(a),c=this._getMasterStructureForSingleView(a);return this._buildStructureObject(c,b)},_getPagesStructuresForSingleView:function(a){var b={};return _.forEach(this._pageIds,function(c){b[c]=this.getSerializedPageStructureSync(a,c)},this),b||null}})}),resource.getResourceValue("W.Theme",function(a){var b={iconName:"",getFullIconUrl:function(){return a.getProperty("WEB_THEME_DIRECTORY")+"social_activity/"}};define.resource("SN.BaseSocialNetwork",b)}),resource.getResourceValue("SN.BaseSocialNetwork",function(a){var b=Object.create(a);b.name="fb",b.iconName={light:"fb_light.png","default":"fb_dark.png"},b.label="Share on FaceBook",define.resource("SN.FacebookSocialNetwork",b)}),resource.getResourceValue("SN.BaseSocialNetwork",function(a){var b=Object.create(a);b.name="pi",b.iconName={light:"pi_light.png","default":"pi_dark.png"},b.label="Share on Pinterest",define.resource("SN.PinterestSocialNetwork",b)}),resource.getResourceValue("SN.BaseSocialNetwork",function(a){var b=Object.create(a);b.name="tw",b.iconName={light:"tw_light.png","default":"tw_dark.png"},b.label="Share on Twitter",define.resource("SN.TwitterSocialNetwork",b)}),define.experiment.Class("wysiwyg.common.managers.viewer.MobileViewHandler.ExitMobileMode.New",function(a){var b=a;b.methods({_resetViewPortTagAttributes:function(){this.setViewportAttribute("width",""),this.setViewportAttribute("initial-scale",MobileUtils.getInitZoom()),this.setViewportAttribute("user-scalable",""),this.setViewportAttribute("maximum-scale","1.2"),this.setViewportAttribute("minimum-scale","0.25")},handleQuickActions:function(){this._mobileQuickActionsHandler||(this._mobileQuickActionsHandler=new this.imports.MobileQuickActionsHandler,this._mobileQuickActionsHandler.handleMobileQuickActions())}})}),define.experiment.Class("wysiwyg.common.managers.viewer.MobileViewHandler.MobileActionsMenu",function(a,b){var c=a;c.utilize(["wysiwyg.viewer.utils.MobileQuickActionsHandler","wysiwyg.viewer.utils.MobileActionsMenuHandler"]),c.methods({handleQuickActions:function(){var a;window.WMobileActionsMenu&&window.WMobileActionsMenu.isInited()?(a=new this.imports.MobileActionsMenuHandler,a.handleMobileActionsMenu()):(a=new this.imports.MobileQuickActionsHandler,a.handleMobileQuickActions())},addRotationEventListener:function(){window.addEventListener("orientationchange",this._handleMobileRotation,!1),(window.WQuickActions||window.WMobileActionsMenu)&&window.addEventListener("orientationchange",this._showQuickActions,!1)},removeRotationEventListener:function(){window.removeEventListener("orientationchange",this._handleMobileRotation),(window.WQuickActions||window.WMobileActionsMenu)&&window.removeEventListener("orientationchange",this._showQuickActions)},_fixQuickActionsZoom:function(){(window.WQuickActions||window.WMobileActionsMenu)&&W.Viewer.addEvent("SiteReady",function(){_.delay(this._showQuickActions,100)}.bind(this))},_hideQuickActions:function(){window.WMobileActionsMenu?window.WMobileActionsMenu.forceCloseActionsMenu():window.WQuickActions&&window.WQuickActions.hideBar()},_showQuickActions:function(){setTimeout(function(){window.WMobileActionsMenu||window.WQuickActions&&(window.WQuickActions.showBar(),window.WQuickActions.fixZoom())},100)}})}),define.experiment.Class("wysiwyg.viewer.managers.viewer.SiteView.EditorLoadPerPage",function(a,b){var c=a;c.methods({initiateSite:function(){this._pageManager.addEvent(this._pageManager.EVENTS.SITE_LOADED,this.AfterSiteRendered);var a=this.resources.BrowserUtils.getQueryParams().keepstatic;return this._keepStatic=a&&a[0]&&"true"===a[0],this._keepStatic?void 0:(this._logViewerRender("site starting to load"),this._loadSite())},_loadSite:function(){var a=this;return this._dataResolver.isStructureExists(Constants.ViewerTypesParams.TYPES.MOBILE).then(function(b){var c=a._getShouldWixifyAllPages(b);a._pageManager.loadSite(c)})},_getShouldWixifyAllPages:function(a){var b=!1;if(this.resources.W.Config.env.$isEditorViewerFrame){var c=this.resources.W.Config.siteNeverSavedBefore();b=c||!a}return b},_getMasterComponents:function(a,b){var c=a.getChildComponents();return _.forEach(c,function(a){var c=a.get("comp"),d=a.$logic;d&&!this._viewer.isPageComponent(c)&&(b.push(d),d.isContainer()&&this._getMasterComponents(d,b))}.bind(this)),b},getPageComponents:function(a){a=a||this.getCurrentPageId();var b=this.getCompByID(a).$logic;return b?b.getPageComponents():null}})}),define.experiment.Class("wysiwyg.viewer.managers.viewer.ViewerCaptureHandler.BackgroundPerPage",function(a){var b=a;b.methods({_getObsoleteNodeIdsToRemove:function(){return["wixFooter","desktopBgNode"]}})}),define.experiment.Class("wysiwyg.viewer.managers.viewer.ViewerProxy.LandingPageSupport",function(a){a.methods({addEventPropagation:function(a){var b=this;this._eventHandlers[a]=function(c){b.fireEvent(a,c),b.trigger(a,c)},this._activeViewer_.addEvent(a,this._eventHandlers[a])}})}),define.experiment.Class("wysiwyg.viewer.managers.viewer.ViewerStaticLoadingHandler.BackgroundPerPage",function(a){var b=a;b.methods({_cleanupStaticElements:function(){this._removeFarAwayPage();var a=document.head.getChildren("[id^="+Constants.ViewerTypesParams.DOM_ID_STATIC_PREFIX+"]"),b=document.body.getChildren("[id^="+Constants.ViewerTypesParams.DOM_ID_STATIC_PREFIX+"]"),c=a.concat(b),d=[Constants.ViewerTypesParams.DOM_ID_STATIC_PREFIX+"mobile_bgNode",Constants.ViewerTypesParams.DOM_ID_STATIC_PREFIX+"mobileBgNode"];_.forEach(c,function(a){var b=a.getAttribute("id");_.contains(d,b)?a.setStyle("display","none"):a.parentNode.removeChild(a)}),this.fireEvent(this.EVENTS.SITE_REPLACED_STATIC_HTML)}})}),define.experiment.Class("wysiwyg.viewer.utils.MobileQuickActionsHandler.MobileActionsMenu",function(a,b){var c=a;c.methods({handleMobileQuickActions:function(){this._removePreloader(),this._addNavigation(),window.WMobileActionsMenu&&window.WMobileActionsMenu.updateDisplay()},_createSingleNavItem:function(a,b,c){for(var d=this._navigateToPage,e=this._hideMenu,f=">  ",g="",h=0;c>h;h++)g+=f;var i=document.createElement("li"),j=b.get("refId");this._pagesMap[j]=i,i.innerHTML="<a href='#'></a>",a.appendChild(i),this.resources.W.Data.getDataByQuery(j,function(f){var h=f.get("mobileHidePage");if(h)a.removeChild(i);else{var k=f.get("title");i.firstChild.innerHTML=g+k;var l=b.get("items");l&&l.length>0&&this._createNavItemsFromDataItems(a,l,c+1,i),j&&0===j.indexOf("#")&&(j=j.substr(1)),i.addEventListener("click",function(a){e(),d(j),a.stopPropagation(),a.preventDefault()})}}.bind(this))}})});