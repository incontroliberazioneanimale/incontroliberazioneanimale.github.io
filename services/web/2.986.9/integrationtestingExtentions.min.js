define.Class("wysiwyg.deployment.it.editor.TempDriver",function(a){var b=a;b.methods({initialize:function(){},isReady:function(){return!0},foo:function(){return"Foo!"}})}),define.Class("wysiwyg.deployment.it.editor.ComponentsDriver",function(a){var b=a;b.fields({_mouseEventsEnum:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout"},componentEdges:{TOP:"top",TOP_RIGHT:"topRight",RIGHT:"right",BOTTOM_RIGHT:"bottomRight",BOTTOM:"bottom",BOTTOM_LEFT:"bottomLeft",LEFT:"left",TOP_LEFT:"topLeft"}}),b.resources(["W.Data","W.CommandsNew","W.Commands","W.Preview","W.Skins"]),b.methods({isReady:function(){return"ready"===this._getPrelaoderElement().className},_resolvedPromise:function(){var a;return a=Q.defer(),a.resolve(),a.promise},removeComponent:function(a){return a?(this.touchComponent(a),setTimeout(function(){this.resources.W.CommandsNew.executeCommand("WEditorCommands.WDeleteSelectedComponent")}.bind(this),3e3),this._waitOnComponentCount(a.getAttribute("comp"))):this._resolvedPromise()},createComponent:function(a,b){var c=this._getComponentCount(b);return this.resources.W.CommandsNew.executeCommand("WEditorCommands.AddComponent",{compType:a}),this._waitOnComponentCount(b,c)},createCompFactoryComponent:function(a){var b=this._getComponentCount(a.compType);return this.resources.W.CommandsNew.executeCommand("WEditorCommands.AddComponent",a),this._waitOnComponentCount(a.compType,b)},isComponentReady:function(a){return a&&a.$logic?a.$logic.NEW_BASE_COMP?"ready"===a.$logic.getComponentStatus():a.$logic.isReady&&a.$logic.isReady():!1},setSkinForComponent:function(a,b){var c=this._getComponentCurrentStyleId(a);return this._setSkinForStyleId(c,b)},_getComponentCurrentStyleId:function(a){return a.getLogic().getStyle().getDataItem().get("id")},_setSkinForStyleId:function(a,b){var c=Q.defer(),d=this.resources.W.Preview.getPreviewManagers();return d.Skins.getSkin(b,function(b){var e=d.Theme._styleCache[a];e?(e.setSkin(b),setTimeout(function(){c.resolve()},300)):c.reject("skinParam mapper is not defined for styleId="+a)}),c.promise},getElementPosition:function(a){return this.resources.W.Preview.previewToEditorCoordinates(a.getPosition(),!0)},_clickAndDrag:function(a,b,c){var d=Q.defer(),e=this._isKnobElm(a)?a:this._isEditBoxOnElement(a)?this._getEditBox():this._getMouseEventCatcherElement(),f=this._createMouseEvent(this._mouseEventsEnum.MOUSEDOWN,b.x,b.y,b.x,b.y),g=this._createMouseEvent(this._mouseEventsEnum.MOUSEMOVE,c.x,c.y,c.x,c.y),h=this._createMouseEvent(this._mouseEventsEnum.MOUSEUP,c.x,c.y,c.x,c.y);return e.dispatchEvent(f),e.dispatchEvent(g),e.dispatchEvent(h),setTimeout(function(){d.resolve()},200),d.promise},_getEditBoxKnobElm:function(a){var b=a+"Knob",c=this._getEditBox();return c.getElement('[skinpart="'+b+'"]')},_isKnobElm:function(a){return a&&"P"===a.nodeName&&a.className&&a.className.indexOf("knob")>-1},touchComponent:function(a){this.dragComponent(a,{x:0,y:0})},dragComponent:function(a,b){var c=this.getElementPosition(a),d=a.getSize(),e=c.x+d.x/2,f=c.y+d.y/2,g=e+b.x,h=f+b.y;this._clickAndDrag(a,{x:e,y:f},{x:g,y:h})},_addOffsetToPosition:function(a,b){return{x:(a.x||0)+(b.x||0),y:(a.y||0)+(b.y||0)}},resizeComponent:function(a,b,c){var d,e,f,g=this.getElementPosition(a),h=a.getSize(),i=5,j={x:{left:g.x-i,center:g.x+Math.floor(h.x/2),right:g.x+h.x+i},y:{top:g.y-i,middle:g.y+Math.floor(h.y/2),bottom:g.y+h.y+i}};switch(c){case this.componentEdges.TOP:d={x:j.x.center,y:j.y.top};break;case this.componentEdges.TOP_RIGHT:d={x:j.x.right,y:j.y.top};break;case this.componentEdges.RIGHT:d={x:j.x.right,y:j.y.middle};break;case this.componentEdges.BOTTOM_RIGHT:d={x:j.x.right,y:j.y.bottom};break;case this.componentEdges.BOTTOM:d={x:j.x.center,y:j.y.bottom};break;case this.componentEdges.BOTTOM_LEFT:d={x:j.x.left,y:j.y.bottom};break;case this.componentEdges.LEFT:d={x:j.x.left,y:j.y.middle};break;case this.componentEdges.TOP_LEFT:d={x:j.x.left,y:j.y.top}}return e=this._addOffsetToPosition(d,b),f=this._getEditBoxKnobElm(c),this._clickAndDrag(f,d,e)},_getComponentCount:function(a){var b=this._getIframe();return b.querySelectorAll('div[comp="'+a+'"]').length},_waitOnComponentCount:function(a,b){var c=Q.defer(),d=this,e=function(b){setTimeout(function(){var f=d._getComponentCount(a);f&&f===b?e(f):c.resolve(d._getComponent(a))},600)}.bind(this);return e(b),c.promise},getComponentNode:function(a,b,c){var d,e=b.getElements("div[comp="+a+"]");return d=_.isNumber(c)?c:e.length-1,e[d]},getEditorComponentNode:function(a,b){return this.getComponentNode(a,document,b)},_getComponent:function(a,b){return this.getComponentNode(a,this._getIframe(),b)},_getPrelaoderElement:function(){return this._preloader=this._preloader||document.getElementById("editor_preloader"),this._preloader},_getMouseEventCatcherElement:function(){return this.mouseEventCatcherElement=this.mouseEventCatcherElement||document.getElement("[skinpart='mouseEventCatcher']"),this.mouseEventCatcherElement},_getEditBox:function(){return this.editBox=this.editBox||document.getElement("[skinpart=componentEditBox]"),this.editBox},_isEditBoxOnElement:function(a){return this._getEditBox(),this.editBox.getLogic()._editedComponent&&this.editBox.getLogic()._editedComponent.getViewNode()===a},_getIframe:function(){return this.iframe=this.iframe||document.getElement("iframe#live-preview-iframe").contentDocument,this.iframe},_createMouseEvent:function(a,b,c,d,e){var f=document.createEvent("MouseEvents");return f.initMouseEvent(a,!0,!0,window,1,b,c,d,e,!1,!1,!1,!1,0,null),f},clickOn:function(a){var b,c,d=this.resources.W.Preview.previewToEditorCoordinates(a.getPosition(),!0),e=a.getSize(),f=d.x+e.x/2,g=d.y+e.y/2,h=this._getMouseEventCatcherElement();b=this._createMouseEvent(this._mouseEventsEnum.MOUSEDOWN,f,g,f,g),h.dispatchEvent(b),c=this._createMouseEvent(this._mouseEventsEnum.MOUSEUP,f,g,f,g),h.dispatchEvent(c)}})}),define.Class("wysiwyg.deployment.it.editor.MobileEditorUIDriver",function(a){var b=a;b.fields({}),b.utilize(["wysiwyg.deployment.it.editor.StructureComparisonDriver"]),b.resources([]),b.methods({initialize:function(){this._isRefactoredVersion=!W.Preview.getMultiViewersHandler()._responsiveAPI,this.algo=W.Preview.getMultiViewersHandler()._layoutAlgorithms,this._structureComparisonDriver=new this.imports.StructureComparisonDriver,this._secondaryPreviewReady=!1;var a=W.Preview.getPreviewManagers().Commands;W.Commands.registerCommandAndListener("WEditorCommands.SecondaryPreviewReady",this,function(){a.registerCommandAndListener("WViewerCommands.PageChangeComplete",this,function(){var b=a.getCommand("WViewerCommands.PageChangeComplete");b.unregisterListener(this),this._secondaryPreviewReady=!0})}.bind(this))},_setSecondaryPreviewReady:function(a){this._secondaryPreviewReady=a},isSecondaryPreviewReady:function(){return this._secondaryPreviewReady},switchToMobileEditor:function(a){this._setSecondaryPreviewReady(!1),W.Commands.executeCommand("WEditorCommands.SetViewerMode",{mode:"MOBILE",src:"btn"});var b=this;waitsFor(function(){return b.isSecondaryPreviewReady()},"waiting for switchToMobileEditor to be done",2500),runs(a)},switchToDesktopEditor:function(){W.Commands.executeCommand("WEditorCommands.SetViewerMode",{mode:"DESKTOP",src:"btn"})},regenerateWholeMobileStructureLayout:function(a){this._setSecondaryPreviewReady(!1),W.Commands.executeCommand("WEditorCommands.RegenerateWholeMobileStructureLayout");var b=this;waitsFor(function(){return b.isSecondaryPreviewReady()},"waiting for regenerateWholeMobileStructureLayout to be done",2500),runs(a)},registerClassNameAsNonMobileRecommended:function(a){var b="WEditorCommands.RegisterClassNameToLayoutAlgo";W.Commands.executeCommand(b,{className:a,isMobileRecommendedFunc:function(){return!1}})},registerClassNameAsNonMobileReady:function(a){var b="WEditorCommands.RegisterClassNameToLayoutAlgo";W.Commands.executeCommand(b,{className:a,isMobileFunc:function(){return!1}})},clearLayoutAlgorithmRegistrarFromComponent:function(a,b){var c,d=this._isRefactoredVersion?this.algo._config:this.algo._registrar;switch(b){case"extraOperationsFunc":c=d._classNameToExtraOperationMapper;break;case"isMobileFunc":c=d._componentMobileValidityMapper;break;case"isMobileRecommendedFunc":c=d._componentMobileRecommendedMapper;break;case"isSuitableForProportionGroupingFunc":c=d._isSuitableForProportionGroupingMapper;break;case"setMarginFromContainerFunc":c=d._registerMarginFromContainerFunction;break;case"dimensionCalculatorFunc":c=d._dimensionCalculatorMapper}delete c[a]},moveComponentToTop:function(a){a&&"SELECTED_COMPONENT"!=a&&W.Editor.setSelectedComp(W.Preview.getCompByID(a).getLogic()),W.Commands.executeCommand("WEditorCommands.MoveTop")},readdComponentToCurrentPage:function(a,b){var c=W.Preview.getPreviewManagers().Viewer.getCurrentPageId();this._readdComponent(a,c,b)},readdComponentToMasterPage:function(a,b){this._readdComponent(a,"masterPage",b)},_readdComponent:function(a,b,c){this._setSecondaryPreviewReady(!1),W.Commands.executeCommand("WEditorCommands.ReaddDeletedMobileComponent",{id:a,pageId:b});var d=this;waitsFor(function(){return d.isSecondaryPreviewReady()},"waiting for readdComponent to be done",2500),runs(c)},sleep:function(a,b){var c=!1;setTimeout(function(){c=!0},a),waitsFor(function(){return c},"waiting for timeout to be done",a+50),runs(b)},getAllSelectedComponentsData:function(){var a=W.Editor.getAllSelectedComponents(),b=a.map(function(a){return a.getViewNode()}),c=W.CompSerializer.serializeComponents(b,!0);return this._structureComparisonDriver.handleEscapeIssues(JSON.stringify(c))},addComponentsToPage:function(a,b){var c=W.Preview.getPreviewManagers().Viewer.getCurrentPageId();this.addComponentsToContainer(a,c,b)},addComponentsToHeader:function(a,b){this.addComponentsToContainer(a,"SITE_HEADER",b)},addComponentsToContainer:function(a,b,c){this.sleep(300,function(){var d=JSON.parse(this._structureComparisonDriver.revertHandleEscapeIssues(a));this._finishedAddingComponents=!1;var e=this;W.CompDeserializer.createAndAddComponents(W.Preview.getCompByID(b),d,!0,!0,void 0,function(){e._finishedAddingComponents=!0},!0,!0),waitsFor(function(){return e._finishedAddingComponents},"Added comp",4e3),runs(c)}.bind(this))},selectAllPageComponents:function(){W.Editor.setSelectedComps(this.getAllPageComponents())},enforceAnchorsToAllPageComponents:function(){W.Preview.getPreviewManagers().Layout.enforceAnchors(this.getAllPageComponents())},getAllPageComponents:function(){return W.Preview.getPageComponents(W.Preview.getPreviewManagers().Viewer.getCurrentPageId(),Constants.ViewerTypesParams.TYPES.DESKTOP)},getContainerDirectChildrenIds:function(a,b){var c=W.Preview.getCompByID(a,b).$logic,d=c.getChildren().map(function(a){return a.$logic.getComponentId()});return d},deleteComponent:function(a){W.Editor.setSelectedComp(W.Preview.getCompByID(a).getLogic()),W.Editor.doDeleteSelectedComponent()},moveResizeComponent:function(a,b){a&&"SELECTED_COMPONENT"!=a&&W.Editor.setSelectedComp(W.Preview.getCompByID(a).getLogic()),W.Commands.executeCommand("WEditorCommands.SetSelectedCompPositionSize",b)},attachToContainer:function(a,b,c){var d=W.Preview.getCompByID(a).getLogic(),e=W.Preview.getCompByID(b).getLogic(),f=e.getParentComponent();d.addChild(e),W.Preview.getPreviewManagers().Layout.reportReparent([d],f),c=c||{},c.x=c.x||10,c.y=c.y||10,this.moveResizeComponent(b,c)},deleteAllCurrentPageComponents:function(){var a=this.getAllPageComponents().map(function(a){return a.getComponentId()});this.deleteComponents(a)},deleteHeaderAndFooterComponents:function(a){a=a||Constants.ViewerTypesParams.TYPES.DESKTOP;var b=this.getContainerDirectChildrenIds("SITE_HEADER",a);this.deleteComponents(b);var c=this.getContainerDirectChildrenIds("SITE_FOOTER",a);this.deleteComponents(c)},deleteComponents:function(a){for(var b=0;b<a.length;b++)W.Preview.getCompByID(a[b])&&this.deleteComponent(a[b])},addBlankPageAsync:function(){editor.addBlankPage()},deleteCurrentPageAsync:function(){var a=W.Preview.getPreviewManagers().Viewer.getCurrentPageNode().$logic.getDataItem();W.Editor._actualDeletePage(a)}})}),define.Class("wysiwyg.deployment.it.editor.StructureComparisonDriver",function(a){var b=a;b.fields({}),b.resources([]),b.methods({initialize:function(){this.algo=W.Preview.getMultiViewersHandler()._layoutAlgorithms},setAlertWhenTestFails:function(a){this._alertWhenTestFails=a},getPageComponent:function(a){var b="masterPage"==a?this.getMobileStructure().masterPage:this.getMobileStructure().pages[a];return b},getPageComponentIds:function(a){var b=this.getPageComponent(a);return this.algo._getStructureComponentIds?this.algo._getStructureComponentIds(b):this.algo.getStructureComponentIds(b)},getMobileStructure:function(){var a=W.Preview.getMultiViewersHandler()._viewersInfo.MOBILE;return a.siteStructureSerializer._getSerializedStructure()},parsePageToSomeDataMap:function(a){var b=this.getMobileStructure(),c=_.keys(b.pages);c.push("masterPage");for(var d={},e=0;e<c.length;e++)d[c[e]]=a(c[e]);return d},parsePageToComponentIdListMap:function(){return this.parsePageToSomeDataMap(this.getPageComponentIds.bind(this))},parsePageToStructureSkeleton:function(){return this.parsePageToSomeDataMap(this.getPageStructureSkeleton.bind(this))},parsePageToLayoutDetails:function(){return this.parsePageToSomeDataMap(this.getPageLayoutDetails.bind(this))},parsePageToAnchors:function(){return this.parsePageToSomeDataMap(this.getPageAnchors.bind(this))},parseAllTemplateRequiredDataForTest:function(){var a={};return a.pageToComponentIdList=this.parsePageToComponentIdListMap(),a.pageToStructureSkeleton=this.parsePageToStructureSkeleton(),a.pageToLayoutDetails=this.parsePageToLayoutDetails(),a.pageToAnchors=this.parsePageToAnchors(),this.handleEscapeIssues(JSON.stringify(a))},handleEscapeIssues:function(a){return this._handleEscapeSlashes(a)},revertHandleEscapeIssues:function(a){return this._revertHandleEscapeSlashes(a)},_handleEscapeSlashes:function(a){for(;a.indexOf("\\")>-1;){var b=a.indexOf("\\");a=a.slice(0,b)+"&@slash"+a.slice(b+1)}return a},_revertHandleEscapeSlashes:function(a){return a=a.replace(/&@slash/gi,"\\")},getPageStructureSkeleton:function(a){var b=this.getPageComponent(a);return this.getStructureSkeleton(b)},getPageLayoutDetails:function(a){var b=this.getPageComponent(a);return this.getLayoutDetails(b)},getPageAnchors:function(a){var b=this.getPageComponent(a);return this.getAnchors(b)},getStructureSkeleton:function(a,b){b=b||0;var c=this._addTabs(b);c+=a.id||"ROOT";var d=a.components||a.children;if(!d||0==d.length)return c;c+=":{\n";for(var e=0;e<d.length;e++)c+=this.getStructureSkeleton(d[e],b+1),e!=d.length-1&&(c+=","),c+="\n";return c+=this._addTabs(b)+"}\n"},getLayoutDetails:function(a,b){b=b||0;var c=this._addTabs(b);c+=a.id||"",a.layout&&(c+=":{",c+="x:"+a.layout.x+",",c+="y:"+a.layout.y+",",c+="width:"+a.layout.width+",",c+="height:"+a.layout.height+"}",c+="\n");var d=a.components||a.children;if(!d||0==d.length)return c;for(var e=0;e<d.length;e++)c+=this.getLayoutDetails(d[e],b+1);return c},getAnchors:function(a,b){b=b||0;var c=this._addTabs(b);if(c+=a.id||"",a.layout&&a.layout.anchors){c+=":[\n";for(var d=a.layout.anchors,e=0;e<d.length;e++)c+="{",c+="distance:"+d[e].distance+",",c+="locked:"+d[e].locked+",",c+="originalValue:"+d[e].originalValue+",",c+="targetComponent:"+d[e].targetComponent+",",c+="topToTop:"+d[e].topToTop+",",c+="type:"+d[e].type+"}\n";c+="]\n"}var f=a.components||a.children;if(!f||0==f.length)return c;for(var e=0;e<f.length;e++)c+=this.getAnchors(f[e],b+1);return c},_addTabs:function(a){for(var b="",c=0;a>c;c++)b+="---";return b},_arrayToString:function(a){ret="";for(var b=0;b<a.length;b++)ret+=a[b],b<a.length-1&&(ret+="\n");return ret},testPageComponentIds:function(a,b){var c=this.getPageComponentIds(a),d=this._arrayToString(c),e=this._arrayToString(b);return expect(d).toEqual(e),d===e},testPageStructureSkeleton:function(a,b){var c=this.getPageStructureSkeleton(a);return expect(c).toEqual(b),c===b},testLayoutDetails:function(a,b){var c=this.getPageLayoutDetails(a);return expect(c).toEqual(b),c===b},testAnchors:function(a,b){var c=this.getPageAnchors(a);return expect(c).toEqual(b),c===b},testPage:function(a,b){var c=JSON.parse(this.revertHandleEscapeIssues(b)),d=this.testPageComponentIds(a,c.pageToComponentIdList[a]),e=this.testPageStructureSkeleton(a,c.pageToStructureSkeleton[a]),f=this.testLayoutDetails(a,c.pageToLayoutDetails[a]),g=this.testAnchors(a,c.pageToAnchors[a]),h=d&&e&&f&&g;!h&&this._alertWhenTestFails&&alert("Dude, there is a failing test!")},getPageComponentsTextBorders:function(a,b){a=a||Constants.ViewerTypesParams.TYPES.DESKTOP,b=b||W.Preview.getPreviewManagers().Viewer.getCurrentPageId();var c=W.Preview.getPageComponents(b,a).map(function(a){return a._compId});return this.getTextBorders(c,a)},getTextBorders:function(a,b){b=b||Constants.ViewerTypesParams.TYPES.DESKTOP;for(var c={},d=0;d<a.length;d++){var e=a[d];if("TINY_MENU"!==e){var f=W.Preview.getCompByID(e,b).$logic;if("wysiwyg.viewer.components.WRichText"==f.className){var g=this._isRefactoredVersion?this.algo._conversionAlgorithm._structurePreprocessor._textLayoutCalculator:this.algo._textLayoutCalculator;c[e]=g.getTextOverallBorders(f)}}}return c}})}),define.Class("wysiwyg.deployment.JasmineEditorHelper",function(a){var b=a;b.fields({_mouseEventsEnum:{MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout"},componentEdges:{TOP:"top",TOP_RIGHT:"topRight",RIGHT:"right",BOTTOM_RIGHT:"bottomRight",BOTTOM:"bottom",BOTTOM_LEFT:"bottomLeft",LEFT:"left",TOP_LEFT:"topLeft"}}),b.resources(["W.Data","W.CommandsNew","W.Commands","W.Preview","W.Skins","W.Editor"]),b.methods({isReady:function(){return"ready"===this._getPrelaoderElement().className},_resolvedPromise:function(){var a;return a=Q.defer(),a.resolve(),a.promise},removeComponent:function(a){return a?(this.touchComponent(a),setTimeout(function(){this.resources.W.CommandsNew.executeCommand("WEditorCommands.WDeleteSelectedComponent")}.bind(this),3e3),this._waitOnComponentCount(a.getAttribute("comp"))):this._resolvedPromise()},createComponent:function(a,b){return this.resources.W.CommandsNew.executeCommand("WEditorCommands.AddComponent",{compType:a}),this._waitOnComponentCount(b)},addComponent:function(a,b,c){return this.resources.W.CommandsNew.executeCommand("WEditorCommands.AddComponent",{compType:a}),"function"==typeof c&&setTimeout(function(){c(this._getComponent(b))}.bind(this),500),this._getComponent(b)},isComponentReady:function(a){return a&&a.$logic?a.$logic.NEW_BASE_COMP?"ready"===a.$logic.getComponentStatus():a.$logic.isReady&&a.$logic.isReady():!1},setSkinForComponent:function(a,b){var c=this._getComponentCurrentStyleId(a);return this._setSkinForStyleId(c,b)},_getComponentCurrentStyleId:function(a){return a.getLogic().getStyle().getDataItem().get("id")},_setSkinForStyleId:function(a,b){var c=Q.defer(),d=this.resources.W.Preview.getPreviewManagers();return d.Skins.getSkin(b,function(b){var e=d.Theme._styleCache[a];e?(e.setSkin(b),setTimeout(function(){c.resolve()},300)):c.reject("skinParam mapper is not defined for styleId="+a)}),c.promise},addBlankPage:function(a,b){var c=Object.clone(this.resources.W.Data.getDataByQuery("#PAGE_TYPES")._data.items[2]);return c.name=a||"Blank 2",this.resources.W.Commands.getCommand("WEditorCommands.AddPage").execute({page:c,dontGoToPageUponCreation:b}),this._getComponent("core.components.Page")},goToPage:function(a){W.Commands.executeCommand("EditorCommands.gotoSitePage",a)},getElementPosition:function(a){return this.resources.W.Preview.previewToEditorCoordinates(a.getPosition(),!0)},_clickAndDrag:function(a,b,c){var d=Q.defer(),e=this._isKnobElm(a)?a:this._isEditBoxOnElement(a)?this._getEditBox():this._getMouseEventCatcherElement(),f=this._createMouseEvent(this._mouseEventsEnum.MOUSEDOWN,b.x,b.y,b.x,b.y),g=this._createMouseEvent(this._mouseEventsEnum.MOUSEMOVE,c.x,c.y,c.x,c.y),h=this._createMouseEvent(this._mouseEventsEnum.MOUSEUP,c.x,c.y,c.x,c.y);return e.dispatchEvent(f),e.dispatchEvent(g),e.dispatchEvent(h),setTimeout(function(){d.resolve()},200),d.promise},_getEditBoxKnobElm:function(a){var b=a+"Knob",c=this._getEditBox();return c.getElement('[skinpart="'+b+'"]')},_isKnobElm:function(a){return a&&"P"===a.nodeName&&a.className&&a.className.indexOf("knob")>-1},touchComponent:function(a){this.dragComponent(a,{x:0,y:0})},dragComponent:function(a,b){var c=this.getElementPosition(a),d=a.getSize(),e=c.x+d.x/2,f=c.y+d.y/2,g=e+b.x,h=f+b.y;this._clickAndDrag(a,{x:e,y:f},{x:g,y:h})},_addOffsetToPosition:function(a,b){return{x:(a.x||0)+(b.x||0),y:(a.y||0)+(b.y||0)}},resizeComponent:function(a,b,c){var d,e,f,g=this.getElementPosition(a),h=a.getSize(),i=5,j={x:{left:g.x-i,center:g.x+Math.floor(h.x/2),right:g.x+h.x+i},y:{top:g.y-i,middle:g.y+Math.floor(h.y/2),bottom:g.y+h.y+i}};switch(c){case this.componentEdges.TOP:d={x:j.x.center,y:j.y.top};break;case this.componentEdges.TOP_RIGHT:d={x:j.x.right,y:j.y.top};break;case this.componentEdges.RIGHT:d={x:j.x.right,y:j.y.middle};break;case this.componentEdges.BOTTOM_RIGHT:d={x:j.x.right,y:j.y.bottom};break;case this.componentEdges.BOTTOM:d={x:j.x.center,y:j.y.bottom};break;case this.componentEdges.BOTTOM_LEFT:d={x:j.x.left,y:j.y.bottom};break;case this.componentEdges.LEFT:d={x:j.x.left,y:j.y.middle};break;case this.componentEdges.TOP_LEFT:d={x:j.x.left,y:j.y.top}}return e=this._addOffsetToPosition(d,b),f=this._getEditBoxKnobElm(c),this._clickAndDrag(f,d,e)},_getComponentCount:function(a){var b=this._getIframe();return b.querySelectorAll('div[comp="'+a+'"]').length},_waitOnComponentCount:function(a){var b=Q.defer(),c=this,d=function(e){setTimeout(function(){var f=c._getComponentCount(a);f&&f===e?d(f):b.resolve(c._getComponent(a))},600)}.bind(this);return d(this._getComponentCount(a)),b.promise},getComponentNode:function(a,b,c){var d,e=b.getElements("div[comp="+a+"]");return d=_.isNumber(c)?c:e.length-1,e[d]},getEditorComponentNode:function(a,b){return this.getComponentNode(a,document,b)},_getComponent:function(a,b){return this.getComponentNode(a,this._getIframe(),b)},_getPrelaoderElement:function(){return this._preloader=this._preloader||document.getElementById("editor_preloader"),this._preloader},_getMouseEventCatcherElement:function(){return this.mouseEventCatcherElement=this.mouseEventCatcherElement||document.getElement("[skinpart='mouseEventCatcher']"),this.mouseEventCatcherElement},_getEditBox:function(){return this.editBox=this.editBox||document.getElement("[skinpart=componentEditBox]"),this.editBox},_isEditBoxOnElement:function(a){return this._getEditBox(),this.editBox.getLogic()._editedComponent&&this.editBox.getLogic()._editedComponent.getViewNode()===a},_getIframe:function(){return this.iframe=this.iframe||document.getElement("iframe#live-preview-iframe").contentDocument,this.iframe},_createMouseEvent:function(a,b,c,d,e){var f=document.createEvent("MouseEvents");return f.initMouseEvent(a,!0,!0,window,1,b,c,d,e,!1,!1,!1,!1,0,null),f},clickOn:function(a){var b,c,d=this.resources.W.Preview.previewToEditorCoordinates(a.getPosition(),!0),e=a.getSize(),f=d.x+e.x/2,g=d.y+e.y/2,h=this._getMouseEventCatcherElement();b=this._createMouseEvent(this._mouseEventsEnum.MOUSEDOWN,f,g,f,g),h.dispatchEvent(b),c=this._createMouseEvent(this._mouseEventsEnum.MOUSEUP,f,g,f,g),h.dispatchEvent(c)},getEditedComponent:function(){return this.resources.W.Editor.getEditedComponent()},getPreview:function(){var a=this.resources.W.Preview.getSiteNode();return a}})}),define.Class("wysiwyg.deployment.JasmineViewerHelper",function(a){var b=a;b.methods({isReady:function(){return!0},containsComponent:function(a){return document.getElements("div[comp="+a+"]").length>0}})});