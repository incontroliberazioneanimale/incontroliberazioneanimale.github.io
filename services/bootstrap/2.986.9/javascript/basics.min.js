define.Class("bootstrap.managers.BaseManager",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.methods({isReady:function(){return!0},clone:function(a){var b,c=this.$className;if(a.getResourceFetcher().getResourceValue("W.Classes",function(a){a.getClass(c,function(a){b=new a})}),!b)throw new Error("clone failed: "+c);return b}})}),define.Class("bootstrap.managers.InputBindings",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.binds(["isStopCallback"]),b.methods({initialize:function(){this._listener=Mousetrap;try{this._listener.unpause()}catch(a){console.error("throw new Error('Mousetrap not loaded');")}},isReady:function(){return!0},clone:function(){return new this.$class},addBinding:function(a,b,c){if(b=b||{},a){var d=c?"bindGlobal":"bind",e=b.keypressType,f=b.command,g=b.commandParameter;!f&&b.commandName&&(f=W.Commands.getCommand(b.commandName)),this._listener[d](a,function(a,b){return f&&f.isEnabled()&&(a.combo=b,f.execute(g,a)),a.preventDefault(),a.stopPropagation(),!1},e)}},removeBinding:function(a,b){this._listener.unbind(a,b)},setKeysEnabled:function(a){a?this._listener.unpause():this._listener.pause()},getKeysEnabled:function(){return this._listener.isEnabled()},isStopCallback:function(a,b,c,d){return this._listener.stopCallback(a,b,c,d)}})}),define.bootstrapClass("bootstrap.managers.classmanager.ClassDefinition",function(a){"use strict";function b(){this.$constructor=b,this._extends_=void 0,this._binds_=void 0,this._traits_=void 0,this._statics_=void 0,this._fields_={},this._methods_={},this._imports_=void 0,this._resources_=void 0,this._onClassReadyFunc_=void 0,this._inheritStrategy_=new c}var c=a.getBootstrapClass("bootstrap.managers.classmanager.InheritStrategy");return b.extendPrototype({InheritStrategy:c,inherits:function(a){this._extends_=a},binds:function(a){this._binds_=a},traits:function(a){this._traits_=a},statics:function(a){"function"==typeof a&&LOG.reportError(wixErrors.INVALID_STATICS_PARAM,"classDefinition","statics"),this._statics_=a},fields:function(a){"function"==typeof a&&LOG.reportError(wixErrors.INVALID_FIELDS_PARAM,"classDefinition","fields"),this._fields_=a},methods:function(a){"function"==typeof a&&LOG.reportError(wixErrors.INVALID_METHODS_PARAM,"classDefinition","methods"),this._methods_=a},resources:function(a){this._resources_=a},utilize:function(a){this._imports_=a},onClassReady:function(a){this._onClassReadyFunc_=a}}),b}),define.bootstrapClass("bootstrap.managers.classmanager.ClassManager",function(){function a(){}return a.extendPrototype({init:function(){var a=this;return resource.getResources(["scriptLoader","W.Experiments"],function(b){var c=b.scriptLoader;a._experimentManager=b.W.Experiments;var d=a.define.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition");a._classRepo=a.define.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassRepository").init(c,a),a._classParser=a.define.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassParser").init(a._classRepo,d,a._experimentManager),a.define.Class.definitionModifier=a._onClassDefineCallBack.bind(a)}),this},addClassNamespaceHook:function(a){this._classRepo.classNamespacesHooks.push(a)},addClassReadyHandler:function(a){this._classRepo.classReadyHandlers.push(a)},loadMissingClasses:function(){this._classRepo.loadMissingClasses()},getClass:function(a,b){var c=this._classRepo.getClassStatus(a);if("ready"==c){var d=this._classRepo.getClass(a);return b&&b(d),d}this._getNotReadyClass(a,c,b)},_getNotReadyClass:function(a,b,c){switch(this._classRepo.addToWaitingForReady(a,c),b){case"loaded":var d=this.define.getDefinition("Class"),e=nsUtil.getNameSpace(d,a),f=this._classParser.registerNewClass(a,e);f&&f.length>0&&this._getClassDependencies(f);break;case"missing":this._classRepo.addClassesToScriptLoadingQueue([a])}},_getClassDependencies:function(a){for(var b=0;b<a.length;b++){var c=this._classRepo.getClassStatus(a[b]);"ready"!=c&&this.getClass(a[b])}},registerClassDefinition:function(a,b){var c=this._classParser.registerClassDefinition(a,b);c&&c.length>0&&this._getClassDependencies(c)},get:function(a,b){return this.getClass(a,b)},_onClassDefineCallBack:function(a,b){return this._classRepo.isClassWaitingForReady(a)&&this._classParser.registerNewClass(a,b),b},override:function(a,b){this._classRepo.override(a,b)},overrideDependency:function(a,b){return this._classParser.override(a,b)},getClassStatus:function(a){return this._classRepo.getClassStatus(a)},getClassStatusDetails:function(a){return this._classRepo.getClassStatusDetails(a)},newClass:function(a){if(this._classRepo.getClass(a.name))return LOG.reportError(wixErrors.CLASS_ALREADY_EXIST,this.className,"newClass",a.name),void 0;this._classParser.registerClass(Object.clone(a));return this.getClass(a.name)},_getClassDataErrorCode:function(a){this._classParser._getClassDataErrorCode(a)},removeClass:function(a){this._classRepo.deleteClass(a)},isReady:function(){return this._classRepo&&this._classRepo.isReady()},clone:function(a){var b=a.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassManager",[]),c=a.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition");return b._classRepo=this._classRepo.clone(a),a.getResourceFetcher().getResourceValue("W.Experiments",function(d){b._experimentManager=d,b._classParser=a.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassParser",[b._classRepo,c,b._experimentManager])}),b}}),a}),define.bootstrapClass("bootstrap.managers.classmanager.ClassParser",function(){function a(){this.registerClass=this.registerClass.bind(this),this._onDependenciesReady=this._onDependenciesReady.bind(this)}var b=window.rendererModel&&"nodebug"!==window.rendererModel.debugMode||window.editorModel&&"nodebug"!==window.editorModel.mode||/[?&]debugArtifacts?\b/i.test(window.location.search);return a.extendPrototype({init:function(a,c,d){return this._repository=a,this._overrides={},this.ClassDefinition=c,this._experimentManager=d,this._xclass=new window.XClass(b),this},override:function(a,b){this._overrides[a]=this._overrides[a]||[];var c=this._overrides[a].length?this._overrides[a].getLast():a;return this._overrides[a].push(b),c},registerNewClass:function(a,b){var c=new this.ClassDefinition;return b(c,c._inheritStrategy_),c=this._experimentManager.applyExperiments(a,c,"ExperimentClassPlugin"),this.registerClassDefinition(a,c)},registerClassDefinition:function(a,b){return this._wrapMethodsIfProfilerIsOn(a,b),this._fixClassDefinition(b),this.registerClass(a,b)},_wrapMethodsIfProfilerIsOn:function(a,b){var c=window.location.href.indexOf("profiler=true")>-1;c&&_.forEach(b._methods_,function(c,d){b._methods_[d]=window.__profiler.___profileFunction(c,d,a)})},registerClass:function(a,b){if(!this._checkClassRegistraionErrors(a,b)){var c=this._getItemDependencies(a,b);this._registerDependencies(c);var d=this._repository.registerDependentClass(c,this._onDependenciesReady,b,a);return d?void 0:c}},_onDependenciesReady:function(a,b){this._prepClassData(b);var c=this._prepResources(b),d=this;c&&c.length?(b._fields_.Resources=c,resource.getResources(c,function(c){b._fields_.$Resources=c,b._fields_.resources=c,d._createAndRegisterXClass(a,b)})):d._createAndRegisterXClass(a,b)},_fixClassDefinition:function(a){a._binds_&&(a._fields_._binds_=a._binds_)},_createAndRegisterXClass:function(a,b){var c=this._xclass.createClass(b,a);c._classDef_=b,this._repository.registerClass(c),b.onClassReady&&b.onClassReady(c)},_checkClassRegistraionErrors:function(a,b){var c=this._getClassDataErrorCode(a,b);return c?(LOG.reportError(wixErrors.CLASS_INVALID_PENDING_OBJECT,b&&b.name||"Unknown class","class data validation",c),!0):void 0},_registerDependencies:function(a){for(var b=this.define.getDefinition("Class"),c=0;c<a.length;++c){var d=a[c];if("loaded"===this._repository.getClassStatus(d)){var e=nsUtil.getNameSpace(b,d);this.registerNewClass(d,e)}}},_getFullNotReadyDependencyList:function(a,b,c){c=c||{};for(var d=0;d<b.length;d++){var e=b[d];if(e!==a&&!c[e]){var f=this._repository.getClassWaitingDependencies(e);if(f){for(var g=[],h=0;h<f.length;h++)this._repository.isClassReady(f[h])||g.push(f[h]);g.length>0&&(c[e]=g,this._getFullNotReadyDependencyList(a,g,c))}return c}}},_checkReadyRamificationsOnDependencies:function(a,b){for(var c in b)for(var d=b[c],e=0;e<d.length;e++){var f=d[e];if(!b[f]&&a!==f)return!1}return!0},_getItemDependencies:function(a,b){if(b){var c=[];return b._extends_&&c.combine(this._extractStringsOnlyArray(b._extends_)),b._imports_&&c.combine(this._extractStringsOnlyArray(b._imports_)),b._traits_&&c.combine(this._extractStringsOnlyArray(b._traits_)),c=this._replaceDependenciesWithOverrides(a,c)}},_replaceDependenciesWithOverrides:function(a,b){return Object.keys(this._overrides).length&&Array.each(b,function(c,d){if(this._overrides[c]){var e=this._overrides[c].length-1,f=this._overrides[c].indexOf(a);f>=0&&(e=f?f-1:0),this._overrides[c][e]!=a&&(b[d]=this._overrides[c][e])}}.bind(this)),b},_extractStringsOnlyArray:function(a){return"string"==typeOf(a)?[a]:"array"==typeOf(a)?a.filter(this._isString):[]},_isString:function(a){return"string"==typeOf(a)},_prepClassData:function(a){return this._prepClassExtends(a),this._prepClassTraits(a),this._prepClassImports(a),a._methods_.injects=this._WClassInjects,a._fields_.define=this.define,a._fields_.resource=this.resource,a},_WClassInjects:function(){return window.W},_prepClassExtends:function(a){a._extends_&&"string"==typeOf(a._extends_)&&(a._fields_._extends_=this._repository.getClass(a._extends_))},_prepClassTraits:function(a){if(a._traits_){var b=a._traits_;a._fields_._traits_=[];for(var c=0;c<b.length;c++){var d=b[c];a._fields_._traits_.push(this._repository.getClass(d))}}},_prepClassImports:function(a){var b={},c=a._fields_._extends_&&a._fields_._extends_.prototype&&a._fields_._extends_.prototype.imports;if(c&&(b=Object.clone(a._fields_._extends_.prototype.imports)),a._imports_)for(var d=0;d<a._imports_.length;d++){var e=a._imports_[d],f=e.split(".").getLast();b[f]?b[e]=this._repository.getClass(e):b[f]=this._repository.getClass(e)}if(_.isEmpty(b)||(a._fields_.imports=b),a._fields_._traits_)for(var g=0;g<a._fields_._traits_.length;++g){if(!a._fields_._traits_[g])return a;var h=a._fields_._traits_[g].prototype;h&&h.imports&&(a._fields_.imports||(a._fields_.imports={}),Object.merge(a._fields_.imports,h.imports))}},_prepResources:function(a){var b=a._resources_||[],c=a._fields_._extends_,d=c&&c.prototype&&c.prototype.Resources;if(d=d?Array.clone(c.prototype.Resources):[],b=Array.combine(b,d),a._fields_._traits_)for(var e=0;e<a._fields_._traits_.length;++e){var f=a._fields_._traits_[e].prototype;f&&f.Resources&&(b=Array.combine(b,f.Resources))}return b},_getClassDataErrorCode:function(a,b){return a&&instanceOf(a,String)?this._isValidClassName(a)?b._extends_&&"string"!==typeOf(b._extends_)?"Extends must be a string":b._imports_&&!this._isStringArray(b._imports_)?"Invalid imports array":b._traits_&&!this._isStringArray(b._traits_)?"Invalid traits array":!1:"Invalid class name: ["+a+"]":"No class name"},_isValidClassName:function(a){for(var b=a.split("."),c=b.length-1,d=0;c>d;d++){if(0===b[d].length)return!1;if(!b[d].test(/^[a-z][a-z0-9_]*$/))return!1}return b[c].test(/^[A-Z][A-Za-z0-9_]*$/)?!0:!1},_isStringArray:function(a){return"array"!=typeOf(a)?!1:a.every(function(a){return"string"==typeOf(a)})}}),a}),define.bootstrapClass("bootstrap.managers.classmanager.ClassRepository",function(){function a(){this.loadMissingClasses=this.loadMissingClasses.bind(this)}return a.extendPrototype({init:function(a,b){return this._readyClasses={},this._waitingForDependencies={},this._waitingForClassReady={},this._scriptLoadingQueue=[],this._scriptLoader=a,this._loadingMissingClassesStarted=!!b,this._loadingMissingClassesTimer=null,this.classNamespacesHooks=[],this.classReadyHandlers=[],this},getClass:function(a){return this._readyClasses[a]||null},getClassWhenReady:function(a,b){return this.isClassReady(a)?(b&&b(this.getClass(a)),this.getClass(a)):(this.isClassLoaded(a)||this.addClassesToScriptLoadingQueue([a]),this._waitingForClassReady[a]||(this._waitingForClassReady[a]=[]),b&&this._waitingForClassReady[a].push(b),void 0)},addToWaitingForReady:function(a,b){this._waitingForClassReady[a]||(this._waitingForClassReady[a]=[]),b&&this._waitingForClassReady[a].push(b)},getClassStatus:function(a){return this.isClassReady(a)?"ready":this.isClassWaitingForDependencies(a)?"pending":this.isClassLoaded(a)?"loaded":"missing"},getClassStatusDetails:function(a,b){b||(b=1);var c=this.getClassStatus(a);if("ready"===c)return"ready";if("missing"===c)return"missing";for(var d="pending:\n",e=this._waitingForDependencies[a].dependenciesArray,f=0;f<e.length;f++){var g=this.getClassStatusDetails(e[f],b+1);"ready"!=g&&(d+=this._addTabs(b)+"class :"+e[f]+":"+g)}return d},_addTabs:function(a){for(var b="",c=0;a>c;c++)b+="	";return b},registerClass:function(a){var b=a.prototype.$className;this._readyClasses[b]=a;var c;for(c=this.classReadyHandlers.length-1;c>=0;--c)this.classReadyHandlers[c](b,a);if(this._waitingForClassReady[b]){for(c=0;c<this._waitingForClassReady[b].length;c++)this._waitingForClassReady[b][c](a);delete this._waitingForClassReady[b]}for(var d in this._waitingForDependencies){var e=this._waitingForDependencies[d];this.areClassesReady(e.dependenciesArray)&&(delete this._waitingForDependencies[d],e.callback(d,e.classData))}},isClassReady:function(a){return"undefined"!=typeof this._readyClasses[a]},deleteClass:function(a){delete this._readyClasses[a]},areClassesReady:function(a){var b,c,d=!0;for(b=0,c=a.length;c>b;b++)if(!this.isClassReady(a[b])){d=!1;break}return d},registerDependentClass:function(a,b,c,d){return this.areClassesReady(a)?(b(d,c),!0):(this._waitingForDependencies[d]={dependenciesArray:a,callback:b,classData:c},this.addClassesToScriptLoadingQueue(a),!1)},loadMissingClasses:function(){clearTimeout(this._loadingMissingClassesTimer),delete this._loadingMissingClassesTimer,this._loadingMissingClassesStarted=!0;for(var a=0;a<this._scriptLoadingQueue.length;++a)if("missing"===this.getClassStatus(this._scriptLoadingQueue[a])){var b={url:this._scriptLoadingQueue[a]};this._scriptLoader.loadResource(b)}this._scriptLoadingQueue=[]},isClassLoaded:function(a){var b=this.define.getDefinition("Class");return nsUtil.getNameSpace(b,a)},isClassWaitingForDependencies:function(a){return this._waitingForDependencies[a]},getClassWaitingDependencies:function(a){return this.isClassWaitingForDependencies(a)?this._waitingForDependencies[a].dependenciesArray:null},isClassWaitingForReady:function(a){return this._waitingForClassReady[a]},isReady:function(){var a;for(a in this._waitingForDependencies)return!1;if(this._scriptLoadingQueue=this._filterLoadedClassesFromList(this._scriptLoadingQueue),this._scriptLoadingQueue.length)return!1;for(a in this._waitingForClassReady)return!1;return window.deployStatus&&!window.deployStatus.classRepoIsReadyTime&&(window.deployStatus.classRepoIsReadyTime=LOG&&LOG.getSessionTime()),!0},clone:function(a){return a.createBootstrapClassInstance("bootstrap.managers.classmanager.ClassRepository",[this._scriptLoader,this._loadingMissingClassesStarted])},addClassesToScriptLoadingQueue:function(a){var b=this._filterLoadedClassesFromList(a);this._loadClassesFromOtherNameSpaces(b),b=this._filterLoadedClassesFromList(b),this._scriptLoadingQueue.combine(b),this._loadingMissingClassesStarted&&!this._loadingMissingClassesTimer&&(this._loadingMissingClassesTimer=setTimeout(this.loadMissingClasses,10))},_loadClassesFromOtherNameSpaces:function(a){var b,c;for(b=0;b<a.length;b++)for(c=0;c<this.classNamespacesHooks.length;c++)"missing"===this.getClassStatus(a[b])&&this.classNamespacesHooks[c](a[b])},_filterLoadedClassesFromList:function(a){var b=this;return a.filter(function(a){return"missing"===b.getClassStatus(a)})},override:function(a,b){if(!a)throw new Error("Invalid class name for override");this._readyClasses[a]=b}}),a}),define.experimentPlugin("ExperimentClassPlugin",function(a){function b(a,b){var c=this.define.getBootstrapClass("bootstrap.managers.classmanager.ClassDefinition"),d=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy"),e=a;"function"==typeof a&&(e=new c,a(e));var f=new c;return b(f,d),e.inherits(f._extends_||e._extends_),e.resources(d._mergeField_(e._resources_,f._resources_)),e.binds(d._mergeField_(e._binds_,f._binds_)),e.traits(d._mergeField_(e._traits_,f._traits_)),e.utilize(d._mergeField_(e._imports_,f._imports_)),e.statics(d._mergeObjects_(e._statics_,f._statics_)),e.fields(d._mergeObjects_(e._fields_,f._fields_)),e.methods(d._mergeObjects_(e._methods_,f._methods_)),e}function c(a,b){define.Class(a,b)}var d=a;d.init("Class","newClass",b,c)}),define.bootstrapClass("bootstrap.managers.classmanager.InheritStrategy",function(){"use strict";function a(){}return a.extendPrototype({STRATEGIES:{INHERIT:"inherit",MERGE:"merge",OVERRIDE:"override"},inherit:function(){return{_strategy_:this.STRATEGIES.INHERIT}},merge:function(a,b){return{_strategy_:this.STRATEGIES.MERGE,include:a,exclude:b}},getInheritStrategy:function(a){return a?a._strategy_||this.STRATEGIES.OVERRIDE:this.STRATEGIES.OVERRIDE}}),a}),define.bootstrapClass("bootstrap.bootstrap.WClass",function(){function a(a,c){var d=this;a=a||{},a.className=c||a.className,d.validateScope(this,a.className),a.$className=a.className;var e=a._fields_&&a._fields_._extends_,f=d.clonePrototype(e),g={};for(var h in f)g[h]=f[h];d.implementTraits(a._fields_&&a._fields_._traits_,g),g.$className=a.$className,g.className=a.$className,_.forEach(a._methods_,function(a,b){g[b]=a}),_.forEach(a._fields_,function(a,b){g[b]=a});var i=g._statics_;delete g._statics_,e||(g.toString=a._methods_&&a._methods_.hasOwnProperty("toString")&&"function"==typeof a._methods_.toString?a._methods_.toString:this._$wclassToString,g.hasClassAncestor=this._hasClassAncestor),f._traits_ instanceof Array&&(g._traits_?g._traits_.combine(f._traits_):g._traits_=f._traits_),g._binds_=d.aggregateBinds(g._binds_,f._binds_,g._traits_),g.$parentPrototype=f,g.parent=function(){function a(){do{if(b=b?b.$parentPrototype:g,!b)return;for(var a in b)if(b[a]===c)break}while(b[a]!==c);if(b&&b[a]&&b.$parentPrototype){for(var e=d.realParent(b);b[a]===e[a];)b=e,e=d.realParent(b);if(b=d.realParent(b),b&&b[a]&&"function"==typeof b[a])return b[a]}}for(var b,c=g.parent.caller||arguments.callee.caller||arguments.caller;c.$wrapperFunction;)c=c.$wrapperFunction;if(!c)throw new Error("no caller!");return c.$parent||(c.$parent=a()||1),1!==c.$parent?c.$parent.apply(this,arguments):void 0},g._super=function(a){function b(a,b,c){if(null==c)throw new Error('no method "'+b+'" in the prototype chain above "'+a+'"');var d=c[b];if(void 0===d)return findProtoWithMethodInChain(a,b,c.$parentPrototype);if("function"!=typeof d)throw new Error('member "'+b+'" in prototype "'+c+'" is not a function');return c}this.__super_scope=this.__super_scope||{},this.__super_scope[a]=this.__super_scope[a]||g;var c=b(g.$className,a,this.__super_scope[a].$parentPrototype);this.__super_scope[a]=c;var d=Array.prototype.slice.call(arguments,1),e=c[a],f=e.apply(this,d);return delete this.__super_scope[a],f};var j=function(){b&&d.validateScope(this),d.bindMethods(g._binds_,this),d.initializeFieldsThatNeedToBeDeepCopied(this,g._$fieldsToCopy),g.initialize&&"function"==typeof g.initialize&&g.initialize.apply(this,arguments),d.initializeTraits(g._traits_,this,arguments)},k=null;k=b?new Function("_","return function "+a.className.split(".").pop()+" (){ return _.apply(this,arguments); };")(j):j;var l={};return l[a.className]=k,d.copyStatic(k,g,i,e),this.createFieldFactoryFunction(g,i),g.constructor=l[a.className],k.prototype=g,g.$class=k,g.$class.$originalClassName=g.$className,g.getOriginalClassName=function(){return g.$class.$originalClassName||g.$className},a.$extendsName?(g.$class.$extendsName=a.$extendsName,delete a.$extendsName):delete g.$class.$extendsName,k}var b=window.rendererModel&&"nodebug"!==window.rendererModel.debugMode||window.editorModel&&"nodebug"!==window.editorModel.mode||/[?&]debugArtifacts?\b/i.test(window.location.search);a.extendPrototype({constructor:window.WClass,realParent:function(a){for(var b=a.$parentPrototype;b&&b.$className&&a.$class.$extendsName&&a.$class.$extendsName!=b.$className;)b=b.$parentPrototype;return b},validateScope:function(a){a!==window&&a||LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"WClass","validateScope")();for(var b in a)a.hasOwnProperty(b)&&LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"WClass","validateScope")()},clonePrototype:function(a){if("function"!=typeof a)return{};var b={},c=a.prototype||{};if(c===Function.prototype||c===Function)return b;for(var d in c)(c.hasOwnProperty(d)||"toString"==d)&&(b[d]=c[d]);return b},validateClassData:function(a){var b;if("object"!=typeof a)return LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData",b)();if("string"!=typeof a.className||0===a.className.length)return LOG.reportError(wixErrors.WCLASS_CLASS_EMPTY_STRING,"WClass","validateClassData")();for(b in a)if(-1!==this.reservedWords.indexOf(b))return LOG.reportError(wixErrors.WCLASS_CLASS_RESERVED,"WClass","validateClassData",b)();return!a._traits_||a._traits_ instanceof Array?!a._binds_||a._binds_ instanceof Array?!0:LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData","Binds is not an array")():LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"WClass","validateClassData","Implements is not an array")()},reservedWordsForTraits:["initialize","parent","_extends_","_traits_","_binds_","$parentPrototype","$className"],reservedWords:["parent","$parentPrototype","$className"],excludeFromClone:["define","_traits_","_binds_","Resources","imports","resource","resources","__super_scope","jsonOfFieldsThatNeedToBeDeepCopied"],bindMethods:function(a,b){var c,d,e;if(a instanceof Array)for(c=0,d=a.length;d>c;c++)e=a[c],"function"==typeof b[e]?b[e]=b[e].bind(b):LOG.reportError(wixErrors.WCLASS_INVALID_BIND,"WClass","bindMethods",e)},implementTraits:function(a,b){var c,d,e,f;if(b._traits_=[],a instanceof Array)for(c=0,d=a.length;d>c;c++){e=a[c],b._traits_.push(e),"function"==typeof e&&(e=e.prototype);for(f in e)f&&-1===this.reservedWordsForTraits.indexOf(f)&&(b[f]=e[f])}},initializeTraits:function(a,b,c){var d,e,f;if(a instanceof Array)for(d=0,e=a.length;e>d;d++){f=a[d],"function"==typeof f&&(f=f.prototype);var g=f.initialize;g&&"function"==typeof g&&g.apply(b,c)}},createFieldFactoryFunction:function(a,b){b=this.getStaticsAsObject(b);var c,d,e={},f=!1;for(c in a)d=a[c],this._doesFieldNeedToBeDeepCopied(c,d,b)&&(e[c]=d,f=!0);if(f){var g=JSON.stringify(e);a._$fieldsToCopy=g}},_doesFieldNeedToBeDeepCopied:function(a,b,c){return b&&"object"==typeof b&&"$"!==a.charAt(0)&&-1===this.excludeFromClone.indexOf(a)&&!c.hasOwnProperty(a)},initializeFieldsThatNeedToBeDeepCopied:function(a,b){if(b){var c=JSON.parse(b);for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}},getStaticsAsObject:function(a){return a?(a instanceof Function&&(a=a()),a):{}},copyStatic:function(a,b,c,d){var e;if("function"==typeof d)for(e in d)d.hasOwnProperty(e)&&(a[e]=d[e]);if(c){var f=c instanceof Function;c=f?c():c;for(e in c){if(b[e]&&!f)throw new Error("The property "+e+" conflicts with a static property");a[e]=b[e]=c[e]}}},aggregateBinds:function(a,b,c){var d=[];return a instanceof Array&&d.combine(a),b instanceof Array&&d.combine(b),c&&c.forEach(function(a){a._binds_ instanceof Array?d.combine(a._binds_):a.prototype&&a.prototype._binds_ instanceof Array&&d.combine(a.prototype._binds_)}),d},_hasClassAncestor:function(a,b){var c=this;do{var d,e=c.className;if(b){var f=new RegExp("\\.?"+a+"(\\.|$)");d=e&&e.match(f)}else d=e==a;if(d)return!0;c=c._extends_&&c._extends_.prototype}while(c);return!1},_$wclassToString:function(){return"[wclass "+(this.className||"")+"]"},InvalidWClass:function(){throw new Error("invalid WClass")},isReady:function(){return!0}});var c,d=window.instanceOf,e=window;return e.instanceOf=c=function(b,f){if(f===a&&b&&"function"==typeof b&&b.prototype&&b.prototype.$className)return!0;if(b&&b.$className&&"function"==typeof f&&f.prototype&&f.prototype.$className)return b.getOriginalClassName()==f.prototype.getOriginalClassName()||instanceOf(b.$parentPrototype,f);e.instanceOf=d;var g=instanceOf(b,f);return e.instanceOf=c,g},a}),define.bootstrapClass("bootstrap.bootstrap.XClass",function(){function a(a){this._isDebug=!!a,this._createConstructor=this._isDebug?this._createNamedConstructor:this._createAnonymousConstructor}a.extendPrototype({constructor:window.XClass,createClass:function(a,b){a=a||{},b=b||a.className,a.$className=a.className=b;var c=this._createConstructor(b,this._WClassConstructor),d={},e=a._fields_&&a._fields_._extends_,f=this.clonePrototype(e);return this._setPrototypeFieldsAndMethods(a,c,d,e,f),this._setPrototypeClassSystemMembers(a,c,d,e,f),this._setClassMetaData(a,c,d,e,f),this._createStaticsAndCreateNoneStaticFieldJson(a,c,d),d.constructor=d.$class=c,c.prototype=d,c},_createNamedConstructor:function(a,b){return new Function("_","return function "+a.split(".").pop()+" (){ return _.apply(this,arguments); };")(b)},_createAnonymousConstructor:function(a,b){return function(){b.apply(this,arguments)}},_setPrototypeFieldsAndMethods:function(a,b,c,d,e){this._copyParent(b,c,d,e),this.implementTraits(a._fields_&&a._fields_._traits_,c),_.forEach(a._methods_,function(a,b){c[b]=a}),_.forEach(a._fields_,function(a,b){c[b]=a})},_copyParent:function(a,b,c,d){var e;if(c&&"function"==typeof c)for(e in c)c.hasOwnProperty(e)&&(a[e]=c[e]);for(e in d)b[e]=d[e]},_setPrototypeClassSystemMembers:function(a,b,c,d,e){c.parent=this._WClassParent,c._super=this._WClassSuper,c.$className=c.className=a.$className,c.$parentPrototype=e,c.$wc_getMethodParent=this._WClassGetMethodParent,c.$wc_realParent=this.realParent,c.setStaticPropertyValue=this._WClassSetStaticValue,a.$extendsName?b.$extendsName=a.$extendsName:delete b.$extendsName,d||(c.toString=a._methods_&&a._methods_.hasOwnProperty("toString")&&"function"==typeof a._methods_.toString?a._methods_.toString:this._$wclassToString,c.hasClassAncestor=this._hasClassAncestor),b.$originalClassName=c.$className,c.getOriginalClassName=this._WClassGetOriginalStupidClassNamePleaseKillMe},_setClassMetaData:function(a,b,c,d,e){e._traits_ instanceof Array&&(c._traits_?c._traits_.combine(e._traits_):c._traits_=e._traits_),c._binds_=this.aggregateBinds(c._binds_,e._binds_,c._traits_)},_createStaticsAndCreateNoneStaticFieldJson:function(a,b,c){var d=a._statics_;this.copyStatic(b,c,d),this.createFieldFactoryFunction(c,b)},_WClassGetOriginalStupidClassNamePleaseKillMe:function(){return this.$class.$originalClassName},_WClassConstructor:function(){var a=window.XClass.prototype;this._isDebug&&a.validateScope(this);var b=this.constructor.prototype;a.bindMethods(b._binds_,this),a.initializeFieldsThatNeedToBeDeepCopied(this,b._$fieldsToCopy),b.initialize&&"function"==typeof b.initialize&&b.initialize.apply(this,arguments),a.initializeTraits(b._traits_,this,arguments)},_WClassSetStaticValue:function(a,b){var c=this.constructor,d=c.prototype;if(d[a]&&!c[a])throw new Error("you tried to add a static property with an existing field/method name "+a);c[a]=d[a]=b},_WClassParent:function(){for(var a=this.constructor.prototype,b=a.parent.caller||arguments.callee.caller||arguments.caller;b.$wrapperFunction;)b=b.$wrapperFunction;if(!b)throw new Error("no caller!");return b.$parent||(b.$parent=this.$wc_getMethodParent(a,b,this.$wc_realParent)||1),1!==b.$parent?b.$parent.apply(this,arguments):void 0},_WClassGetMethodParent:function(a,b,c){var d,e;do{if(d=d?d.$parentPrototype:a,!d)return;for(e in d)if(d[e]===b)break}while(d[e]!==b);if(d&&d[e]&&d.$parentPrototype){for(var f=c(d);d[e]===f[e];)d=f,f=c(d);if(d=c(d),d&&d[e]&&"function"==typeof d[e])return d[e]}},_WClassSuper:function(a){function b(a,b,c){if(null==c)throw new Error('no method "'+b+'" in the prototype chain above "'+a+'"');var d=c[b];if(void 0===d)return findProtoWithMethodInChain(a,b,c.$parentPrototype);if("function"!=typeof d)throw new Error('member "'+b+'" in prototype "'+c+'" is not a function');return c}var c=this.constructor.prototype;this.__super_scope=this.__super_scope||{},this.__super_scope[a]=this.__super_scope[a]||c;var d=b(c.$className,a,this.__super_scope[a].$parentPrototype);this.__super_scope[a]=d;var e=Array.prototype.slice.call(arguments,1),f=d[a],g=f.apply(this,e);return delete this.__super_scope[a],g},realParent:function(a){for(var b=a.$parentPrototype;b&&b.$className&&a.$class.$extendsName&&a.$class.$extendsName!=b.$className;)b=b.$parentPrototype;return b},validateScope:function(a){a!==window&&a||LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"XClass","validateScope")();for(var b in a)a.hasOwnProperty(b)&&LOG.reportError(wixErrors.WCLASS_CLASS_MUST_USE_NEW_OP,"XClass","validateScope")()},clonePrototype:function(a){var b={};if("function"!=typeof a)return b;var c=a.prototype||{};if(c===Function.prototype||c===Function)return b;for(var d in c)(c.hasOwnProperty(d)||"toString"==d)&&(b[d]=c[d]);return b},validateClassData:function(a){var b;if("object"!=typeof a)return LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"XClass","validateClassData",b)();if("string"!=typeof a.className||0===a.className.length)return LOG.reportError(wixErrors.WCLASS_CLASS_EMPTY_STRING,"XClass","validateClassData")();for(b in a)if(-1!==this.reservedWords.indexOf(b))return LOG.reportError(wixErrors.WCLASS_CLASS_RESERVED,"XClass","validateClassData",b)();return!a._traits_||a._traits_ instanceof Array?!a._binds_||a._binds_ instanceof Array?!0:LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"XClass","validateClassData","Binds is not an array")():LOG.reportError(wixErrors.WCLASS_CLASS_DATA_INVALID,"XClass","validateClassData","Implements is not an array")()},reservedWordsForTraits:["initialize","parent","_extends_","_traits_","_binds_","$parentPrototype","$className"],reservedWords:["parent","$parentPrototype","$className"],excludeFromClone:["define","_traits_","_binds_","Resources","imports","resource","resources","__super_scope","jsonOfFieldsThatNeedToBeDeepCopied"],bindMethods:function(a,b){var c,d,e;if(a instanceof Array)for(c=0,d=a.length;d>c;c++)e=a[c],"function"==typeof b[e]?b[e]=b[e].bind(b):LOG.reportError(wixErrors.WCLASS_INVALID_BIND,"XClass","bindMethods",e)},implementTraits:function(a,b){var c,d,e,f;if(b._traits_=[],a instanceof Array)for(c=0,d=a.length;d>c;c++){e=a[c],b._traits_.push(e),"function"==typeof e&&(e=e.prototype);for(f in e)f&&-1===this.reservedWordsForTraits.indexOf(f)&&(b[f]=e[f])}},initializeTraits:function(a,b,c){var d,e,f;if(a instanceof Array)for(d=0,e=a.length;e>d;d++){f=a[d],"function"==typeof f&&(f=f.prototype);var g=f.initialize;g&&"function"==typeof g&&g.apply(b,c)}},createFieldFactoryFunction:function(a,b){var c,d,e=b,f={},g=!1;for(c in a)d=a[c],this._doesFieldNeedToBeDeepCopied(c,d,e)&&(f[c]=d,g=!0);if(g){var h=JSON.stringify(f);a._$fieldsToCopy=h}},_doesFieldNeedToBeDeepCopied:function(a,b,c){return b&&"object"==typeof b&&"$"!==a.charAt(0)&&-1===this.excludeFromClone.indexOf(a)&&!c.hasOwnProperty(a)},initializeFieldsThatNeedToBeDeepCopied:function(a,b){if(b){var c=JSON.parse(b);for(var d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}},getStaticsAsObject:function(a){return a?(a instanceof Function&&(a=a()),a):{}},copyStatic:function(a,b,c){var d;if(c){var e=c instanceof Function;c=e?c():c;for(d in c){if(b[d]&&!a[d]&&!e)throw new Error("The property "+d+" conflicts with a static property");a[d]=b[d]=c[d]}}},aggregateBinds:function(a,b,c){var d=[];return a instanceof Array&&d.combine(a),b instanceof Array&&d.combine(b),c&&c.forEach(function(a){a._binds_ instanceof Array?d.combine(a._binds_):a.prototype&&a.prototype._binds_ instanceof Array&&d.combine(a.prototype._binds_)}),d},_hasClassAncestor:function(a,b){var c=this;do{var d,e=c.className;if(b){var f=new RegExp("\\.?"+a+"(\\.|$)");
d=e&&e.match(f)}else d=e==a;if(d)return!0;c=c._extends_&&c._extends_.prototype}while(c);return!1},_$wclassToString:function(){return"[wclass "+(this.$className||"")+"]"},InvalidWClass:function(){throw new Error("invalid XClass")},isReady:function(){return!0}});var b,c=window.instanceOf,d=window;return d.instanceOf=b=function(e,f){if(f===a&&e&&"function"==typeof e&&e.prototype&&e.prototype.$className)return!0;if(e&&e.$className&&"function"==typeof f&&f.prototype&&f.prototype.$className)return e.getOriginalClassName()==f.prototype.getOriginalClassName()||instanceOf(e.$parentPrototype,f);d.instanceOf=c;var g=instanceOf(e,f);return d.instanceOf=b,g},a}),define.Class("bootstrap.managers.commands.Command",function(a){var b=a;b.methods({initialize:function(a){this._listeners=[],this._zombies=[],this._isEnabled=!0,this._name=a,this._numTimesExecuted=0,this._broadcasting=!1},getNumTimesExecuted:function(){return this._numTimesExecuted},registerListener:function(a,b,c){var d=this._findListenerIndex(a,b);0>d&&(this._listeners.push({listener:a,onExecute:b,onEnabledChanged:c}),c&&c.call(a,this))},unregisterListener:function(a){if(this._broadcasting)this._zombies.push(a);else for(var b;(b=this._findListenerIndex(a))>=0;)this._listeners.splice(b,1)},dispose:function(){this._listeners=[]},getName:function(){return this._name},execute:function(a,b){if(this._isEnabled){var c={command:this,source:b};this._numTimesExecuted++,this._broadcast("onExecute",[a,c])}},setState:function(a){this._setEnabled(!!a)},enable:function(){this._setEnabled(!0)},disable:function(){this._setEnabled(!1)},isEnabled:function(){return this._isEnabled},_broadcast:function(a,b){var c=this._listeners.length;this._broadcasting=!0;for(var d=0;c>d;++d)try{var e=this._listeners[d],f=e[a];f&&f.apply(e.listener,b)}catch(g){if(W.Utils.debugTrace("Exception while processing command",this.getName(),g,g.stack||""),"debug"==W.Config.getDebugMode())throw g;if("WEditorCommands.Save"===this.getName())LOG.reportError(wixErrors.SAVE_COMMAND_EXECUTE_EXCEPTION,this.$className,this.getName(),g.stack),W.Commands.executeCommand("WEditorCommands.UnlockSaveFreezeAfterException",null,null);else{var h="source: "+W.Config.env.$frameName+", stack: "+g.stack;LOG.reportError(wixErrors.COMMAND_EXECUTE_EXCEPTION,this.$className,this.getName(),h)}}this._broadcasting=!1,this._cleanupZombies()},_setEnabled:function(a){a=!!a,a!=this._isEnabled&&(this._isEnabled=a,this._broadcastEnabledChanged())},_broadcastEnabledChanged:function(){this._broadcast("onEnabledChanged",[this])},_cleanupZombies:function(){var a;if(!(0>=this._zombies.length)){for(var b=this._zombies.length-1;b>=0;--b)for(var c=this._zombies[b];(a=this._findListenerIndex(c))>=0;)this._listeners.splice(a,1);this._zombies=[]}},_findListenerIndex:function(a,b){for(var c=this._listeners,d=c.length-1;d>=0;--d)if(c[d].listener===a&&(void 0===b||c[d].onExecute===b))return d;return-1}})}),define.Class("bootstrap.managers.commands.Commands",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["bootstrap.managers.commands.Command"]),b.methods({initialize:function(){return this._commandMap={},this._pendingMap={},this.Command=this.imports.Command,this},isReady:function(){return!0},clone:function(a){return this.parent(a)},toString:function(){return"[Commands Manager]"},getCommand:function(a){var b=null;return a&&(b=a instanceof this.Command?a:this._commandMap[a]||null),b},registerCommand:function(a){var b=this._commandMap[a];if(b)return b;b=this.createCommand(a),this._commandMap[a]=b;var c=this._pendingMap[a];if(c){for(var d=0;d<c.length;++d){var e=c[d];b.registerListener(e.listener,e.executeCB,e.changedCB)}delete this._pendingMap[a]}return b},registerCommandAndListener:function(a,b,c,d,e){var f=this.registerCommand(a,e);return f.registerListener(b,c,d),f},executeCommand:function(a,b,c){var d=typeof a;"string"==d&&(a=this.getCommand(a)),a&&a.execute(b,c)},registerCommandListenerByName:function(a,b,c,d){var e=this.getCommand(a);if(e)e.registerListener(b,c,d);else{var f=this._pendingMap[a]||[];f.push({listener:b,executeCB:c,changedCB:d}),this._pendingMap[a]=f}},createCommand:function(a){return new this.Command(a)},unregisterCommand:function(a){var b=this._commandMap[a];b&&(b.dispose(),delete this._commandMap[a])},unregisterListener:function(a){for(var b in this._commandMap){var c=this._commandMap[b];c.unregisterListener(a)}}})}),define.Class("bootstrap.managers.events.Command",function(a){var b=a;b.inherits("bootstrap.managers.events.EventDispatcherBase"),b.utilize(["bootstrap.managers.commands.Command"]),b.statics({EXECUTE_EVENT_NAME:"execute",STATE_CHANGED_EVENT_NAME:"stateChanged"}),b.methods({initialize:function(a){this._isEnabled=!0,this._name=a,this._numTimesExecuted=0,this._setEventSysId(a)},getNumTimesExecuted:function(){return this._numTimesExecuted},registerListener:function(a,b,c){b&&this.on(this.EXECUTE_EVENT_NAME,a,b),c&&this.on(this.STATE_CHANGED_EVENT_NAME,a,c)},unregisterListener:function(a){var b=this._getObjectId(a);this.injects().Events.removeEventsForListener(this.getEventsSysId(),b)},getName:function(){return this._name},execute:function(a,b){this._isEnabled&&(this._numTimesExecuted++,this.trigger(this.EXECUTE_EVENT_NAME,{passedData:a,source:b}))},enable:function(){this.setState(!0)},disable:function(){this.setState(!1)},setState:function(a){this._isEnabled!=a&&(this._isEnabled=a,this.trigger(this.STATE_CHANGED_EVENT_NAME,{currentState:this._isEnabled}))},isEnabled:function(){return this._isEnabled},isRemovingFromObjectsMapOnlyUponDeath:function(){return!0}})}),define.Class("bootstrap.managers.events.CommandsManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["bootstrap.managers.events.Command","bootstrap.managers.events.ElementEventDispatching"]),b.methods({initialize:function(){new this.imports.ElementEventDispatching},isReady:function(){return!0},getCommand:function(a){var b=null;return a&&(b=a instanceof this.imports.Command?a:this.injects().Events.getObjectById(a)||null),b},registerCommand:function(a){var b=this.injects().Events.getObjectById[a];return b?b:new this.imports.Command(a)},registerCommandListener:function(a,b,c,d){var e=this.registerCommand(a);return e.registerListener(b,c,d),e},registerCommandAndListener:function(a,b,c,d){var e=this.registerCommand(a);return e.registerListener(b,c,d),e},executeCommand:function(a,b,c){a=this.getCommand(a),a&&a.execute(b,c)},registerCommandListenerByName:function(a,b,c,d){this.registerCommandAndListener(a,b,c,d)},createCommand:function(a){return new this.Command(a)},unregisterCommand:function(a){var b=this.getCommand(a);b.exterminate()},unregisterListener:function(a){var b=this.injects().Events.getObjectId(a);b&&this.injects().Events.deleteObjectFromMaps(b)},isCommandInstance:function(a){return a instanceof this.imports.Command}})}),define.Class("bootstrap.managers.events.DispatcherToHandlersMap",function(a){var b=a;b.fields({}),b.methods({initialize:function(){this._map={}},addHandler:function(a,b,c,d,e,f){var g=this._getWithInitHandlerObjectsForEventType(a,b),h=new this.HandlerObject(c,d,e,f);return g.push(h),h},isHandlerRegistered:function(a,b,c,d){var e=this._getWithInitHandlerObjectsForEventType(a,b);return e.some(function(a){return a.listenerId==c&&a.handler==d})},HandlerObject:function(a,b,c,d){this.listenerId=a,this.handler=b,c&&(this.nativeHandler=c),this.isOnce=!!d},removeHandler:function(a,b,c,d){var e=this._map[a];if(!e||!e[b])return null;var f=e[b],g=null;return f.eraseWithPredicate(function(a){return a.listenerId===c&&a.handler===d?(g=a,!0):!1}),0===f.length&&delete e[b],0===Object.keys(e).length&&delete this._map[a],g},removeListenerHandlers:function(a,b){var c=this._map[a],d={};for(var e in c){d[e]=[];var f=c[e];f.eraseWithPredicate(function(a){return a.listenerId===b?(d[e].push(a),!0):!1}),0===f.length&&delete c[e]}return d},deleteEntry:function(a){var b=this._map[a];return delete this._map[a],b},getHandlerObjects:function(a,b){var c=this._map[a];return c&&c[b]?_.clone(c[b]):[]},getAllHandlerObjectsForDispatcher:function(a){var b=this._map[a];if(!b)return[];var c=Object.values(b);return c.flatten()},getAllDispatcherIds:function(){return Object.keys(this._map)},_getWithInitHandlerObjectsForEventType:function(a,b){return this._map[a]||(this._map[a]={}),this._map[a][b]||(this._map[a][b]=[]),this._map[a][b]}})}),define.Class("bootstrap.managers.events.ElementEventDispatching",function(a){function b(a,b,c){var d=b;return c.condition&&(d=function(d){return c.condition.call(a,d)?b(d):!0}),d}function c(a,b,c){var d=null;return c&&(d=2===c?function(c){c=new Event(c,a.getWindow()),b(c)===!1&&c.stop()}:b),d}function d(){var a=W.Events.getAllDispatchingObjectIds().map(function(a){return f.getObjectId.call(this,a)},this);return a.filter(function(a){return"element"==typeOf(a)})}var e=a,f={getObjectId:function(a,b){return void 0===a.$alive||a.$alive?W.Events._objectsByIds.getObjectId(a,b):null},removeElementFromEventsMap:function(a){var b=this.getObjectId(a,!0);W.Events.deleteObjectFromMaps(b)}};e.methods({initialize:function(){[Element,Window,Document].invoke("implement",{$alive:!0,getEventsSysId:function(){return this._getObjectId(this,!1)},_getObjectId:f.getObjectId,once:function(a,b,c){this.on(a,b,c,!0)},on:function(a,d,e,f){var g=this._getObjectId(d,!0),h=this._getObjectId(this,!0);if(!g||!h)return console.error("you tried to register to a dead object"),this;var i=Element.Events[a],j=i&&i.base||a;if(W.Events.isHandlerRegistered(h,j,g,e))return this;var k=function(a){e.call(d,a)};i&&(i.onAdd&&i.onAdd.call(this,e),k=b(this,k,i));var l=Element.NativeEvents[j];return k=c(this,k,l),W.Events.addEventHandler(h,j,g,e,k,f),this},off:function(a,b,c){var d=this._getObjectId(b,!0),e=this._getObjectId(this,!0),f=Element.Events[a],g=f&&f.base||a;return W.Events.isHandlerRegistered(e,g,d,c)?(f&&f.onRemove&&f.onRemove.call(this,c),W.Events.removeEventHandler(e,g,d,c),this):this},trigger:function(a,b){if(void 0!==this.$alive&&!this.$alive)return console.error("you tried to trigger an event on a dead node element"),void 0;var c=Element.Events[a],d=c&&c.base||a,e=Element.NativeEvents[d];if(e)this._triggerNativeEvent(d);else{var f=this._getObjectId(this,!0);W.Events.dispatchEvent(f,a,b)}},exterminate:function(){var a=this.getElementsByTagName("*");_.forEach(a,f.removeElementFromEventsMap,f),f.removeElementFromEventsMap(this),this.cleanup(),this.destroy(),this.$alive=!1},isHandlingEventsWhenNotDisplayed:function(){return!1},addNativeListener:function(a,b){if("unload"==a){var c=b,d=this;b=function(){d.removeNativeListener("unload",b),c()}}return this.addEventListener?this.addEventListener(a,b,!1):this.attachEvent("on"+a,b),this},removeNativeListener:function(a,b){return this.removeEventListener?this.removeEventListener(a,b,!1):this.detachEvent("on"+a,b),this},_triggerNativeEvent:function(a){var b;return document.createEvent?(b=document.createEvent("HTMLEvents"),b.initEvent(a,!0,!0),!this.dispatchEvent(b)):(b=document.createEventObject(),this.fireEvent("on"+a,b))}}),window.attachEvent&&!window.addEventListener&&window.addNativeListener("unload",function(){d().each(function(a){a.exterminate()}),window.CollectGarbage&&window.CollectGarbage()})}})}),define.Class("bootstrap.managers.events.EventDispatcherBase",function(a){var b=a;b.resources(["W.Events"]),b.statics({_timerTypes:{timeout:1,interval:2}}),b.traits(["bootstrap.managers.events.TimersHandler"]),b.fields({$alive:!0}),b.methods({initialize:function(){},getEventsSysId:function(){return this._getObjectId(this,!1)},_setEventSysId:function(a){this.resources.W.Events._objectsByIds.registerObjectId(this,a)},_getObjectId:function(a,b,c,d){return void 0===a.$alive||a.$alive?this.resources.W.Events._objectsByIds.getObjectId(a,b):(this._reportErrorIfDead(c,d),null)},_getObjectIdIfInMap:function(a,b,c){return void 0===a.$alive||a.$alive?this.resources.W.Events._getObjectIdIfInMap_(a):(this._reportErrorIfDead(b,c),null)},_reportErrorIfDead:function(a,b){a&&console.error("you tried to "+b+" an event on a dead object ")},on:function(a,b,c){return this._addEventHandler(a,b,c)},once:function(a,b,c){return this._addEventHandler(a,b,c,!0)},_addEventHandler:function(a,b,c,d){var e=this._getObjectId(b,!0,!0,"register "+a),f=this._getObjectId(this,!0,!0,"register "+a);return e&&f?(this.resources.W.Events.addEventHandler(f,a,e,c,void 0,d),this):this},off:function(a,b,c){var d=this._getObjectIdIfInMap(b),e=this._getObjectIdIfInMap(this);return e&&d?(this.resources.W.Events.removeEventHandler(e,a,d,c),this):this},offByListener:function(a){var b=this._getObjectIdIfInMap(a),c=this._getObjectIdIfInMap(this);return c&&b?(this.resources.W.Events.removeEventsForListener(c,b),this):this},trigger:function(a,b,c){var d=this._getObjectIdIfInMap(this,!0,"trigger "+a);return d?this.resources.W.Events.dispatchEvent(d,a,b,c):this},exterminate:function(){this.trigger(Constants.EventDispatcher.Events.EXTERMINATING);var a=this._getObjectIdIfInMap(this);return a&&this.resources.W.Events.deleteObjectFromMaps(a),this.$alive=!1,a},getAllListenerObjects:function(a){return _.map(this._getAllHandlerRawObjects(a),function(a){return W.Events.getObjectById(a.listenerId)})},getAllHandlers:function(a){return _.map(this._getAllHandlerRawObjects(a),function(a){return{listener:W.Events.getObjectById(a.listenerId),handlerFunction:a.handler}})},_getAllHandlerRawObjects:function(a){var b=this._getObjectId(this);if(b){var c;return c=a?W.Events._dispatchersMapping.getHandlerObjects(b,a):W.Events._dispatchersMapping.getAllHandlerObjectsForDispatcher(b)}},isHandlingEventsWhenNotDisplayed:function(){return!1},isRemovingFromObjectsMapOnlyUponDeath:function(){return!1}})}),define.Class("bootstrap.managers.events.EventsManager",function(a){var b=a;b.inherits("bootstrap.managers.BaseManager"),b.utilize(["bootstrap.managers.events.DispatcherToHandlersMap","bootstrap.managers.events.ListenerToDispatchersMap","bootstrap.managers.events.ObjectsByIds"]),b.methods({initialize:function(){this._listenersMapping=new this.imports.ListenerToDispatchersMap,this._dispatchersMapping=new this.imports.DispatcherToHandlersMap,this._objectsByIds=new this.imports.ObjectsByIds},isReady:function(){return!0},addEventHandler:function(a,b,c,d,e,f){if(this._isValidObjectId(a)&&this._isValidObjectId(c)&&!this.isHandlerRegistered(a,b,c,d)){var g=this._dispatchersMapping.addHandler(a,b,c,d,e,f);return this._addNativeEvent(a,b,e),this._listenersMapping.addHandler(c,a),g}},removeEventHandler:function(a,b,c,d){var e=this._dispatchersMapping.removeHandler(a,b,c,d);if(e)return this._listenersMapping.removeHandler(c,a),this._removeNativeEvent(a,b,e.nativeHandler),this._deleteObjectIfPossible(c),this._deleteObjectIfPossible(a),e},removeEventsForListener:function(a,b){var c=this._dispatchersMapping.removeListenerHandlers(a,b);c&&this._removeNativeEvents({dispatcherId:c}),this._listenersMapping.removeListenerHandlers(b,a),this._deleteObjectIfPossible(b),this._deleteObjectIfPossible(a)},isHandlerRegistered:function(a,b,c,d){return this._dispatchersMapping.isHandlerRegistered(a,b,c,d)},dispatchEvent:function(a,b,c,d){var e=this._dispatchersMapping.getHandlerObjects(a,b),f={type:b,data:c||{},returnedValues:d?[]:void 0,target:this.getObjectById(a),isCustomEvent:!0},g={self:this,dispatcherId:a,eventType:b,eventObject:f,collectReturnedValues:d,dispatcherObject:this.getObjectById(a)};return _.forEach(e,this._callSingleHandlerAndRemoveIfOnce,g),f},_callSingleHandlerAndRemoveIfOnce:function(a){var b=this.self,c=this,d=b.getObjectById(a.listenerId);if(!c.dispatcherObject.$alive)return!1;if(d&&d.$alive!==!1){a.isOnce&&b.removeEventHandler(c.dispatcherId,c.eventType,a.listenerId,a.handler);var e=a.handler.call(d,c.eventObject);c.collectReturnedValues&&void 0!==e&&c.eventObject.returnedValues.push(e)}},_filterInactiveHandlers:function(a){return a},deleteObjectFromMaps:function(a){var b=this._listenersMapping.getAllDispatcherIdsForListener(a),c={};b.forEach(function(b){c[b]=this._dispatchersMapping.removeListenerHandlers(b,a),this._deleteObjectIfPossible(b)},this);var d=this._dispatchersMapping.getAllHandlerObjectsForDispatcher(a);d.forEach(function(b){this._listenersMapping.removeHandler(b.listenerId,a),this._deleteObjectIfPossible(b.listenerId)},this),c[a]=this._dispatchersMapping.deleteEntry(a),this._listenersMapping.deleteEntry(a),c&&this._removeNativeEvents(c),this._deleteObjectIfPossible(a,!0)},isObjectListensOrDispatchesAnyEvents:function(a){var b=this._listenersMapping.getAllDispatcherIdsForListener(a);if(b&&b.length>0)return!0;var c=this._dispatchersMapping.getAllHandlerObjectsForDispatcher(a);return c&&c.length>0},getAllDispatchingObjectIds:function(){return this._dispatchersMapping.getAllDispatcherIds()},_deleteObjectIfPossible:function(a,b){var c=this.getObjectById(a);if(c){var d=b||!c.isRemovingFromObjectsMapOnlyUponDeath||!c.isRemovingFromObjectsMapOnlyUponDeath();d&&!this.isObjectListensOrDispatchesAnyEvents(a)&&(this._listenersMapping.deleteEntry(a),this._dispatchersMapping.deleteEntry(a),this._deleteObjectFromMap(a))}},_deleteObjectFromMap:function(a){this._objectsByIds.removeObjectById(a)},getObjectById:function(a){return this._objectsByIds.getObjectById(a,!0)},getObjectId:function(a){return this._objectsByIds.getObjectId(a,!1)},_getObjectIdIfInMap_:function(a){return this._objectsByIds.getObjectIdIfInMap(a)},_isValidObjectId:function(){return!0},_addNativeEvent:function(a,b,c){if(c){var d=this.getObjectById(a);d&&d.addNativeListener&&d.addNativeListener(b,c)}},_removeNativeEvent:function(a,b,c){if(c){var d=this.getObjectById(a);d&&d.removeNativeListener&&d.removeNativeListener(b,c)}},_removeNativeEvents:function(a){for(var b in a)for(var c in a[b]){var d=a[b][c];d.each(function(a){this._removeNativeEvent(b,c,a.nativeHandler)},this)}}})}),define.Class("bootstrap.managers.events.ListenerToDispatchersMap",function(a){var b=a;b.methods({initialize:function(){this._map={}},addHandler:function(a,b){this._map[a]||(this._map[a]={});var c=this._map[a];c[b]?c[b]++:c[b]=1},removeHandler:function(a,b){var c=this._map[a];c&&c[b]&&(c[b]--,0===c[b]&&delete c[b],0===Object.keys(c).length&&delete this._map[a])},removeListenerHandlers:function(a,b){this._map[a]&&delete this._map[a][b]},deleteEntry:function(a){this._map[a]&&delete this._map[a]},getAllDispatcherIdsForListener:function(a){return this._map[a]?Object.keys(this._map[a]):[]}})}),define.Class("bootstrap.managers.events.ObjectsByIds",function(a){var b=a;b.fields({_OBJECT_ID_PROPERTY:"$id"}),b.methods({initialize:function(){this._objectIdsMap={}},getObjectId:function(a,b){var c=a[this._OBJECT_ID_PROPERTY];return c||(c=this.injects().Utils.getGUID(),a[this._OBJECT_ID_PROPERTY]=c),!this.getObjectById(c)&&b&&(this._objectIdsMap[c]=a),c},getObjectIdIfInMap:function(a){var b=a[this._OBJECT_ID_PROPERTY];return b&&this.getObjectById(b)?b:null},registerObjectId:function(a,b){return a[this._OBJECT_ID_PROPERTY]=b,this._objectIdsMap[b]=a,a},getObjectById:function(a){return this._objectIdsMap[a]},removeObjectById:function(a){this._objectIdsMap[a]&&delete this._objectIdsMap[a]}})}),define.Class("bootstrap.managers.events.TimersHandler",function(a){var b=a;b.methods({initialize:function(){this.on("exterminating",this,this._clearAllTimers),this._timers={}},setTimeout:function(a,b){var c=b||0,d=this._getExecutingFunction(a,this._timerTypes.timeout),e=window.setTimeout(d,c);return d.timerId=e,this._timers[e]={type:this._timerTypes.timeout,isActive:!0},e},setInterval:function(a,b){var c=this._getExecutingFunction(a,this._timerTypes.interval),d=window.setInterval(c,b);return c.timerId=d,this._timers[d]={type:this._timerTypes.interval,isActive:!0},d},isActiveTimer:function(a){return this._timers[a]&&this._timers[a].isActive},_getExecutingFunction:function(a,b){var c=this;return function(){var d=arguments.callee&&arguments.callee.timerId;d&&b==c._timerTypes.timeout&&c._timers[d]&&(c._timers[d].isActive=!1),a.call(c)}},_clearAllTimers:function(){Object.each(this._timers,function(a,b){b=Number(b),a.type==this._timerTypes.timeout?window.clearTimeout(b):a.type==this._timerTypes.interval&&window.clearInterval(b)},this)}})}),define.Const("EventDispatcher",{Events:{EXTERMINATING:"exterminating"}}),define.experimentPlugin("ExperimentConstantsPlugin",function(a){function b(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentStrategy");b[c.STRATEGY_FLAG]=c.MERGE;var d=c._mergeField_(a,b);return d}function c(a,b){define.Const(a,b)}var d=a;d.init("Const","newConst",b,c)}),define.bootstrapClass("bootstrap.managers.experiments.ExperimentPlugin",function(){function a(){}return a.extendPrototype({init:function(a,b,c,d){return this._modifyNamespace=a,this._newNamespace=b,this._mergeSingleExperiment=c,this.convertNew=d,this},_setModifiers:function(){this.define.experiment[this._newNamespace].definitionModifier=this._experimentDefined.bind(this),this.define.experiment[this._newNamespace].nameModifier=this._experimentNameDefined.bind(this),this.define.experiment[this._modifyNamespace].nameModifier=this._experimentNameDefined.bind(this)},_convertFromNewNamespace:function(){var a=this.define.getDefinition("experiment",this._newNamespace);a&&nsUtil.forEachLeaf(a,function(a,b){this._experimentDefined(b,a)}.bind(this))},setRunningExperimentsIds:function(a,b){this._runningExperimentIds=a,this._runningExperimentsIndexes=b,this._convertFromNewNamespace(),this._setModifiers()},_experimentNameDefined:function(a){var b=this._getExperimentInfo(a);return b.definitionName+"."+b.experimentName},_experimentDefined:function(a,b){var c=this._getExperimentInfo(a),d=c.experimentName.toLowerCase(),e=this._runningExperimentsIndexes[d];return e&&this.convertNew(c.definitionName,b),b},convertNew:function(){throw new Error("Invalid ExperimentPlugin: convertNew method not set. Use init to override it",this)},_mergeSingleExperiment:function(){throw new Error("Invalid ExperimentPlugin: _mergeSingleExperiment method not set. Use init to override it",this)},applyExperiments:function(a,b){var c=this._modifyNamespace+"."+a,d=this.define.getDefinition("experiment",c);if(!d)return b;var e=this._getOrderedLoadedExperiments(d,this._runningExperimentsIndexes);return _.reduce(e,this._mergeSingleExperiment,b)},_isKeyEqualToNewCaseInsensitive:function(a,b){return"new"===b.toLowerCase()},_getExperimentDefinitionFunction:function(a){return"function"==typeof a?a:_.find(a,this._isKeyEqualToNewCaseInsensitive)},_compactSparseArray:function(a){var b=[];if(a.length)for(var c in a)a.hasOwnProperty(c)&&b.push(a[c]);return b},_getOrderedLoadedExperiments:function(a,b,c){var d=[],e=this;return _.forOwn(a,function(a,f){var g=f.toLowerCase(),h=b[g];if(h){var i=e._getExperimentDefinitionFunction(a);i&&"function"==typeof i.call?d[h]=i:LOG.reportError(wixErrors.EXPERIMENT_INVALID_DEFINITION,'Could not find experiment definition function in definition "experiment.'+c+'" for experiment "'+f+'"')}}),this._compactSparseArray(d)},_getExperimentInfo:function(a){var b=a.split("."),c=b.pop();"new"==c.toLowerCase()&&(c=b.pop());var d=b.join(".");return{experimentName:c.toLowerCase(),definitionName:d}}}),a}),define.bootstrapClass("bootstrap.managers.experiments.ExperimentStrategy",function(){function a(){}return a.extendPrototype({init:function(){return this},STRATEGY_FLAG:"experimentStrategy",BEFORE:"before",AFTER:"after",AROUND:"around",MERGE:"merge",DELETE:"delete",CUSTOM:"customField",before:function(a){if("function"!=typeof a)throw new Error("before must be on a method");return a[this.STRATEGY_FLAG]=this.BEFORE,a},after:function(a){if("function"!=typeof a)throw new Error("after must be on a method");return a[this.STRATEGY_FLAG]=this.AFTER,a},around:function(a){if("function"!=typeof a)throw new Error("around must be on a method");return a[this.STRATEGY_FLAG]=this.AROUND,a},merge:function(a){var b=function(){return a};return b[this.STRATEGY_FLAG]=this.MERGE,b},remove:function(a){var b=function(){return a};return b[this.STRATEGY_FLAG]=this.DELETE,b},customizeField:function(a){if("function"!=typeof a)throw new Error("custom must be on a method");return a[this.STRATEGY_FLAG]=this.CUSTOM,a},_mergeObjects_:function(a,b){a=a||{};var c=Object.clone(a);for(var d in b){var e=b[d],f=a[d];c[d]=this._mergeSingleObject(e,f),this._isDeleteFieldObj(c[d])&&delete c[d]}return c},_mergeSingleObject:function(a,b){var c;return c="function"==typeof a&&this._isMethodStrategy(a)?this._resolveMethod(b,a):"function"==typeof a&&this._isFieldStrategy(a)?this._mergeField_(b,a):a},_isMethodStrategy:function(a){var b=a[this.STRATEGY_FLAG];return b&&(b===this.AFTER||b===this.BEFORE||b===this.AROUND)},_isFieldStrategy:function(a){var b=a[this.STRATEGY_FLAG];return b&&(b===this.MERGE||b===this.DELETE||b===this.CUSTOM)},_resolveMethod:function(a,b){var c;if(!a){if(b[this.STRATEGY_FLAG])throw new Error("cannot "+b[this.STRATEGY_FLAG]+" if original method is not defined");return b}switch(b[this.STRATEGY_FLAG]){case this.BEFORE:c=function(){return b.apply(this,arguments),a.apply(this,arguments)};break;case this.AFTER:c=function(){var c=a.apply(this,arguments);return b.apply(this,arguments),c};break;case this.AROUND:c=function(){var c=this,d=Array.prototype.splice.call(arguments,0);return d.splice(0,0,function(){return a.apply(c,d.slice(1))}),b.apply(this,d)};break;default:c=b}return a.$wrapperFunction=c,c},_mergeField_:function(a,b){if(this._isEmpty(b))return a;var c=b[this.STRATEGY_FLAG]==this.MERGE||!1,d=b[this.STRATEGY_FLAG]==this.DELETE||!1,e=b[this.STRATEGY_FLAG]==this.CUSTOM||!1;return e?(delete b[this.STRATEGY_FLAG],b=b(a)):"function"==typeof b&&(b=b()),c?(delete b[this.STRATEGY_FLAG],this._combine(a,b)):d?this._getFieldDeleteObj():b},_getFieldDeleteObj:function(){return{_delete_:!0}},_isDeleteFieldObj:function(a){return a&&a._delete_===!0},_isEmpty:function(a){return a?a instanceof Array&&0===a.length?!0:"object"==typeof a&&0===Object.getLength(a)?!0:!1:!0},_combine:function(a,b){if(b instanceof Array&&(a instanceof Array||this._isEmpty(a))){this._isEmpty(a)&&(a=[]);for(var c=0;c<b.length;++c){var d=b[c];this._elementExistsInArray(d,a)||a.push(d)}}else if("object"==typeof b&&("object"==typeof a||this._isEmpty(a))){this._isEmpty(a)&&(a={});for(var e in b)a[e]="object"==typeof a[e]&&"object"==typeof b[e]||a[e]instanceof Array&&b[e]instanceof Array?this._combine(a[e],b[e]):b[e]}return a},_elementExistsInArray:function(a,b){for(var c=0;c<b.length;c++)if(this._areEqual(b[c],a))return!0;return!1},_areEqual:function(a,b){return"object"==typeof a&&"object"==typeof b?this._areObjectsEqual(a,b):a instanceof Array&&b instanceof Array?this._areArraysEqual(a,b):a!==b?!1:!0},_areObjectsEqual:function(a,b){var c;for(var d in a)if(c=this._areEqual(a[d],b[d]),!c)return!1;return!0},_areArraysEqual:function(a,b){var c;if(a.length!==b.length)return!1;for(var d=0;d<a.length;d++)if(c=this._areEqual(a[d],b[d]),!c)return!1;return!0}}),a}),resource.getResources(["ExperimentsList","deployment"],function(a){define.bootstrapClass("bootstrap.managers.experiments.Experiments",function(){function b(){this._pluginsMap={}}return b.DESCRIPTORS_NAMESPACE="resource.experimentDescriptors",b.extendPrototype({init:function(b,c){return this._initArgs=arguments,c&&(this.getExperimentDescriptor=c),b||(b=a.ExperimentsList.getExperimentsList()),this._finishInit(b),this},_finishInit:function(b){var c=_.keys(b).filter(function(a){return"new"==b[a]});this._experimentDescriptorMap=this._getRunningExperimentsDescriptorMap(c),this._organizer=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentsOrganizer",[]),this._runningExperimentIds=this._organizer.organize(c,this._experimentDescriptorMap),window&&window.console&&!window.console.isWConsole&&a.deployment&&a.deployment.addOnDeploymentComplete&&a.deployment.addOnDeploymentComplete(this._printNonSkippedErrors.bind(this)),this._runningExperimentsSet=_.reduce(this._runningExperimentIds,function(a,b,c){return a[b]=c+1,a},{}),this._setExperimentPluginDefinitions()},_setExperimentPluginDefinitions:function(){var a=this.define.getDefinition("experimentPlugin");for(var b in a)this._addPlugin(b,a[b]);this.define.experimentPlugin.definitionModifier=this._onExperimentPluginDefined.bind(this)},getErrors:function(){if(!this._organizer)return null;var a=this._organizer.getRemovalLog();return this._formatErrors(a)},_formatErrors:function(a){var b=a.map(function(a){return[a.removedId,a.name,a.message]});return"\n"+W.Utils.StringUtils.printTable([].concat(b))},_printNonSkippedErrors:function(){var a=this._organizer.getRemovalLog();a=a.filter(function(a){return!a.skipLog}),a.length>0&&console.error("Experiment definition errors: \n"+this._formatErrors(a))},_getRunningExperimentsDescriptorMap:function(a){var b={};return a.forEach(function(a){var c=this.getExperimentDescriptor(a);c&&(b[a]=c)}.bind(this)),b},applyExperiments:function(a,b,c){function d(c){b=c.applyExperiments(a,b)}if(c){var e=this._pluginsMap[c];b=e.applyExperiments(a,b)}else _.each(this._pluginsMap,d);return b},_onExperimentPluginDefined:function(a,b){this._addPlugin(a,b)},_addPlugin:function(a,b){var c=this.define.createBootstrapClassInstance("bootstrap.managers.experiments.ExperimentPlugin");b(c),c.setRunningExperimentsIds(this._runningExperimentIds,this._runningExperimentsSet),this._pluginsMap[a]=c},isReady:function(){return void 0!==this._runningExperimentIds},isDeployed:function(a){if("string"==typeof a)return!!this._runningExperimentsSet[a.toLowerCase()];if("function"==typeof a.every)return a.every(function(a){return this._runningExperimentsSet[a.toLowerCase()]}.bind(this));var b,c,d;for(var e in a)if(a.hasOwnProperty(e)){if(b=a[e],"string"==typeof e){if(c=e,d=b,"string"==typeof d&&"new"!=d.toLowerCase())return LOG.reportError(wixErrors.EXPERIMENT_INVALID_DEFINITION,'group must be "new" (case insensitive), specified: "'+c+'", for experiments: "'+JSON.stringify(a)+'" in call to Experiments.isDeployed'),!1}else c=""+b;if(!this._runningExperimentsSet[c.toLowerCase()])return!1}return!0},getRunningExperimentIds:function(){return this._runningExperimentIds.slice()},getAllDefinedExperimentIds:function(){var a=this.define.getDefinition(b.DESCRIPTORS_NAMESPACE);if(!a)throw new Error('Could not get definition "'+b.DESCRIPTORS_NAMESPACE+'"');return nsUtil.getNamespacesAsStrings(a)},getExperimentDescriptor:function(a){var c=this.define.getDefinition(b.DESCRIPTORS_NAMESPACE+"."+a.toLowerCase());return c?c.value:null},clone:function(a){return a.createBootstrapClassInstance("bootstrap.managers.experiments.Experiments",this._initArgs)},isExperimentOpen:function(a,b){return"string"==typeof b&&"new"!=b.toLowerCase()?(LOG.reportError(wixErrors.EXPERIMENT_INVALID_DEFINITION,'groupName must be "new" (case insensitive), specified: "'+b+'", for experiment: "'+b+'" in call to Experiments.isExperimentOpen'),!1):this.isDeployed(a)}}),b})}),define.bootstrapClass("bootstrap.managers.experiments.ExperimentsOrganizer",function(){"use strict";function a(){}function b(a,b){return a>b?1:b>a?-1:0}function c(a,b){return null==a?{name:"EXPERIMENT_INVALID_DEFINITION",message:'Missing createTime in descriptor "'+b+'"'}:j.test(a)?null:{name:"EXPERIMENT_INVALID_DEFINITION",message:'Invalid createTime "'+a+'" in descriptor "'+b+'". Valid format: "YYYY-MM-DDThh:mm:ss[.fff]", eg, "2013-06-20T13:45:12"'}}function d(a,b){for(var c,d,e,f,g={},h=_.keys(a),i=0;!c&&i<h.length;)d=h[i],f=d.toLowerCase(),g.hasOwnProperty(f)&&(c={name:"EXPERIMENT_INVALID_DEFINITION",message:'There is more than one constraint with the lower-case name "'+f+'" in experiment "'+b+'"'}),e=a[d],c||l.test(e)||(c={name:"EXPERIMENT_INVALID_DEFINITION",message:'Invalid constraint "'+e+'" for experiment "'+d+'" in descriptor "'+b+'": Valid constraints are: ["conflicts", "required", "optional", "required-before", "optional-before", "required-after", "optional-after"]'}),c||(g[f]=e),++i;return{exception:c,result:g}}function e(a,b){var e,f={id:a};if(e=c(b.createTime,a),e||(f.createTime=b.createTime),!e&&b.constraints){var g=d(b.constraints,a);
e=g.exception,f.constraints=g.result}return{result:f,exception:e}}function f(a,b){_.forOwn(a,function(a){a.constraintsOrder=_.keys(a.constraints||{}).sort(function(a,c){return b[a]-b[c]})})}function g(a){return{name:"EXPERIMENT_UNKNOWN",skipLog:!0,message:'Could not find a descriptor for experiment "'+a+'"'}}function h(a,b,c){for(var d,f,h,i={},j=0;j<a.length;j++){if(d=a[j],f=null,d.toLowerCase()!=d&&(f={name:"EXPERIMENT_ID_NOT_IN_LOWER_CASE_IN_LIST",message:'Id for experiment "'+d+'" in list of running experiments is not in all-lowercase; this experiment will not be enabled'}),h=b[d],f||h||(f=g(d)),!f){var k=e(d,h);f=k.exception}f?c(d,f):i[d]=k.result}return i}function i(a,b,c,d,e){if(void 0!==d[c])return d;var f=function(a){return d[c]=a,d};e.push(c);var h=function(){return e.length>1?". Require chain: "+JSON.stringify(e):""},j=a[c];if(!j){var k=g(c);return k.message+=h(),f(k)}var l=j.constraints;if(!l)return f(!0);var m=_.clone(d);m[c]=!0;for(var n,o,p=j.constraintsOrder,q=0;q<p.length;q++)if(n=p[q],o=l[n],0==o.indexOf("required")){if(!b[n])return f({name:"EXPERIMENT_MISSING_DEPENDENCY",message:'Experiment "'+c+'" requires experiment "'+n+'" which is not running'+h()});if(m=i(a,b,n,m,e),m[n]!==!0)return f(m[n])}else if("conflicts"==o){if(m[n]===!0)return f({name:"EXPERIMENT_IN_CONFLICT",message:'Experiment "'+c+'" is conflicted with running experiment "'+n+'"'+h()});b[n]&&void 0===m[n]&&(m[n]={name:"EXPERIMENT_IN_CONFLICT",message:'Running experiment "'+c+'" is conflicted with experiment "'+n+'"'+h()})}return m}var j=/^[0-9]{4}-[01][0-9]-[0-3][0-9]T[0-2][0-9]:[0-5][0-9]:[0-5][0-9](\.[0-9]{1,9})?$/,k=a.prototype;a._defaultLogger=function(a,b){var c=null!=wixErrors?wixErrors[a]:null;null!=c&&null!=LOG&&"function"==typeof LOG.reportError&&LOG.reportError(c,"","",b)};var l=/^(conflicts)|(((required)|(optional))(-((before)|(after)))?)$/;return a._normalizeDescriptors=function(c,d,e){e=e||function(){};var g=_.filter(_.keys(d),function(a){return a!=a.toLowerCase()});_.forEach(g,function(a){e(a,{name:"EXPERIMENT_ID_NOT_IN_LOWER_CASE_IN_DESCRIPTORS",message:'Id for experiment "'+a+'" in descriptors is not in all-lowercase; this experiment will not be enabled'})});var i=h(c,d,e),j=_.keys(d).sort(function(a,c){return b(d[a].createTime,d[c].createTime)}),k=a._arrayToSetObj(j);return f(i,k),{normalizedDescriptors:i,runningExperimentIdsWithInitialOrder:j,runningExperimentsSet:k}},a._arrayToSetObj=function(a){return _.reduce(a,function(a,b,c){return a[b]=c+1,a},{})},a._applyBinaryConstraints=function(a,b,c,d){d=d||function(){};var e={};return _.forEach(a,function(a){e=i(b,c,a,e,[])}),a.filter(function(a){var b=e[a];return b!==!0&&(d(a,b),c[a]=null),b===!0})},k.getRemovalLog=function(){return this._removalLog},k.init=function(b){return this._logger=b||a._defaultLogger.bind(this),this._removalLog=[],this._removalLogger=a._defaultRemovalLogger.bind(this),this},a._defaultRemovalLogger=function(a,b){b.removedId=a,this._removalLog.push(b),b.skipLog||this._logger(b.name,b.message)},a._toposort=function(a,b){function c(b,g){if(g.indexOf(b)>=0)return e={name:"EXPERIMENT_CYCLIC_DEPENDENCY",message:JSON.stringify(g.concat(b)),cycleInNode:b},void 0;if(!f[b]){f[b]=!0;var h=a[b]||[],i=h.length;if(i>0){var j=g.concat(b);do--i,c(h[i],j);while(i>0)}d.push(b)}}for(var d=[],e=null,f={},g=0;g<b.length;g++)if(c(b[g],[]),e)return{exception:e};return{result:d}},a._applyOrderConstraints=function(b,c,d){var e={};_.forEach(b,function(a){var b=c[a];_.forEach(b.constraintsOrder,function(c){if(d[c]){var f=b.constraints[c];switch(f){case"required-before":case"optional-before":e[a]=e[a]||[],e[a].push(c);break;case"required-after":case"optional-after":e[c]=e[c]||[],e[c].push(a)}}})});var f=a._toposort(e,b);return f.exception?{exception:f.exception}:{result:f.result}},a._applyConstraints=function(b,c,d,e){for(;b.length>0;){b=a._applyBinaryConstraints(b,c,d,e);var f=a._applyOrderConstraints(b,c,d);if(!f.exception)return f.result;var g=f.exception;if("EXPERIMENT_CYCLIC_DEPENDENCY"!=g.name)throw g;e(g.cycleInNode,g),b.splice(b.indexOf(g.cycleInNode),1),d[g.cycleInNode]=null}return[]},k.organize=function(b,c){var d=a._normalizeDescriptors(b,c,this._removalLogger),e=a._applyConstraints(d.runningExperimentIdsWithInitialOrder,d.normalizedDescriptors,d.runningExperimentsSet,this._removalLogger);return e},a}),define.Class("bootstrap.utils.BufferFunction",function(a){var b=a;b.binds(["_wrapperFunction"]),b.methods({initialize:function(a,b){this._isFirstCallDelayed=!1,this._bufferTime=1e3,this._lastCallArguments,this._replaceFunctionAndSaveOriginal(a,b),this._clearBuffer()},setBufferTime:function(a){this._bufferTime=a},getBufferTime:function(){return this._bufferTime},setIsFirstCallDelayed:function(a){this._isFirstCallDelayed=a},getIsFirstCallDelayed:function(){return this._isFirstCallDelayed},_replaceFunctionAndSaveOriginal:function(a,b){this._scope=a,this._originalFunction=a[b],a[b]=this._wrapperFunction},_wrapperFunction:function(){this._lastCallArguments=arguments,this._tryCallingFunction()},_tryCallingFunction:function(){this.isReadyToCall()?(this.callOriginalFunction(),this._delayCall(this._clearBuffer)):this._delayCall(this._clearBufferAndTryCallingFunction)},callOriginalFunction:function(){this._originalFunction.apply(this._scope,this._lastCallArguments)},isReadyToCall:function(){return!this._callTimerId&&this._isFirstCallDelayed===!1},_clearBuffer:function(){this._callTimerId=void 0},_clearBufferAndTryCallingFunction:function(){this._clearBuffer(),this._tryCallingFunction()},_delayCall:function(a){this.injects().Utils.clearCallLater(this._callTimerId),this._callTimerId=this.injects().Utils.callLater(a,[],this,this._bufferTime)}})}),define.utils("Debug",function(){return{addComponentDebugIndicators:function(){var a=this._getAllPageComponents();_(a).forEach(function(a){var b=a.getViewNode();b.style.border="1px solid black";var c=b.getElementsByClassName("componentDebugIndicator")[0];c||(c=this.createDebugIndicatorElement("red","black"),b.adopt(c)),c.textContent=this._getDebugIndicatorText(a)}.bind(this))},removeComponentDebugIndicators:function(){var a=this._getAllPageComponents();_(a).forEach(function(a){var b=a.getViewNode();b.style.border="";var c=b.getElementsByClassName("componentDebugIndicator")[0];c&&c.dispose()})},createDebugIndicatorElement:function(a,b){var c=new Element("div",{styles:{display:"block",border:"1px dashed "+b,position:"absolute",top:"-11px","line-height":"9px",color:a},"class":"componentDebugIndicator"});return c},_getAllPageComponents:function(){return W.Preview.getPageComponents(W.Preview.getPreviewManagers().Viewer.getCurrentPageId(),W.Config.env.$viewingDevice)},_getDebugIndicatorText:function(a){return"(ID:"+a.getComponentId()+",x="+a.getX()+",y="+a.getY()+",w="+a.getWidth()+",h="+a.getHeight()+",pH="+a.getPhysicalHeight()+")"}}}),define.Class("bootstrap.utils.Events",function(a){var b=a;b.methods({addEvent:function(a,b){return a=this._removeOn(a),this.$events=this.$events||{},this.$events[a]=(this.$events[a]||[]).include(b),this},addEvents:function(a){for(var b in a)this.addEvent(b,a[b]);return this},fireEvent:function(a,b,c){if(this.$events){a=this._removeOn(a);var d=this.$events[a];if(!d)return this;b=Array.from(b);var e=d.clone();e.each(function(a){a&&(c?a.delay(c,this,b):a.apply(this,b))},this)}return this},removeEvent:function(a,b){if(this.$events){a=this._removeOn(a);var c=this.$events[a];if(c)if(b){var d=c.indexOf(b);-1!=d&&(c.splice(d,1),0===c.length&&delete this.$events[a])}else delete this.$events[a]}return this},removeEvents:function(a){var b;if("object"==typeOf(a)){for(b in a)this.removeEvent(b,a[b]);return this}a&&(a=this._removeOn(a));for(b in this.$events)if(!a||a==b)for(var c=this.$events[b],d=c.length;d--;)this.removeEvent(b,c[d]);return this},_removeOn:function(a){return a.replace(/^on([A-Z])/,function(a,b){return b.toLowerCase()})},removeAllEvents:function(){this.$events={}}})}),define.utils("Layout",function(){return{getBoundingWidth:function(a,b,c){return parseInt(Math.abs(a*Math.cos(c))+Math.abs(b*Math.sin(c)),10)},getBoundingHeight:function(a,b,c){return parseInt(Math.abs(a*Math.sin(c))+Math.abs(b*Math.cos(c)),10)},getBoundingX:function(a,b,c){return parseInt(a-(c-b)/2,10)},getBoundingY:function(a,b,c){return parseInt(a-(c-b)/2,10)},getComponentApproximateCoordinates:function(a){a=a.$view?a:a.$logic;var b=this.getComponentApproximateOffset(a),c=this.isComponentOrParentsFixedPositioned(a),d={width:a.getWidth(),height:a.getHeight()},e=c?{x:0,y:0}:{x:a.$view.ownerDocument.window.pageXOffset,y:a.$view.ownerDocument.window.pageYOffset};return{top:b.top-e.y,left:b.left-e.x,bottom:d.height+b.top-e.y,right:d.width+b.left-e.x,width:d.width,height:d.height}},isComponentOrParentsFixedPositioned:function(a){for(;a;){if(a.isFixedPositioned())return!0;a=a.getParentComponent()}return!1},getComponentApproximateOffset:function(a){for(var b=0,c=0,d=a;a;)b+=parseInt(a.getY(),10),c+=parseInt(a.getX(),10),d=a,a=a.getParentComponent();return c+=(d.$view.ownerDocument.window.innerWidth-d.getWidth())/2,{top:b,left:c}}}}),define.Class("bootstrap.utils.LinkUtils",function(a){var b=a;b.resources(["W.Commands","W.Config"]),b.statics({linkType:{SMS:"SMS",CALL:"CALL",SKYPE:"SKYPE",MAP:"MAP",EMAIL:"EMAIL",FACEBOOK:"FACEBOOK",FLICKR:"FLICKR",BLOGGER:"BLOGGER",MYSPACE:"MYSPACE",LINKEDIN:"LINKEDIN",TWITTER:"TWITTER",TUMBLR:"TUMBLR",YOUTUBE:"YOUTUBE",VIMEO:"VIMEO",PAGE:"PAGE",FREE_LINK:"FREE_LINK",TEXT:"TEXT",DELICIOUS:"DELICIOUS",WEBSITE:"WEBSITE",DOCUMENT:"DOCUMENT",LOGIN:"LOGIN"},linkTarget:{SAME_WINDOW:"_self",NEW_WINDOW:"_blank"}}),b.methods({linkifyElement:function(a,b,c,d){this._fixTargetBug(c);var e=c.get("href"),f=c.get("target"),g=c.get("linkType");if(e&&f||"LOGIN"===g||"ADMIN_LOGIN"===g){if(this._createLink(a,b,g,e,f),this._setLinkState(a),d===!0&&this._disableLinkClickPropagation(b),"LOGIN"===g||"ADMIN_LOGIN"===g){var h=a._highlightedDisplayer.getLogic();this._handleSpecialCases(h,g,b)}}else this._removeLinkstate(a),b.set("href",""),b.setStyle("cursor","default"),b.set("target",""),b.removeEvents("click")},_createLink:function(a,b,c,d,e){var f="_self"===e&&"WEBSITE"===c;this.resources.W.Config.env.isEditorInPreviewMode()&&f?this._bindPageLeaveWarningToLink(a,b):(b.set("href",d),b.setStyle("cursor","pointer"),b.set("target",e),b.removeEvents("click"))},_setLinkState:function(a){a.hasState("noLink","linkableComponent")&&a.removeState("noLink","linkableComponent")},_removeLinkstate:function(a){a.hasState("noLink","linkableComponent")&&a.setState("noLink","linkableComponent")},_fixTargetBug:function(a){var b=a.get("target");("same"==b||"self"==b)&&(b="_self",a.set("target","_self"))},_disableLinkClickPropagation:function(a){a.addEvent("click",function(a){a.stopPropagation()})},_bindPageLeaveWarningToLink:function(a,b){b.erase("href"),b.erase("target"),b.addEvent("click",function(b){b.preventDefault(),this._showNavigationDisabledTooltip(a)}.bind(this))},_showNavigationDisabledTooltip:function(a){var b={component:a};this.resources.W.Commands.executeCommand("linkableComponent.navigateSameWindow",b,a)},_handleSpecialCases:function(a,b,c){switch(c.removeEvents("click"),b){case this.linkType.LOGIN:c.addEvent("click",function(){if(window.animateForm){var a=this.getDataItem(),b=a.get("text");if(b){b=JSON.parse(b);var c=b.postLoginUrl,d=b.postSignupUrl,e=b.type,f="HTML",g=window.userApi?window.userApi.isSessionValid():!1;g?c&&(window.location.href=c):window.animateForm.callOnContent([d,c,e,f])}}}.bind(a));break;case this.linkType.ADMIN_LOGIN:c.setStyle("cursor","pointer"),c.addEvent("click",function(){this.resources.W.Commands.executeCommand("WViewerCommands.AdminLogin.Open")}.bind(a))}}})}),define.utils("LocalStorageUtils",function(){var a=window.localStorage;return{clear:function(){a.clear()},getLength:function(){return a.length},getItem:function(b){if(!b)throw"LocalStorageUtils:: Invalid key provided.";var c=a.getItem(b);return JSON.parse(c)},setItem:function(b,c){if(!b)throw"LocalStorageUtils:: Invalid key provided.";var d=JSON.stringify(c);a.setItem(b,d)},removeItem:function(b){if(!b)throw"LocalStorageUtils:: Invalid key provided.";a.removeItem(b)}}}),define.utils("Math",function(){return{inRange:function(a,b,c){return a>=b&&c>=a},degreesToRadians:function(a){return a*Math.PI/180},radiansToDegrees:function(a){return 180*a/Math.PI},_enforceMinMax:function(a,b,c){return Math.min(Math.max(a,b),c)}}}),define.Class("bootstrap.utils.Que",function(a){"use strict";a.binds(["_next"]),a.methods({initialize:function(a){a=a||{},this.processContext=a.processContext||this,this.active=!1,this.timeoutTicket=null,this.items=a.items||[],this.outputRate=a.outputRate||100,this.outputChunkSize=a.outputChunkSize||1,this.onprocess=null,this.setProcess(a.onprocess)},_next:function(){for(var a=Math.min(this.outputChunkSize,this.size()),b=0;a>b;b++)this.onprocess.call(this.processContext,this.items.shift(),b);this.size()?this.timeoutTicket=setTimeout(this._next,this.outputRate):this.stop()},size:function(){return this.items.length},start:function(){this.active||(this.stop(),this.active=!0,this.timeoutTicket=setTimeout(this._next,this.outputRate))},stop:function(){this.active&&(this.active=!1,clearTimeout(this.timeoutTicket))},clear:function(){this.stop(),this.items.length=0},add:function(){var a=this.items.push;a.apply(this.items,arguments),this.start()},silentAdd:function(){var a=this.items.push;a.apply(this.items,arguments)},addArray:function(){},setProcess:function(a){this.onprocess=a||function(){}}})}),define.Class("bootstrap.utils.Queue",function(a){var b=a;b.methods({initialize:function(){this.map={}},add:function(a,b){this.map[a]=this.map[a]||[],this.map[a].push(b)},addUnique:function(a,b){this.map[a]=this.map[a]||[];for(var c=!0,d=0;d<this.map[a].length;d++)if(this.map[a][d]===b){c=!1;break}c&&this.map[a].push(b)},remove:function(a,b){this.map[a]&&this.map[a].erase(b)},removeKey:function(a){delete this.map[a]},removeAll:function(){this.map={}},getQueue:function(a){return this.map[a]||[]},getQueueKeys:function(){return Object.keys(this.map)},hasQueue:function(a){return a?Object.some(this.map,function(b,c){return c===a})||!1:Object.some(this.map,function(){return!0})},popQueue:function(a){var b=this.getQueue(a);return this.removeKey(a),b},isReady:function(){return!0},clone:function(){return this}})}),define.utils("StringUtils",function(){return{pad:function(a,b,c,d){if(c=c||"0",a+="",a.length>=b)return a;var e=new Array(b-a.length+1).join(c);return d?a+e:e+a},printTable:function(a){var b={};a.forEach(function(a){a.forEach(function(a,c){b[c]=Math.max(b[c]||0,a.length)})});var c,d=this.pad;return a.map(function(a){return c=0,a.map(function(a){return d(a,b[c++]," ",!0)}).join(" ")}).join("\n")}}}),define.utils("Support",function(){return{addMissingHeader:function(){this._addMissingSiteSegment("SITE_HEADER")},addMissingFooter:function(){this._addMissingSiteSegment("SITE_FOOTER")},diagnoseSiteStructure:function(a){var b=[];if(b=b.concat(this._findMissingSiteSegmentsErrors()),b=b.concat(this._findSiteSegmentMislocatedErrors()),a)if(0==b.length)alert("No Errors found in the Site Structure");else{var c="";_(b).forEach(function(a){c+=a.msg+"\n"}),alert(c)}return b},diagnoseAndFixSiteStructure:function(a){for(var b=this.diagnoseSiteStructure(a),c=0;c<b.length;c++){var d=b[c];"SITE_SEGMENT_MISSING"==d.type&&this._addMissingSiteSegment(d.erroneousCompId),"SITE_SEGMENT_MISLOCATED"==d.type&&this._fixSiteSegmentLocation(d.erroneousCompId)}},fixCorruptedTextData:function(){var a=W.Preview.getMultiViewersHandler(),b=a._viewersInfo.DESKTOP.siteStructureSerializer._getSerializedStructure(),c=[];this.mapStructure(b,c),this.validateIds(c)},_addMissingSiteSegment:function(a){W.Classes.getClass("wysiwyg.editor.managers.wedit.MultiSelectProxy",function(b){var c=new b;if(W.Editor.clearSelectedComponent(),"PAGES_CONTAINER"!=a){if(W.Preview.getCompByID(a))return alert("Dude, What the fuck?!? "+a+" already exists!"),void 0;{var d='{"componentType":"wysiwyg.viewer.components.FooterContainer","type":"Container","id":"SITE_FOOTER","styleId":"fc3","skin":"wysiwyg.viewer.skins.screenwidthcontainer.DefaultScreen","layout":{"x":0,"y":1243,"width":980,"height":20,"scale":1,"anchors":[]},"components":[]}',e='{"componentType":"wysiwyg.viewer.components.HeaderContainer","type":"Container","id":"SITE_HEADER","styleId":"hc3","skin":"wysiwyg.viewer.skins.screenwidthcontainer.DefaultScreen","layout":{"x":0,"y":1243,"width":980,"height":20,"scale":1,"anchors":[]},"components":[]}',f="SITE_HEADER"==a?e:d,g=JSON.parse(f);W.Preview.getCompByID("PAGES_CONTAINER").$logic}if("SITE_HEADER"==a){var h=this._getAllSiteStructureComponents();c.setSelectedComps(h),W.Commands.executeCommand("WEditorCommands.SetSelectedCompPositionSize",{y:c.getY()+40,enforceAnchors:!0,editedComponent:c})}var i=W.Preview.getSiteNode();W.CompDeserializer.createAndAddComponents(i,[g],!0,!0,void 0,function(){},!0,!0),setTimeout(function(){var b=this._getBottomYOfSiteStructureComponents(),d="SITE_HEADER"==a?c.getY()-30:b+10;W.Commands.executeCommand("WEditorCommands.SetSelectedCompPositionSize",{y:d,updateLayout:!0}),W.UndoRedoManager.clear()}.bind(this),500)}}.bind(this))},_findMissingSiteSegmentsErrors:function(){var a=[],b=W.Preview.getCompByID("SITE_HEADER"),c=W.Preview.getCompByID("PAGES_CONTAINER"),d=W.Preview.getCompByID("SITE_FOOTER");return b||a.push({msg:"SiteHeader is missing",type:"SITE_SEGMENT_MISSING",erroneousCompId:"SITE_HEADER"}),c||a.push({msg:"Pages Container is missing",type:"SITE_SEGMENT_MISSING",erroneousCompId:"PAGES_CONTAINER"}),d||a.push({msg:"Site Footer is missing",type:"SITE_SEGMENT_MISSING",erroneousCompId:"SITE_FOOTER"}),a},_findSiteSegmentMislocatedErrors:function(){var a=[],b=W.Preview.getCompByID("SITE_HEADER"),c=W.Preview.getCompByID("PAGES_CONTAINER"),d=W.Preview.getCompByID("SITE_FOOTER"),e=b&&b.$logic.getParentComponent().getComponentId(),f=c&&c.$logic.getParentComponent().getComponentId(),g=d&&d.$logic.getParentComponent().getComponentId();return e&&"SITE_STRUCTURE"!==e&&a.push({msg:"Header is inside "+e+" instead of SITE_STRUCTURE",type:"SITE_SEGMENT_MISLOCATED",erroneousCompId:"SITE_HEADER"}),f&&"SITE_STRUCTURE"!==f&&a.push({msg:"PagesContainer is inside "+f+" instead of SITE_STRUCTURE",type:"SITE_SEGMENT_MISLOCATED",erroneousCompId:"PAGES_CONTAINER"}),g&&"SITE_STRUCTURE"!==g&&a.push({msg:"Footer is inside "+g+" instead of SITE_STRUCTURE",type:"SITE_SEGMENT_MISLOCATED",erroneousCompId:"SITE_FOOTER"}),a},_getBottomYOfSiteStructureComponents:function(){for(var a=this._getAllSiteStructureComponents(),b=0,c=0;c<a.length;c++)b=Math.max(b,a[c].getY()+a[c].getPhysicalHeight());return b},_getAllSiteStructureComponents:function(){return W.Preview.getSiteNode().$logic.getChildren().map(function(a){return a.$logic})},_fixSiteSegmentLocation:function(a){W.Classes.getClass("wysiwyg.editor.managers.wedit.MultiSelectProxy",function(b){var c=new b;W.Editor.clearSelectedComponent();var d=W.Preview.getCompByID(a).$logic,e=d.getPhysicalHeight(),f=W.Preview.getSiteNode().$logic,g=[];switch(a){case"SITE_HEADER":g=this._getAllSiteStructureComponents();break;case"SITE_FOOTER":break;case"PAGES_CONTAINER":var h=W.Preview.getCompByID("SITE_FOOTER").$logic.getY();g=this._getAllSiteStructureComponents().filter(function(a){return a.getY()>=h})}c.setSelectedComps(g);var i;"SITE_FOOTER"==a?i=this._getBottomYOfSiteStructureComponents()+10:(i=c.getY(),W.Commands.executeCommand("WEditorCommands.SetSelectedCompPositionSize",{y:c.getY()+e+10,enforceAnchors:!0,editedComponent:c})),f.addChild(d),W.Commands.executeCommand("WEditorCommands.SetSelectedCompPositionSize",{y:i,updateLayout:!0,editedComponent:d}),W.UndoRedoManager.clear()}.bind(this))},mapRecurse:function(a,b){var c=a.children||a.components;if(c)for(var d=0;d<c.length;d++)this.mapRecurse(c[d],b);a.id&&b.push(a.id)},mapStructure:function(a,b){this.mapRecurse(a.masterPage,b);for(var c in a.pages)this.mapRecurse(a.pages[c],b)},getNodesById:function(a){var b=W.Preview.getIFrame().contentWindow.document;return b.querySelectorAll("[id="+a+"]")},validateIds:function(a){for(var b=!1,c=0;c<a.length;c++){var d=a[c],e=this.getNodesById(d);if(e.length>1)for(var f=0;f<e.length;f++)for(var g=e[f],h=g.getParents(),i=0;i<h.length;i++){var j=h[i];if("wysiwyg.viewer.components.WRichText"===j.getAttribute("comp")&&j.$logic&&"wysiwyg.viewer.components.WRichText"===j.$logic.$className){var k=W.Preview.getPreviewManagers().Data.getDataByQuery(j.getAttribute("dataquery")),l=k.get("text"),m=l.replace(/(id|skin|comp|dataquery|propertyquery)\s*=\s*["'].*?["']/gi,"");k.set("text",m),b=!0}}}b?alert("No data was fixed"):alert("Some components were fixed")},isTextStyleValid:function(){W.Theme.getStyle("txtNew",function(a){var b=console._oldConsole?window.console._oldConsole:window.console;"wysiwyg.viewer.skins.WRichTextSkin"===a.getSkin()?b.log("false"):b.log("true")})},fixTextStyle:function(){W.Theme.getStyle("txtNew",function(a){if("wysiwyg.viewer.skins.WRichTextSkin"===a.getSkin()){var b=a;W.Skins.getSkin("wysiwyg.viewer.skins.WRichTextNewSkin",function(a){b.setSkin(a)})}})}}}),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),define.Class("bootstrap.utils.Tween",function(a){var b=a;b.statics({_activeTweens:[],killAll:function(){for(;this._activeTweens.length>0;)this.killTween(this._activeTweens[0])},killTweensOf:function(a){var b=[];this._activeTweens.forEach(function(c){c._target===a&&b.push(c)}),b.forEach(function(a){"function"==typeof this.killTween&&this.killTween(a)})},killTween:function(a){var b;a.dispose(),b=this._activeTweens.indexOf(a),-1!=b&&this._activeTweens.splice(b,1)},_startTween:function(){this.killTweensOf(this._target),this._activeTweens.push(this),this._t0=this._getCurrentTime(),window.requestAnimFrame(this._render.bind(this))},debugMode:!1,log:function(){},to:function(a,b,c){{var d=this;new d(a,b,c)}},execute:function(a,b,c,d){d.myProp=b;{var e=this;new e({myProp:a},c,d)}}}),b.methods({initialize:function(a,b,c){var d,e;this._target=a,this._duration=Math.floor(1e3*b),this._easeParams=[],this._t=0,this._tStep=null,this._isAlive=!0;var f="element"==typeOf(a);this._setValueFunc=f?this._setStyle:this._setTargetProperty,this._easeFunc=this.linear;var g=this._parseParameter(c,"ease","linear");void 0!==this[g]&&"function"==typeOf(this[g])&&(this._easeFunc=this[g]),this._onCompleteCallback=this._parseParameter(c,"onComplete",null),this._onUpdateCallback=this._parseParameter(c,"onUpdate",null);var h=this._parseParameter(c,"delay",0);for(var i in c)(f||void 0!==a[i])&&(d={},d.propName=i,f?(e=a.getStyle(i),d.origValue=parseFloat(e),d.unit=this._parseUnit(e),isNaN(d.origValue)&&(d.origValue=0,d.unit="px")):d.origValue=parseFloat(a[i]),d.targetValue=parseFloat(c[i]),this._easeParams.push(d));0===h?this._startTween():(h=parseInt(1e3*h,10),setTimeout(this._startTween.bind(this),h))},_parseUnit:function(a){var b=/[^0-9-]+$/;return b.test(a)===!0?String(String(a).match(b)[0]):""},_parseParameter:function(a,b,c){var d;return void 0!==a[b]?(d=a[b],delete a[b]):d=c,d},_render:function(){var a,b;if(this._isAlive){var c=this._getCurrentTime();this._tStep=c-this._t0,this._t0=c,this._t+=this._tStep;for(var d=0;d<this._easeParams.length;d++)a=this._easeParams[d],b=this._t<this._duration?this._easeFunc(this._t,0,1,this._duration)*(a.targetValue-a.origValue)+a.origValue:a.targetValue,this.debugMode===!0&&this.log(this._tStep,this._t,b),a.unit&&"px"==a.unit&&(b=Math.round(b)),this._setValueFunc(a.propName,b,a.unit),null!==this._onUpdateCallback&&this._onUpdateCallback(b,this._target,a.propName);this._t<this._duration?window.requestAnimFrame(this._render.bind(this)):(null!==this._onCompleteCallback&&this._onCompleteCallback(this),this.killTween(this))}},_getCurrentTime:function(){return(new Date).getTime()},_setStyle:function(a,b,c){this._target.setStyle(a,String(b)+c)},_setTargetProperty:function(a,b){this._target[a]=b},dispose:function(){this._isAlive=!1,this._target=null,this._onCompleteCallback=null,this._onUpdateCallback=null},linear:function(a,b,c,d){return c*a/d+b},strong_easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},strong_easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},strong_easeInOut:function(a,b,c,d){return(a/=.5*d)<1?.5*c*a*a*a*a*a+b:.5*c*((a-=2)*a*a*a*a+2)+b},swing:function(a,b,c,d){return-Math.cos(this.linear(a,b,c,d)*Math.PI)/2+.5}})}),define.bootstrapClass("bootstrap.utils.Utils",function(){function a(){}return a.extendPrototype({init:function(){var a=this;this._mergeDefinitions(),this.define.utils.definitionModifier=function(b,c){a._mergeDefinition(b,c)},this._prefixCounterMap={}},_mergeDefinitions:function(){var a=this.define.getDefinition("utils");for(var b in a)this._mergeDefinition(b,a[b])},_mergeDefinition:function(b,c){"this"===b.split(":").pop()?a.extendPrototype(c()):this._mergeToUtils(b,c)},_mergeToUtils:function(b,c){var d=c(),e={};e[b]=d,a.extendPrototype(e)},clone:function(){return this},isReady:function(){return!0}}),a}),define.bootstrapClass("bootstrap.utils.async.Async",function(){var a=define.getBootstrapClass("bootstrap.bootstrap.WClass"),b=new a({className:"Async",initialize:function(){}});return b.Bulk=new a({className:"Async.Bulk",_fields_:{_traits_:[Options,Events],_binds_:["run"],options:{completeEvent:"complete",errorEvent:"error",completeCallback:null,errorCallback:null,parallel:!0,specialTargets:[{target:null,method:null,completeEvent:null,errorEvent:null}],executeDelay:!1,keepAlive:!1,stopOnErrors:!0,timeout:0}},_methods_:{initialize:function(a,b,c){if(this._method=null,this._pending=[],this._running=!1,this._error=[],this._complete=[],this._done=[],!a||void 0===a.length)return LOG.reportError(wixErrors.BULK_INVALID_TARGET,"Async.Bulk","initialize",a)(),this;this.$events={},this.setOptions(c),this._targets=a,this._method=b;var d=this,e=window;this.options.timeout>0&&(this._timeoutInterval=e.setTimeout(this._bulkOperationTimeout.bind(this),this.options.timeout)),this._onTargetComplete=function(){this.removeEvent(d._getTargetDetails(this).completeEvent,d._onTargetComplete),d._pending.erase(this),d._complete.push(this),d._done.push(this),d._checkProgress()},this._onTargetFailed=function(){this.removeEvent(d._getTargetDetails(this).errorEvent,d._onTargetFailed),d._pending.erase(this),d._error.push(this),d._done.push(this),d._checkProgress()},this.options.executeDelay?instanceOf(this.options.executeDelay,Number)&&this.options.executeDelay>0&&e.setTimeout(this.run,this.options.executeDelay):this.run()},_bulkOperationTimeout:function(){LOG.reportError(wixErrors.BULK_TIMEOUT,"Async.Bulk","_bulkOperationTimeout",String(this.options.timeout)+" ms | Pending Operations:"+this._pending)()},run:function(){return void 0!==this._targets.length&&null!==this._targets.length&&0===this._targets.length?(this._clearInterval(),this._handleBulkComplete(),void 0):(this._targets.each(function(a,b){this._addToQue(a,b)},this),this.options.parallel?this._targets.each(this._runMethodOnTarget,this):this._runNextTarget(),void 0)},_runNextTarget:function(){var a=this._targets.length-this._pending.length,b=this._targets[a];this._runMethodOnTarget.apply(this,[b])},_clearInterval:function(){this._timeoutInterval&&(clearInterval(this._timeoutInterval),delete this._timeoutInterval)},_runMethodOnTarget:function(a){instanceOf(this._method,Function)&&this._method.call(a),instanceOf(this._method,String)&&(instanceOf(a[this._method],Function)?a[this._method].call(a):LOG.reportError(wixErrors.BULK_NO_METHOD,"Async.Bulk","_runMethodOnTarget",a)())},stop:function(){},destroy:function(){this._targets&&this._targets.each(function(a){a.removeEvent(this._getTargetDetails(this).completeEvent,this._onTargetComplete),a.removeEvent(this._getTargetDetails(this).errorEvent,this._onTargetFailed)},this),this._targets=null},progress:function(){return{complete:this._complete.slice(),error:this._error.slice(),total:this._targets.slice()}},_addToQue:function(a,b){var c=this._getTargetDetails(a);this._pending[b]=a,a.addEvent(c.completeEvent,this._onTargetComplete),a.addEvent(c.errorEvent,this._onTargetFailed)},_onTargetComplete:void 0,_onTargetFailed:void 0,_getTargetDetails:function(a){var b,c,d={method:this._method,completeEvent:this.options.completeEvent,errorEvent:this.options.errorEvent};for(b=0,c=this.options.specialTargets.length;c>b;b++)if(this.options.specialTargets[b].target===a)return this.options.specialTargets[b].target.implement(d);return d},_checkProgress:function(){this._pending.length>0?this.options.parallel||this._runNextTarget():(this.options.stopOnErrors&&this._error.length>0?this._handleBulkError():this._handleBulkComplete(),this._clearInterval(),this.options.keepAlive||this.destroy())},_handleBulkError:function(a){a?(this.fireEvent("error",[this._complete,this._error]),instanceOf(this.options.errorCallback,Function)&&this.options.errorCallback(this._complete,this._error)):window.setTimeout(this._handleBulkError.bind(this,!0),1)},_handleBulkComplete:function(a){a?(this.fireEvent("complete",[this._complete,this._error]),instanceOf(this.options.completeCallback,Function)&&this.options.completeCallback(this._complete,this._error)):window.setTimeout(this._handleBulkComplete.bind(this,!0),1)},setOptions:function(){var a=this.options=Object.merge.apply(null,[{},this.options].append(arguments));if(!this.addEvent)return this;for(var b in a)"function"==typeOf(a[b])&&/^on[A-Z]/.test(b)&&(this.addEvent(b,a[b]),delete a[b]);return this},fireEvent:function(a,b,c){if(this.$events){a=this._removeOn(a);var d=this.$events[a];if(!d)return this;b=Array.from(b);var e=d.clone();e.each(function(a){a&&(c?a.delay(c,this,b):a.apply(this,b))},this)}return this},addEvent:function(a,b){return a=this._removeOn(a),this.$events=this.$events||{},this.$events[a]=(this.$events[a]||[]).include(b),this},_removeOn:function(a){return a.replace(/^on([A-Z])/,function(a,b){return b.toLowerCase()})}}}),b}),define.utils("analytics:this",function(){return{_sendURLtoGoogleAnalytics:function(a,b){a._trackPageview(b)},_getGoogleAnalyticsTracker:function(a){return window._gat?(pageTracker=_gat._getTracker(a),pageTracker._initData(),pageTracker):void 0},reportSiteAnalytics:function(a,b){var c="UA-2117194-25",d="site",e=d+"/"+a;b&&(e=e+"/"+b),this.sendToGoogleAnalytics(e,c)},reportEditorAnalytics:function(a,b){var c="UA-2117194-23",d="editor",e=d+"/"+a;b&&(e=e+"/"+b),window.siteHeader&&(window.siteHeader.username&&(e=e+"/"+siteHeader.username),window.siteHeader.siteName&&(e=e+"/"+siteHeader.siteName)),this.sendToGoogleAnalytics(e,c)},sendToGoogleAnalytics:function(a,b){try{if(window._gat){var c=this._getGoogleAnalyticsTracker(b);return this._sendURLtoGoogleAnalytics(c,a,b),void 0}var d="https:"==document.location.protocol?"https://ssl.":"http://www.",e=new Element("script",{id:"googleAnalyticsScript"}),f=document.getElementsByTagName("script")[0];e.type="text/javascript",f.parentNode.insertBefore(e,f),e.src=d+"google-analytics.com/ga.js",this.gaCheck(a,b)}catch(g){}},gaCheck:function(a,b){try{if(window._gat){var c=this._getGoogleAnalyticsTracker(b);this._sendURLtoGoogleAnalytics(c,a)}else setTimeout(this.gaCheck.bind(this,a,b),1e3)}catch(d){}}}}),define.utils("browser:this",function(){return{show:function(a){$(a).uncollapse()},hide:function(a){$(a).collapse()},setChildIndex:function(a,b,c){var d=a.getChildren(),e=d[b],f=d[c];e==f&&e.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM),e&&f&&(e.inject(f,b>c?"before":"after"),e.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM),f.fireEvent(Constants.DisplayEvents.MOVED_IN_DOM,Constants.DisplayEvents.MOVED_IN_DOM))},waitForElement:function(a,b,c,d){var e=0,f=c/b,g=setInterval(function(){e++,e>f&&(clearInterval(g),d(!1));var b=$$(a).length;b>0&&(clearInterval(g),d(!0))},b)},getComputedStyle:function(a){return window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle
},_htmlTextReplacements:[["<","&lt;"],[">","&gt;"]],convertToHtmlText:function(a){a=a.toString();for(var b=0;b<this._htmlTextReplacements.length;++b)for(var c=this._htmlTextReplacements[b][0],d=this._htmlTextReplacements[b][1];-1!=a.indexOf(c);)a=a.replace(c,d);return a},getWindowSize:function(a){var b,c;if("undefined"==typeof window.innerWidth||a)if("undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth)b=document.documentElement.clientWidth,c=document.documentElement.clientHeight;else{var d=document.getElementsByTagName("body")[0];b=d.clientWidth,c=d.clientHeight}else b=window.innerWidth,c=window.innerHeight;return{width:b,height:c}},getPositionRelativeToWindow:function(a){if("element"!==typeOf(a))return{x:0,y:0};if(!$$(a).length)return{x:0,y:0};var b=$$(a)[0],c=b.getPosition(),d=window.getScroll();return c.x-=d.x,c.y-=d.y,c},getMidPos:function(a,b,c){var d,e,f,g,h=window.getSize(),i=h.x,j=h.y;c.page?(d=c.page.x,e=c.page.y,f=c.client.x+a,g=c.client.y+b):(d=c.pageX,e=c.pageY,f=c.clientX+a,g=c.clientY+b);var k=f>=i?d-(f-i):d,l=g>=j?e-(g-j):e;return{x:k,y:l}},getCSSBrowserFeature:function(a){var b=Modernizr.prefixed(a.camelCase());return b?b.replace(/([A-Z])/g,function(a,b){return"-"+b.toLowerCase()}).replace(/^ms-/,"-ms-"):!1},getIsSibling:function(a,b){return a&&b&&a.getParent()===b.getParent()},iframeCallback:0,prepareIFrameForWrite:function(a,b){try{var c=a.contentWindow.document||a.contentWindow.document;b(a,c)}catch(d){var e="tmp"+this.iframeCallback++;W[e]=function(){var c=a.contentDocument||a.contentWindow.document;b(a,c)},a.src="javascript:(function () {document.open();document.domain='"+encodeURIComponent(document.domain)+"';document.close()})();";var c=a.contentDocument||a.contentWindow.document;b(a,c)}},forceBrowserRepaint:function(a,b,c){c=c||["safari"];var d=!1,e=0;for(e;e<c.length;e++)if(Browser[c[e]]){d=!0;break}d&&(a=a||$$("body"),b=b||150,a.setStyle("opacity",.99),setTimeout(function(){a.setStyle("opacity",1)},b))},stopMouseWheelPropagation:function(a){a=a||{};var b=this.getStyle("border-width").split(" "),c=parseInt(b[0])+parseInt(b[2]),d=this.getSize().y;(this.scrollTop-(this.scrollHeight-d)===c&&a.wheel<0||0===this.scrollTop&&a.wheel>0)&&a.preventDefault()},preventMouseDownOn:function(a){a.addEvent("mousedown",W.Utils._stopEventPropagation),a.addEvent("mouseup",W.Utils._resumeMouseDownEventPropagation(a))},_stopEventPropagation:function(a){a&&a.stopPropagation()},_resumeMouseDownEventPropagation:function(a){var b=this;return function(){a&&a.removeEvent("mousedown",b.stopMouseDownEventPropagation)}},requestAnimFrame:function(){},isEnterKey:function(a){return a&&13===a?!0:!1},isInputKey:function(a){return a?48>a?13==a||32==a||8==a||46==a:a>=112&&145>=a?!1:a>90&&93>=a?!1:!0:!1},serverRequest:function(a,b,c,d,e){var f="",g=new Request.JSON({url:f+a,onSuccess:d,onFailure:e});"post"==b?g.post(c):g.get(c)},freezeScroll:function(a){if(!window.isScrollFrozen){var b=window.getScroll().y,c=document.onscroll;this.callLater(function(){document.onscroll=c,window.isScrollFrozen=!1},null,null,a||500),window.isScrollFrozen=!0,document.onscroll=function(a){var c=window.getScroll().y;return b!=c&&window.scrollTo(0,b),a.preventDefault(),!1}}},getBrowserLanguage:function(){return window.navigator.userLanguage||window.navigator.language},getCountryCode:function(){var a=window.editorModel&&window.editorModel.geo||window.rendererModel&&window.rendererModel.geo;return a},getInternetExplorerVersion:function(){var a,b,c=-1;return"Microsoft Internet Explorer"===navigator.appName?(a=navigator.userAgent,b=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),null!==b.exec(a)&&(c=parseFloat(RegExp.$1))):"Netscape"===navigator.appName&&(a=navigator.userAgent,b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),null!==b.exec(a)&&(c=parseFloat(RegExp.$1))),c},isIE:function(){return Browser.ie||-1!==this.getInternetExplorerVersion()}}}),function(){var a="undefined"!=typeof window?window:exports,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=function(){try{document.createElement("$")}catch(a){return a}}();a.btoa||(a.btoa=function(a){for(var d,e,f=0,g=b,h="";a.charAt(0|f)||(g="=")&&f%1;h+=g.charAt(63&d>>8-f%1*8)){if(e=a.charCodeAt(f+=.75),e>255)throw c;d=d<<8|e}return h}),a.atob||(a.atob=function(a){if(a=a.replace(/=+$/,""),a.length%4==1)throw c;for(var d,e,f=0,g=0,h="";e=a.charAt(g++);~e&&(d=f%4?64*d+e:e,f++%4)?h+=String.fromCharCode(255&d>>(-2*f&6)):0)e=b.indexOf(e);return h})}(),define.utils("cookies",function(){"use strict";return{createCookie:function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+c),d="; expires="+e.toGMTString()}document.cookie=a+"="+b+d+"; path=/"},deleteCookie:function(a){document.cookie=a+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/"},hasCookie:function(a){return null!==this.readCookie(a)},readCookie:function(a){var b=document.cookie.match(new RegExp("\\b"+a+"=(.*?)(;|$)"));return b?b[1]:null}}}),define.utils("debug:this",function(){return{getStackTrace:function(a){a=!isNaN(a)&&a>0?a:1;var b=new Error,c="(no stack)";b.stack?c=b.stack:window.opera&&b.message&&(c=b.message),c=c.split("[object Object]").join("{}"),c=c.split("[object Array]").join("[]"),c=c.replace(/at/g,""),c=c.split(window.serviceTopology.scriptsLocationMap.web+"/javascript/").join("");var d=c.split("\n");return"error"==d[0].toLowerCase()&&a++,d=d.splice(a),d.join("<<").replace(/\s{2,}/g," ")}}}),define.utils("Url",function(){return{getSearchParamString:function(a){return a=a||window,a.location.search}}}),define.utils("Validation:this",function(){return{isObjectEmpty:function(a){return Object.some(a,function(){return!0})},isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isURLPartValid:function(a){return/[^a-z_0-9]/.test(a)===!1&&a.length>=4},convertToValidUrlPart:function(a){return a.replace(/[ ]/g,"-").replace(/[^A-Za-z0-9-]/g,"").toLowerCase()},isValidUrl:function(a){return 0===a.indexOf(".")&&(a=this._rel_to_abs(a)),this._RegEx.validUrlReg.test(a.replace(/\s/g,"%20"))},_rel_to_abs:function(a){if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(a))return a;var b=location.href.match(/^(.+)\/?(?:#.+)?$/)[0]+"/";if("//"==a.substring(0,2))return location.protocol+a;if("/"==a.charAt(0))return location.protocol+"//"+location.host+a;if("./"==a.substring(0,2))a="."+a;else{if(/^\s*$/.test(a))return"";a="../"+a}a=b+a;for(;/\/\.\.\//.test(a=a.replace(/[^\/]+\/+\.\.\//g,"")););return a=a.replace(/\.$/,"").replace(/\/\./g,"").replace(/"/g,"%22").replace(/'/g,"%27").replace(/</g,"%3C").replace(/>/g,"%3E")},isValidEmail:function(a){return this._RegEx.validEmailReg.test(a)},isValidTwitterUser:function(a){return this._RegEx.ValidTwitterUserReg.test(a)},validatePageTitle:function(a){var b=a;if(b=b.replace(/[^A-Za-z0-9_ ]/g,""),0===b.indexOf(" "))for(;0===b.indexOf(" ");)b=b.substr(1);if(b.indexOf("  ")>-1)for(;b.indexOf("  ")>-1;)b=b.replace("  "," ");return b=b.substr(0,Constants.Page.NAME_MAX_LENGTH),""===b&&(b="untitled"),b},isInputKey:function(a){return a?48>a?13==a||32==a||8==a||46==a:a>=112&&145>=a?!1:a>90&&93>=a?!1:!0:!1},isEquivalent:function(a,b){if(typeof a!=typeof b)return!1;if(a instanceof Array&&!(b instanceof Array))return!1;if("function"===(typeof a&&typeof b))return!0;if("string"==typeof a||"number"==typeof a||"boolean"==typeof a)return a===b;if(!!a!=!!b)return!1;var c=0,d=a instanceof Array;if(d){var e=function(a,c){return W.Utils.isEquivalent(a,b[c])};return a.length==b.length&&a.every(e,b)}for(var f in a){if(a.hasOwnProperty(f)&&!b.hasOwnProperty(f))return!1;++c}for(f in b)b.hasOwnProperty(f)&&c--;if(0!==c)return!1;for(f in a)if(a.hasOwnProperty(f)&&!this.isEquivalent(a[f],b[f]))return!1;return!0},_RegEx:{validUrlReg:/^(?:(?:ftps?|https?):\/\/)?(?:(?:[\u0400-\uA69F\w][\u0400-\uA69F\w-]*)?[\u0400-\uA69F\w]\.)+(?:[\u0400-\uA69Fa-z]+|\d{1,3})(?::[\d]{1,5})?(?:[/?#].*)?$/i,validEmailReg:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,ValidTwitterUserReg:/^@?[a-zA-Z0-9_%]+$/}}}),define.utils("ComponentIcon",function(){return{getIconProperties:function(a){var b,c={x:0,y:0},d={width:22,height:22,x:22,y:22},e=W.Editor.getComponentMetaData(a)||{};return e.mobile&&e.mobile.previewImageDataRefField?b=this._getImageSrc(e.mobile.previewImageDataRefField,a,d):(b=this._iconsMapData.src,c=this._getSpriteOffsetFromMap(a.$className)),{iconSrc:b,iconSize:d,spriteOffset:c}},_getSpriteOffsetFromMap:function(a){var b=this._iconsMapData.spriteOffsets;return a in b?b[a]:b["default"]},_getImageSrc:function(a,b,c){var d,e,f,g,h,i=W.Preview.getPreviewManagers().Data,j=new(W.Classes.getClass("core.components.image.ImageUrlNew"));if("*"===a?f=b.getDataItem():(g=b.getDataItem().get(a),f=i.getDataByQuery(g)),f&&"ImageList"===f.get("type"))g=f.get("items")[0],f=i.getDataByQuery(g);else if(!f||"Image"!==f.get("type"))throw new Error("item is not of type Image");return e=f.get("uri"),d={x:f.get("width"),y:f.get("height")},h=j.getImageUrlExactSize(c,e,d)},_iconsMapData:{src:"mobile/hidden_elements_icons_sprite.png",spriteOffsets:{"default":{x:0,y:0},"wysiwyg.viewer.components.WRichText":{x:0,y:-23},"wysiwyg.viewer.components.WPhoto":{x:-30,y:0},"wysiwyg.viewer.components.MatrixGallery":{x:-60,y:0},"wysiwyg.viewer.components.SlideShowGallery":{x:-60,y:0},"wysiwyg.viewer.components.SliderGallery":{x:-60,y:0},"wysiwyg.viewer.components.PaginatedGridGallery":{x:-60,y:0},"wysiwyg.viewer.components.Video":{x:-90,y:0},"wysiwyg.viewer.components.SoundCloudWidget":{x:-90,y:-23},"wysiwyg.viewer.components.AudioPlayer":{x:-90,y:-23},"wysiwyg.viewer.components.ClipArt":{x:-120,y:0},"core.components.Container":{x:-120,y:-23},"wysiwyg.viewer.components.ScreenWidthContainer":{x:-120,y:-46},"wysiwyg.viewer.components.BgImageStrip":{x:-120,y:-46},"wysiwyg.viewer.components.VerticalLine":{x:-120,y:-69},"wysiwyg.viewer.components.FiveGridLine":{x:-120,y:-92},"wysiwyg.viewer.components.svgshape.SvgShape":{x:-120,y:-115},"wysiwyg.viewer.components.SiteButton":{x:-150,y:0},"wysiwyg.viewer.components.menus.DropDownMenu":{x:-150,y:-23},"wysiwyg.viewer.components.HorizontalMenu":{x:-150,y:-23},"wysiwyg.viewer.components.mobile.TinyMenu":{x:-150,y:-23},"wysiwyg.viewer.components.WFacebookLike":{x:-240,y:0},"wysiwyg.common.components.facebooklikebox.viewer.FacebookLikeBox":{x:-240,y:0},"wysiwyg.viewer.components.WFacebookComment":{x:-240,y:-23},"wysiwyg.viewer.components.FacebookShare":{x:-240,y:-23},"wysiwyg.viewer.components.WTwitterFollow":{x:-240,y:-46},"wysiwyg.viewer.components.WTwitterTweet":{x:-240,y:-46},"wysiwyg.viewer.components.TwitterFeed":{x:-240,y:-46},"wysiwyg.viewer.components.WGooglePlusOne":{x:-240,y:-69},"wysiwyg.viewer.components.LinkBar":{x:-240,y:-92},"tpa.viewer.components.TPASection":{x:-270,y:0},"tpa.viewer.components.TPAWidget":{x:-270,y:0},"tpa.viewer.components.TPAFixedWidget":{x:-270,y:0},"tpa.viewer.components.TPAGallery":{x:-270,y:0},"tpa.viewer.components.TPAComponent":{x:-270,y:0},"wysiwyg.viewer.components.ContactForm":{x:-270,y:-23},"wysiwyg.viewer.components.GoogleMap":{x:-270,y:-46},"wysiwyg.viewer.components.HtmlComponent":{x:-270,y:-69},"wysiwyg.viewer.components.FlashComponent":{x:-270,y:-92},"wysiwyg.viewer.components.PayPalButton":{x:-270,y:0},"wysiwyg.viewer.components.FlickrBadgeWidget":{x:-270,y:0},"wysiwyg.viewer.components.EbayItemsBySeller":{x:-270,y:0},"wysiwyg.viewer.components.EbayItemBadge":{x:-270,y:0},"wysiwyg.viewer.components.AdminLogin":{x:-270,y:-115},"wysiwyg.viewer.components.AdminLoginButton":{x:-270,y:-115},"wysiwyg.viewer.components.LoginButton":{x:-270,y:-138},"wixapps.integration.components.AppPart":{x:-300,y:0},"wixapps.integration.components.AppPart2":{x:-300,y:0},"wysiwyg.viewer.components.HeaderContainer":{x:-330,y:0},"wysiwyg.viewer.components.FooterContainer":{x:-330,y:-23},"wysiwyg.viewer.components.PagesContainer":{x:-330,y:-46}}}}}),define.utils("editorUtils:this",function(){return{getAddPageTemplateFromMainPage:function(a,b,c){return this.getAddPageTemplateFromPage("mainPage",a,b,c)},getAddPageTemplateFromCurrentPage:function(a,b,c){return this.getAddPageTemplateFromPage(W.Preview.getPreviewManagers().Viewer.getCurrentPageId(),a,b,c)},getAddPageTemplateFromPage:function(a,b,c,d){c=c||"";var e=W.Preview.getHtmlElement(a).getLogic(),f="ADD_PAGE_"+b.toUpperCase()+"_GROUPNAME",g="ADD_PAGE_"+b.toUpperCase()+c+"_NAME",h="ADD_PAGE_"+b.toUpperCase()+c+"_DESCRIPTION",i=W.ClipBoard.copyComponent(e);i=this._handleWixAppsComponents(i);var j={group:f,name:g,applicationType:d||Constants.WEditManager.SITE_TYPE_WEB,previewPic:b.toLowerCase()+c+".png",pageDescription:h,serializedPageData:i},k=JSON.encode(j);return k=k.replace(/\\\"/g,"\\'")},_handleWixAppsComponents:function(a){var b=W.Preview.getPreviewManagers().Viewer.getAppDataHandler();return a.components&&a.components.each(function(a){if("wixapps.integration.components.AppPart"==a.componentType){var c=a.data,d=c.appInnerID,e=b.getAppData(d);c.appInnerID=e.appDefinitionId;var f=c.appLogicParams;f&&f.hasOwnProperty("categoryId")&&(f.categoryId.value="defaultCategory")}else a.hasOwnProperty("components")&&this._handleWixAppsComponents(a)}.bind(this)),a},openSidePanel:function(a,b){var c=window.$$('[comp="'+a+'"]')[0],d=c&&c.getLogic().getIsDisplayed();return d?!1:(this._handleOpenSidePanelOnEditorUIRefactor(),W.Commands.executeCommand(b),!0)},_handleOpenSidePanelOnEditorUIRefactor:function(){var a=W.Editor.getEditorUI();a.updateBreadcrumbState()}}}),define.Class("bootstrap.utils.Hash",function(a){var b=a;b.inherits("bootstrap.utils.Events"),b.resources(["W.Utils","W.Experiments"]),b.fields({intervalId:0}),b.methods({initialize:function(){this._flags={},this._storedHashObject=this.getHashObject(window.location.hash),"onhashchange"in window&&!Browser.ie8?window.onhashchange=function(){this._onHashChange()}.bind(this):(clearInterval(this.intervalId),this._oldHref=window.location.href,this.intervalId=window.setInterval(function(){this._onHashChange()}.bind(this),100))},fireHashChangeEvent:function(a){a||Browser&&Browser.ie8?this._onHashChange("force change"):this._onHashChange()},_onHashChange:function(a){var b=window.location.href;if(a||this._oldHref!==b){this._oldHref=b,this.fireEvent("browserChange",window.location.hash);var c=this._flags.isChangeFromSetHash,d=this._flags.silent;this._resetHashChangeFlags(),this._handleHashChange(a,c,d)}},_resetHashChangeFlags:function(){for(var a in this._flags)Object.hasOwnProperty.call(this._flags,a)&&Object.propertyIsEnumerable.call(this._flags,a)&&(this._flags[a]=!1)},_setHashChangeFlags:function(a){for(var b in a)Object.hasOwnProperty.call(a,b)&&Object.propertyIsEnumerable.call(a,b)&&(this._flags[b]=a[b])},_handleHashChange:function(a,b,c){var d=this.getHashObject(),e=this._storedHashObject.id!==d.id,f=this._storedHashObject.extData!==d.extData;if("force change"===a&&(e=!0,f=!!d.extData),b||d.extData||d.id!==this._getHomePageId()||this._replaceHistoryState(d),e||f){this._storedHashObject=d;var g={isIdChanged:e,isExtraDataChanged:f,silent:!!c,isForSureAfterChange:!0,isChangeFromSetHash:!1,extData:d.extData,newHash:d.id};this.fireEvent("change",g)}},getHash:function(){var a=window.location.hash;a=unescape(a);var b=this.getHashParts(a);return b.id},getHashObject:function(a){return a=a||window.location.hash,this.getHashParts(a)},getHashParts:function(a){a=a||window.location.hash;var b="|",c="/",d="/",e=a,f="",g="";a.length>1&&"#!"==a.substr(0,2)?e=a.substr(2):"#"==a.charAt(0)&&(e=a.substr(1));var h=e.indexOf(c),i=e.indexOf(b),j=c;(-1!=i&&h>i||i>-1&&-1==h)&&(j=b);var k=e.indexOf(j);return k>-1&&(f=e.substr(0,k),e=e.substr(k+1)),k=e.indexOf(d),k>-1&&(g=e.substr(k+1),e=e.substr(0,k)),{id:e?e:"",title:f?f:"",extData:g?g:""}},getHashStringFromObject:function(a){return this.getHashPartsString(a.id,a.title,a.extData)},getHashPartsString:function(a,b,c){var d="/",e="";return b&&(e=b.replace(/([^\s\w\d_-])/g,"").replace(/\s+/g,"-")),e+=d+a,c&&(e+=d+c),e},_getNormalizedHashStringFromObject:function(a){var b=a.id===this._getHomePageId();return!b||a.extData?this.getHashStringFromObject(a):""},_getNormalizedHashString:function(a,b,c,d){var e=a===d;return e&&!c?"":"!"+this.getHashPartsString(a,b,c)},replaceState:function(a){this._replaceHistoryState(a)},_replaceHistoryState:function(a){if(this._isHistoryApiAvailable()){var b=this._getNormalizedHashStringFromObject(a);b&&(b="#!"+b),history.replaceState({},a.title,window.location.pathname+window.location.search+b)}},setHash:function(a,b,c,d){b=b||"untitled";var e=this._getHomePageId(),f=this._getNormalizedHashString(a,b,c,e),g=window.location.hash.replace(/^[#]/,"");if(f!==g){var h=this._storedHashObject.id!==a,i=this._storedHashObject.extData!==c;this._setHashChangeFlags({silent:!!d}),this.fireEvent("change",{newHash:a,isForSureAfterChange:!1,extData:c,isExtraDataChanged:i,isIdChanged:h,silent:!!d}),_.defer(function(a){this._setHashChangeFlags({isChangeFromSetHash:!0}),window.location.hash=a,""===a&&this._isHistoryApiAvailable()&&history.replaceState({},document.title,window.location.pathname+window.location.search)}.bind(this),f)}},_getHomePageId:function(){return W&&W.Viewer?W.Viewer.getHomePageId():null},_isHistoryApiAvailable:function(){return Modernizr.history}})}),define.utils("hashing",function(){return{SHA256:function(){function a(a){return h(q(g(a),8*a.length))}function b(a,b){var c=g(a);c.length>16&&(c=q(c,8*a.length));for(var d=[],e=[],f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var i=q(d.concat(g(b)),512+8*b.length);return h(q(e.concat(i),768))}function c(a){try{}catch(b){s=0}for(var c,d=s?"0123456789ABCDEF":"0123456789abcdef",e="",f=0;f<a.length;f++)c=a.charCodeAt(f),e+=d.charAt(c>>>4&15)+d.charAt(15&c);return e}function d(a){try{}catch(b){t=""}for(var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="",e=a.length,f=0;e>f;f+=3)for(var g=a.charCodeAt(f)<<16|(e>f+1?a.charCodeAt(f+1)<<8:0)|(e>f+2?a.charCodeAt(f+2):0),h=0;4>h;h++)d+=8*f+6*h>8*a.length?t:c.charAt(g>>>6*(3-h)&63);return d}function e(a,b){var c,d,e,f,g=b.length,h=[],i=[],j=Math.ceil(a.length/2);for(c=0;j>c;c++)i[c]=a.charCodeAt(2*c)<<8|a.charCodeAt(2*c+1);for(;i.length>0;){for(f=[],e=0,c=0;c<i.length;c++)e=(e<<16)+i[c],d=Math.floor(e/g),e-=d*g,(f.length>0||d>0)&&(f[f.length]=d);h[h.length]=e,i=f}var k="";for(c=h.length-1;c>=0;c--)k+=b.charAt(h[c]);var l=Math.ceil(8*a.length/(Math.log(b.length)/Math.log(2)));for(c=k.length;l>c;c++)k=b[0]+k;return k}function f(a){for(var b,c,d="",e=-1;++e<a.length;)b=a.charCodeAt(e),c=e+1<a.length?a.charCodeAt(e+1):0,b>=55296&&56319>=b&&c>=56320&&57343>=c&&(b=65536+((1023&b)<<10)+(1023&c),e++),127>=b?d+=String.fromCharCode(b):2047>=b?d+=String.fromCharCode(192|b>>>6&31,128|63&b):65535>=b?d+=String.fromCharCode(224|b>>>12&15,128|b>>>6&63,128|63&b):2097151>=b&&(d+=String.fromCharCode(240|b>>>18&7,128|b>>>12&63,128|b>>>6&63,128|63&b));return d}function g(a){for(var b=[],c=a.length>>2,d=0;c>d;d++)b[d]=0;for(var e=0;e<8*a.length;e+=8)b[e>>5]|=(255&a.charCodeAt(e/8))<<24-e%32;return b}function h(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>24-c%32&255);return b}function i(a,b){return a>>>b|a<<32-b}function j(a,b){return a>>>b}function k(a,b,c){return a&b^~a&c}function l(a,b,c){return a&b^a&c^b&c}function m(a){return i(a,2)^i(a,13)^i(a,22)}function n(a){return i(a,6)^i(a,11)^i(a,25)}function o(a){return i(a,7)^i(a,18)^j(a,3)}function p(a){return i(a,17)^i(a,19)^j(a,10)}function q(a,b){var c,d,e,f,g,h,i,j,q,s,t,v,w=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],x=[];for(a[b>>5]|=128<<24-b%32,a[(b+64>>9<<4)+15]=b,q=0;q<a.length;q+=16){for(c=w[0],d=w[1],e=w[2],f=w[3],g=w[4],h=w[5],i=w[6],j=w[7],s=0;64>s;s++)x[s]=16>s?a[s+q]:r(r(r(p(x[s-2]),x[s-7]),o(x[s-15])),x[s-16]),t=r(r(r(r(j,n(g)),k(g,h,i)),u[s]),x[s]),v=r(m(c),l(c,d,e)),j=i,i=h,h=g,g=r(f,t),f=e,e=d,d=c,c=r(t,v);w[0]=r(c,w[0]),w[1]=r(d,w[1]),w[2]=r(e,w[2]),w[3]=r(f,w[3]),w[4]=r(g,w[4]),w[5]=r(h,w[5]),w[6]=r(i,w[6]),w[7]=r(j,w[7])}return w}function r(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}var s=0,t="",u=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998];return{hex_sha256:function(b){return c(a(f(b)))},b64_sha256:function(b){return d(a(f(b)))},any_sha256:function(b,c){return e(a(f(b)),c)},hex_hmac_sha256:function(a,d){return c(b(f(a),f(d)))},b64_hmac_sha256:function(a,c){return d(b(f(a),f(c)))},any_hmac_sha256:function(a,c,d){return e(b(f(a),f(c)),d)}}}(),MD5:function(){function a(a){return h(i(g(a),8*a.length))}function b(a,b){var c=g(a);c.length>16&&(c=i(c,8*a.length));for(var d=Array(16),e=Array(16),f=0;16>f;f++)d[f]=909522486^c[f],e[f]=1549556828^c[f];var j=i(d.concat(g(b)),512+8*b.length);return h(i(e.concat(j),640))}function c(a){try{}catch(b){q=0}for(var c,d=q?"0123456789ABCDEF":"0123456789abcdef",e="",f=0;f<a.length;f++)c=a.charCodeAt(f),e+=d.charAt(c>>>4&15)+d.charAt(15&c);return e}function d(a){try{}catch(b){r=""}for(var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d="",e=a.length,f=0;e>f;f+=3)for(var g=a.charCodeAt(f)<<16|(e>f+1?a.charCodeAt(f+1)<<8:0)|(e>f+2?a.charCodeAt(f+2):0),h=0;4>h;h++)d+=8*f+6*h>8*a.length?r:c.charAt(g>>>6*(3-h)&63);return d}function e(a,b){var c,d,e,f,g,h=b.length,i=Array(Math.ceil(a.length/2));for(c=0;c<i.length;c++)i[c]=a.charCodeAt(2*c)<<8|a.charCodeAt(2*c+1);var j=Math.ceil(8*a.length/(Math.log(b.length)/Math.log(2))),k=Array(j);for(d=0;j>d;d++){for(g=Array(),f=0,c=0;c<i.length;c++)f=(f<<16)+i[c],e=Math.floor(f/h),f-=e*h,(g.length>0||e>0)&&(g[g.length]=e);k[d]=f,i=g}var l="";for(c=k.length-1;c>=0;c--)l+=b.charAt(k[c]);return l}function f(a){for(var b,c,d="",e=-1;++e<a.length;)b=a.charCodeAt(e),c=e+1<a.length?a.charCodeAt(e+1):0,b>=55296&&56319>=b&&c>=56320&&57343>=c&&(b=65536+((1023&b)<<10)+(1023&c),e++),127>=b?d+=String.fromCharCode(b):2047>=b?d+=String.fromCharCode(192|b>>>6&31,128|63&b):65535>=b?d+=String.fromCharCode(224|b>>>12&15,128|b>>>6&63,128|63&b):2097151>=b&&(d+=String.fromCharCode(240|b>>>18&7,128|b>>>12&63,128|b>>>6&63,128|63&b));return d}function g(a){for(var b=Array(a.length>>2),c=0;c<b.length;c++)b[c]=0;for(var c=0;c<8*a.length;c+=8)b[c>>5]|=(255&a.charCodeAt(c/8))<<c%32;return b}function h(a){for(var b="",c=0;c<32*a.length;c+=8)b+=String.fromCharCode(a[c>>5]>>>c%32&255);return b}function i(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,e=-1732584194,f=271733878,g=0;g<a.length;g+=16){var h=c,i=d,j=e,p=f;c=k(c,d,e,f,a[g+0],7,-680876936),f=k(f,c,d,e,a[g+1],12,-389564586),e=k(e,f,c,d,a[g+2],17,606105819),d=k(d,e,f,c,a[g+3],22,-1044525330),c=k(c,d,e,f,a[g+4],7,-176418897),f=k(f,c,d,e,a[g+5],12,1200080426),e=k(e,f,c,d,a[g+6],17,-1473231341),d=k(d,e,f,c,a[g+7],22,-45705983),c=k(c,d,e,f,a[g+8],7,1770035416),f=k(f,c,d,e,a[g+9],12,-1958414417),e=k(e,f,c,d,a[g+10],17,-42063),d=k(d,e,f,c,a[g+11],22,-1990404162),c=k(c,d,e,f,a[g+12],7,1804603682),f=k(f,c,d,e,a[g+13],12,-40341101),e=k(e,f,c,d,a[g+14],17,-1502002290),d=k(d,e,f,c,a[g+15],22,1236535329),c=l(c,d,e,f,a[g+1],5,-165796510),f=l(f,c,d,e,a[g+6],9,-1069501632),e=l(e,f,c,d,a[g+11],14,643717713),d=l(d,e,f,c,a[g+0],20,-373897302),c=l(c,d,e,f,a[g+5],5,-701558691),f=l(f,c,d,e,a[g+10],9,38016083),e=l(e,f,c,d,a[g+15],14,-660478335),d=l(d,e,f,c,a[g+4],20,-405537848),c=l(c,d,e,f,a[g+9],5,568446438),f=l(f,c,d,e,a[g+14],9,-1019803690),e=l(e,f,c,d,a[g+3],14,-187363961),d=l(d,e,f,c,a[g+8],20,1163531501),c=l(c,d,e,f,a[g+13],5,-1444681467),f=l(f,c,d,e,a[g+2],9,-51403784),e=l(e,f,c,d,a[g+7],14,1735328473),d=l(d,e,f,c,a[g+12],20,-1926607734),c=m(c,d,e,f,a[g+5],4,-378558),f=m(f,c,d,e,a[g+8],11,-2022574463),e=m(e,f,c,d,a[g+11],16,1839030562),d=m(d,e,f,c,a[g+14],23,-35309556),c=m(c,d,e,f,a[g+1],4,-1530992060),f=m(f,c,d,e,a[g+4],11,1272893353),e=m(e,f,c,d,a[g+7],16,-155497632),d=m(d,e,f,c,a[g+10],23,-1094730640),c=m(c,d,e,f,a[g+13],4,681279174),f=m(f,c,d,e,a[g+0],11,-358537222),e=m(e,f,c,d,a[g+3],16,-722521979),d=m(d,e,f,c,a[g+6],23,76029189),c=m(c,d,e,f,a[g+9],4,-640364487),f=m(f,c,d,e,a[g+12],11,-421815835),e=m(e,f,c,d,a[g+15],16,530742520),d=m(d,e,f,c,a[g+2],23,-995338651),c=n(c,d,e,f,a[g+0],6,-198630844),f=n(f,c,d,e,a[g+7],10,1126891415),e=n(e,f,c,d,a[g+14],15,-1416354905),d=n(d,e,f,c,a[g+5],21,-57434055),c=n(c,d,e,f,a[g+12],6,1700485571),f=n(f,c,d,e,a[g+3],10,-1894986606),e=n(e,f,c,d,a[g+10],15,-1051523),d=n(d,e,f,c,a[g+1],21,-2054922799),c=n(c,d,e,f,a[g+8],6,1873313359),f=n(f,c,d,e,a[g+15],10,-30611744),e=n(e,f,c,d,a[g+6],15,-1560198380),d=n(d,e,f,c,a[g+13],21,1309151649),c=n(c,d,e,f,a[g+4],6,-145523070),f=n(f,c,d,e,a[g+11],10,-1120210379),e=n(e,f,c,d,a[g+2],15,718787259),d=n(d,e,f,c,a[g+9],21,-343485551),c=o(c,h),d=o(d,i),e=o(e,j),f=o(f,p)}return Array(c,d,e,f)}function j(a,b,c,d,e,f){return o(p(o(o(b,a),o(d,f)),e),c)}function k(a,b,c,d,e,f,g){return j(b&c|~b&d,a,b,e,f,g)}function l(a,b,c,d,e,f,g){return j(b&d|c&~d,a,b,e,f,g)}function m(a,b,c,d,e,f,g){return j(b^c^d,a,b,e,f,g)}function n(a,b,c,d,e,f,g){return j(c^(b|~d),a,b,e,f,g)}function o(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function p(a,b){return a<<b|a>>>32-b}var q=0,r="";return{hex_md5:function(b){return c(a(f(b)))},b64_md5:function(b){return d(a(f(b)))},any_md5:function(b,c){return e(a(f(b)),c)},hex_hmac_md5:function(a,d){return c(b(f(a),f(d)))},b64_hmac_md5:function(a,c){return d(b(f(a),f(c)))},any_hmac_md5:function(a,c,d){return e(b(f(a),f(c)),d)}}}()}}),define.utils("helpers:this",function(){var a,b=0;return{_isStackEnabled:null,log:function(){},getPrefixedUniqueId:function(a){return a?a+"_"+this.getUniqueId():this.getUniqueId()},getUniqueId:function(){var c=(new Date).getTime().toString(36);return c===a?c+="_"+b++:(a=c,b=0),c},getGUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})},getAntiCacheSuffix:function(){var a,b=W.Utils.getQueryParam("nocache"),c=W.Utils;return"file:"===window.location.protocol||"false"==b?a="":(c._antiCacheSuffix||(c._antiCacheSuffix=(new Date).getTime().toString(36)),a="?noCache="+c._antiCacheSuffix),a},setUrlParam:function(a,b,c){var d=a.split("?"),e=[],f=!1;if(2==d.length){e=d[1].split("&");for(var g=0;g<e.length;g++)if(0===e[g].indexOf(b+"=")){e[g]=b+"="+String(c),f=!0;break}}return f||e.push(b+"="+String(c)),d[1]=e.join("&"),a=d.join("?")},getQueryStringAsObject:function(a){var b={},c=a?a:window.location.href;return c.replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(a,c,d,e){b[c]=e}),b},getQueryStringParamsAsObject:function(a){var b={},c=a?a:window.location.search;return c.substr(c.indexOf("?")).replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),function(a,c,d,e){b[c]=e}),b},getQueryParam:function(a,b){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)",d=new RegExp(c),e=b||window.location.href,f=d.exec(e);return null===f?"":f[1]},waitForAnEventOnObjects:function(a,b,c,d,e){e="number"==typeof e?e:this._getDefaultTimeoutTime();var f;if(a.toMap)f=a.toMap(function(a,b){return b});else{if("object"!=typeof a)throw"waitForAnEventOnObjects works for objects or arrays";f=_.clone(a)}var g=setTimeout(function(){c(!1,_.values(f))},e);_.forEach(a,function(a,e){a.once(b,a,function(){delete f[e],_.isEmpty(f)&&(clearTimeout(g),d?_.defer(c,!0):c(!0))})})},_getDefaultTimeoutTime:function(){return 1e4},callLater:function(a,b,c,d){if(a&&"function"===typeOf(a)){if(b=b||[],c=c||window,d=d||1,this._isStackEnabled=this._isStackEnabled||"true"===this.getQueryParam("stack"),this._isStackEnabled){var e=this.getStackTrace();return setTimeout(function(){a.callLaterStack=e,a.apply(c,b),delete a.callLaterStack},d)}return setTimeout(function(){a.apply(c,b)},d)}},clearCallLater:function(a){clearTimeout(a)},callOnNextRender:function(a,b){b=b||60;var c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,b)};return c(a)},clearOnNextRender:function(a){var b=window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout;b(a)},_animationPriorityCallbacks:[],_priorityAnimationId:null,_priorityCallsCount:0,callOnNextRenderPriority:function(a,b){return a&&"function"==typeof a?(this._priorityAnimationId||(this._priorityAnimationId=this.callOnNextRender(this._onPriorityAnimation.bind(this))),this._priorityCallsCount++,this._animationPriorityCallbacks.push({id:this._priorityCallsCount,callback:a,priority:b||1e4}),this._priorityCallsCount):void 0},clearOnNextRenderPriority:function(a){for(var b=0;b<this._animationPriorityCallbacks.length;++b)if(this._animationPriorityCallbacks[b].id===a){this._animationPriorityCallbacks.splice(b,1);break}0===this._animationPriorityCallbacks.length&&(this.clearOnNextRender(this._priorityAnimationId),this._priorityAnimationId=null)},_onPriorityAnimation:function(){this._priorityAnimationId=null;var a=_.sortBy(this._animationPriorityCallbacks,"priority");this._animationPriorityCallbacks=[];for(var b=0;b<a.length;++b)a[b].callback()},objectSizeDelta:function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&b++;return b},sanitizeUnicode:function(a){return"string"==typeof a?a.replace(/[\u2028\u2029]/g,"\n"):a},encodeUrl:function(a){return a?encodeURI(a):""},encodeValue:function(a){return null===a||void 0===a?"":encodeURIComponent(a)},getUniqueArray:function(a){for(var b=[],c=a.length,d=0;c>d;d++){for(var e=d+1;c>e;e++)a[d]===a[e]&&(e=++d);b.push(a[d])}return b},areArraysContainSameElements:function(a,b){var c=a.filter(function(a){return-1==b.indexOf(a)}),d=b.filter(function(b){return-1==a.indexOf(b)});return d&&d.length>0||c&&c.length>0?!1:!0},areObjectsEqual:function(a,b){var c;if(a&&!b||!a&&b)return!1;for(c in a)if(a.hasOwnProperty(c)&&"undefined"==typeof b[c]&&"undefined"!=typeof a[c])return!1;for(c in a)if(a.hasOwnProperty(c))if(a[c])switch(typeof a[c]){case"object":if(!this.areObjectsEqual(a[c],b[c]))return!1;break;case"function":if("undefined"==typeof b[c]||a[c].toString()!=b[c].toString())return!1;break;default:if(a[c]!=b[c])return!1}else if(b[c])return!1;for(c in b)if(b.hasOwnProperty(c)&&"undefined"==typeof a[c]&&"undefined"!=typeof b[c])return!1;return!0},deepMergeObjects:function(a,b){return _.merge(a,b,function(a,b){if(_.isArray(a)&&_.isArray(b)){var c=a.concat(b);return _.unique(c)}return _.isObject(a)&&_.isObject(b)?this.deepMergeObjects(a,b):b}.bind(this))},stringToBoolean:function(a){return a?"true"==a.toLowerCase():!1},strEndsWith:function(a,b){return-1!==a.indexOf(b,a.length-b.length)},moveItemInArray:function(a,b,c){if(c>=a.length)for(var d=c-a.length;d--+1;)a.push(void 0);return a.splice(c,0,a.splice(b,1)[0]),a},openPopupWindow:function(a,b,c){window.open(a,b,c)},removeHtmlTagsFromString:function(a){return a.replace(/<[^<]*>/g,"")},htmlEncode:function(a){return String(a).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")},removeBreaklinesFromString:function(a){return a.replace(/[\n\r]/g," ")},arrayToObject:function(a,b,c){"undefined"!=typeof c&&(b=b.bind(c));for(var d,e={},f=-1,g=a.length;++f<g;)d=a[f],"undefined"!=typeof d&&(e[d]=b(d,f));
return e},getFullStateObject:function(){var a={bootstrap:W.Config.getLocationMapProperty("bootstrap"),ckeditor:W.Config.getLocationMapProperty("ckeditor"),langs:W.Config.getLocationMapProperty("langs"),wixapps:W.Config.getLocationMapProperty("wixapps"),tpa:W.Config.getLocationMapProperty("tpa")},b=W.Experiments.getRunningExperimentIds().sort();return{artifacts:a,runningExperiments:b}},getFullStateString:function(){return JSON.stringify(this.getFullStateObject())},getWindowScrollOffset:function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},isSiteNameAlreadyExist:function(a){var b=this.getUsedMetaSiteNames(),c=a.replace(/\s+/g,"-").toLowerCase();return _.contains(_.invoke(b,"toLowerCase"),c)},getUsedMetaSiteNames:function(){return W.Config.getEditorModelProperty("usedMetaSiteNames")}}}),define.utils("mobile",function(){return{getMobileDefaultMinFontSize:function(){return 12},convertFontSizeToMobile:function(a,b){var c=this.getMobileFontSize(a);return b*Math.round(c)},getMobileFontSize:function(a){var b,c=this.getMobileDefaultMinFontSize();if(c>a)b=c;else if(14>=a)b=a+1;else if(25>=a)b=a;else if(100>=a){var d={26:26,27:26,28:26,29:27,30:27,31:27,32:28,33:28,34:28,35:29,36:29,37:29,38:30,39:30,40:30,41:31,42:31,43:31,44:32,45:32,46:32,47:33,48:33,49:33,50:34,51:34,52:34,53:35,54:35,55:35,56:36,57:36,58:36,59:37,60:37,61:37,62:38,63:38,64:38,65:39,66:39,67:39,68:40,69:40,70:40,71:41,72:41,73:41,74:42,75:42,76:42,77:43,78:43,79:43,80:44,81:44,82:44,83:45,84:45,85:45,86:46,87:46,88:46,89:47,90:47,91:47,92:48,93:48,94:48,95:49,96:49,97:49,98:50,99:50,100:50};b=d[a]}else b=50;return b},_getClassFontSize:function(a,b){var c=this._getFontClass(a,b);return c?parseInt(c.getSize()):0/0},_getClassFontColor:function(a,b){var c=this._getFontClass(a,b);return c&&b.getProperty(c.getColorReference())},_getFontClass:function(a,b){var c=this._findNodeClassThatStartsWith(a,"font_");return c&&"font"===b.getPropertyType(c)?b.getProperty(c):null},_findNodeClassThatStartsWith:function(a,b){return _.find(a.classList,function(a){return 0===a.indexOf(b)})},getFontSize:function(a,b){var c=parseInt(a.style.fontSize);return isNaN(c)&&(c=this._getClassFontSize(a,b)),c},getFontColor:function(a,b){var c,d=a.style.color;return d?d=b.getColorClassInstance(d):(c=this._findNodeClassThatStartsWith(a,"color_"),d=c?b.getProperty(c):this._getClassFontColor(a,b)),d},calcNodeDirectCharacters:function(a){var b=_.reduce(a.childNodes,function(a,b){return a+(3==b.nodeType?b.length:0)},0);return b}}}),function(){var a,b,c,d,e,f,g,h;a=document.createElement("style"),a.id="testCss",document.getElementsByTagName("head")[0].appendChild(a),d=a.sheet?"sheet":"styleSheet",b=a[d],b||LOG.reportError(wixErrors.UTILS_STYLE_NOT_FOUND,"Styles","feature detection"),e=b.ownerNode?"ownerNode":"owningElement",g=b.deleteRule?"deleteRule":"removeRule",f=b.cssRules?"cssRules":"rules";var i,j=function(a){return a.replace(/[\s]+/g," ").replace(/'/g,'"').replace(/^\s+/,"").replace(/\s*$/,"")};i=b.insertRule?function(a,b){if(a=j(a),this._rulesMap[a])return LOG.reportError(wixErrors.UTILS_RULE_ALREADY_EXIST,"Styles","createRule",a+""),void 0;var c=this.insertRule(a+"{"+b+"}",this.cssRules.length),d=this.cssRules[c];return this._rulesMap[a]=d,this._browserSelectorMapping[a]=d.selectorText,d}:function(a,b){if(a=j(a),this._rulesMap[a])return LOG.reportError(wixErrors.UTILS_RULE_ALREADY_EXIST,"Styles","createRule",a+""),void 0;var c,d=this.addRule(a,b);if(-1!=d)c=this.rules[d];else for(var e=0;e<this.rules.length;++e)if(this.rules[e].selectorText==a){c=this.rules[e];break}return this._rulesMap[a]=c,this._browserSelectorMapping[a]=c.selectorText,c},b._rulesMap={},b._browserSelectorMapping={},c=i.apply(b,["#tempSelector","color:black;"]),h=c.cssText?"cssText":"no_support";var k,l=function(){return this[d]},m=function(){return this[f]},n=function(){this._rulesMap=void 0,this.styleNode.dispose()},o=function(){this._rulesMap=[];for(var a=this[f].length-1;a>=0;--a)this[g](a)},p=function(a){return a=j(a),this._rulesMap[a]?this._rulesMap[a]:null},q=function(a){a=j(a);var b=!1;if(this._rulesMap[a]){for(var c=this._browserSelectorMapping[a],d=this[f].length-1,e=d;e>=0;--e)this[f][e].selectorText==c&&(this[g](e),b=!0);delete this._rulesMap[a]}return b};k=b.cssRules?function(a,b){a=j(a);var c=this._rulesMap[a];return c?c.style[h]=b:(c=this.createRule(a,b),this._rulesMap[a]=c),c}:function(a,b){return a=j(a),this._rulesMap[a]&&(this.removeRuleBySelector(a),delete this._rulesMap[a]),this.createRule(a,b)},define.utils("createStyleSheet:this",function(){function a(a){var b=W.Utils.getPrefixedUniqueId(a),c=new Element("style",{id:b}).inject(document.head),f=c[d];if(!f)for(var g=document.styleSheets,h=0;h<g.length;++h)if(g[h][e]===c){f=g[h];break}return f?(f._rulesMap={},f._browserSelectorMapping={},f.styleNode=c,f.getRuleList=m,f.removeStyleSheet=n,f.clearRules=o,f.getRuleBySelector=p,f.removeRuleBySelector=q,f.updateRule=k,f.createRule=i,c.getStyleSheet=l,f):(LOG.reportError(wixErrors.UTILS_ERR_CREATE_STYLE,"Styles","createStyleSheet",""),void 0)}return{createStyleSheet:function(a){return this._styles.createStyleSheet(a)},_styles:{createStyleSheet:a}}})}(),define.utils("testUtils:this",function(){return{instanceIndex:0,_$getUniqeId:function(a){var b=this.instanceIndex,c=Utils.getUniqueId(a);return this.instanceIndex=b,c}}});